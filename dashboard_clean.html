<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¿ƒåŠ¨å‘˜å·¥æ•¬ä¸šåº¦è°ƒç ”æ•°æ®</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <style>
        :root {
            --primary: #0078d4;
            --success: #107c10;
            --warning: #ff8c00;
            --danger: #d13438;
            --info: #0078d4;
            --light: #f8f9fa;
            --dark: #323130;
            --surface: #ffffff;
            --border: #e1dfdd;
            --text-primary: #323130;
            --text-secondary: #605e5c;
            --green: #107c10;
            --orange: #ff8c00;
            --red: #d13438;
            --blue: #0078d4;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', 'Roboto', sans-serif;
            background-color: var(--light);
            color: var(--text-primary);
            line-height: 1.5;
        }
        
        .header {
            background: var(--surface);
            border-bottom: 1px solid var(--border);
            padding: 16px 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .logo-section {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .logo {
            font-size: 24px;
            color: var(--primary);
        }
        
        .title-group h1 {
            font-size: 20px;
            font-weight: 600;
            color: var(--text-primary);
            margin: 0;
        }
        
        .title-group .subtitle {
            font-size: 14px;
            color: var(--text-secondary);
            margin-top: 2px;
        }
        
        .actions {
            display: flex;
            gap: 12px;
        }
        
        .btn {
            padding: 8px 16px;
            border-radius: 4px;
            border: none;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.2s;
        }
        
        .btn-outline {
            background: var(--surface);
            border: 1px solid var(--border);
            color: var(--text-primary);
        }
        
        .btn-primary {
            background: var(--primary);
            color: white;
        }
        
        .btn:hover {
            opacity: 0.9;
            transform: translateY(-1px);
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 24px;
        }
        
        .kpi-card {
            background: var(--surface);
            border-radius: 8px;
            padding: 24px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border-left: 4px solid var(--primary);
            transition: transform 0.2s;
        }
        
        .kpi-card:hover {
            transform: translateY(-2px);
        }
        
        .kpi-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }
        
        .kpi-title {
            font-size: 14px;
            color: var(--text-secondary);
            font-weight: 500;
        }
        
        .kpi-icon {
            font-size: 24px;
            opacity: 0.7;
        }
        
        .kpi-value {
            font-size: 36px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 8px;
        }
        
        .kpi-change {
            display: flex;
            align-items: center;
            gap: 4px;
            font-size: 14px;
        }
        
        .trend-up {
            color: var(--green);
        }
        
        .trend-down {
            color: var(--red);
        }
        
        .charts-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 24px;
        }
        
        .chart-card {
            background: var(--surface);
            border-radius: 8px;
            padding: 24px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--border);
        }
        
        .chart-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
        }
        
        .chart-container {
            height: 320px;
            position: relative;
        }
        
        .full-width {
            grid-column: 1 / -1;
        }
        
        .tabs {
            display: flex;
            border-bottom: 2px solid var(--border);
            margin-bottom: 20px;
        }
        
        .tab {
            padding: 12px 20px;
            font-size: 14px;
            font-weight: 500;
            color: var(--text-secondary);
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: all 0.2s;
        }
        
        .tab.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }
        
        .tab:hover:not(.active) {
            color: var(--text-primary);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
        }
        
        .data-table th {
            background: var(--light);
            padding: 12px 16px;
            text-align: left;
            font-weight: 600;
            color: var(--text-primary);
            border-bottom: 2px solid var(--border);
        }
        
        .data-table td {
            padding: 12px 16px;
            border-bottom: 1px solid var(--border);
        }
        
        .data-table tr:hover {
            background: var(--light);
        }
        
        .department-table tr.expandable {
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        .department-table tr.expandable:hover {
            background: rgba(0, 120, 212, 0.05);
        }
        
        .department-table tr.expandable td:first-child::before {
            content: 'â–¶';
            margin-right: 8px;
            transition: transform 0.2s;
            display: inline-block;
        }
        
        .department-table tr.expandable.expanded td:first-child::before {
            transform: rotate(90deg);
        }
        
        .department-table tr.sub-department {
            background: rgba(0, 120, 212, 0.02);
            display: none;
        }
        
        .department-table tr.sub-department.show {
            display: table-row;
        }
        
        .department-table tr.sub-department td:first-child {
            padding-left: 40px;
            border-left: 3px solid var(--primary);
            position: relative;
        }
        
        .department-table tr.sub-department td:first-child::before {
            content: 'â””';
            position: absolute;
            left: 20px;
            color: var(--text-secondary);
        }
        
        .metric-badge {
            display: inline-flex;
            align-items: center;
            padding: 4px 12px;
            border-radius: 16px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .badge-excellent {
            background: rgba(16, 124, 16, 0.1);
            color: var(--green);
        }
        
        .badge-good {
            background: rgba(0, 120, 212, 0.1);
            color: var(--blue);
        }
        
        .badge-average {
            background: rgba(255, 140, 0, 0.1);
            color: var(--orange);
        }
        
        .badge-poor {
            background: rgba(209, 52, 56, 0.1);
            color: var(--red);
        }
        
        .hidden {
            display: none !important;
        }
        
        .chatbot {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 350px;
            height: 500px;
            background: var(--surface);
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.2);
            display: flex;
            flex-direction: column;
            z-index: 1000;
        }
        
        .chatbot.hidden {
            display: none !important;
        }
        
        .chatbot-header {
            padding: 16px;
            background: var(--primary);
            color: white;
            border-radius: 12px 12px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .chatbot-close {
            background: none;
            border: none;
            color: white;
            font-size: 18px;
            cursor: pointer;
        }
        
        .chatbot-messages {
            flex: 1;
            padding: 16px;
            overflow-y: auto;
        }
        
        .message {
            margin-bottom: 12px;
            padding: 12px;
            border-radius: 12px;
            max-width: 80%;
        }
        
        .message.user {
            background: var(--primary);
            color: white;
            margin-left: auto;
        }
        
        .message.bot {
            background: var(--light);
            color: var(--text-primary);
        }
        
        .chatbot-input {
            padding: 16px;
            border-top: 1px solid var(--border);
            display: flex;
            gap: 8px;
        }
        
        .chatbot-input input {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid var(--border);
            border-radius: 20px;
            outline: none;
        }
        
        .chatbot-input button {
            padding: 8px 16px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 20px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="logo-section">
            <div class="logo">ğŸ“Š</div>
            <div class="title-group">
                <h1>å¿ƒåŠ¨å‘˜å·¥æ•¬ä¸šåº¦è°ƒç ”æ•°æ®</h1>
                <div class="subtitle">2024å¹´åº¦åˆ†ææŠ¥å‘Š</div>
            </div>
        </div>
        <div class="actions">
            <input type="file" id="excel-file" style="display: none;" accept=".xlsx,.xls" />
            <button class="btn btn-outline" onclick="document.getElementById('excel-file').click()">
                <span>ğŸ“¤</span> ä¸Šä¼ æ•°æ®
            </button>
            <button class="btn btn-primary" onclick="toggleChatbot()">
                <span>ğŸ’¬</span> æ™ºèƒ½é—®ç­”
            </button>
        </div>
    </div>

    <div class="container">
        <!-- KPI ä»ªè¡¨æ¿ -->
        <div class="kpi-grid">
            <div class="kpi-card">
                <div class="kpi-header">
                    <div class="kpi-title">æ€»ä½“äººæ•°</div>
                    <div class="kpi-icon">ğŸ‘¥</div>
                </div>
                <div class="kpi-value">1,284</div>
                <div class="kpi-change">
                    <span>å‘˜å·¥æ€»æ•°</span>
                </div>
            </div>
            <div class="kpi-card">
                <div class="kpi-header">
                    <div class="kpi-title">å¡«å†™äººæ•°</div>
                    <div class="kpi-icon">âœ…</div>
                </div>
                <div class="kpi-value">828</div>
                <div class="kpi-change">
                    <span class="trend-up">â–² 64.5%</span> å¡«å†™ç‡
                </div>
            </div>
            <div class="kpi-card">
                <div class="kpi-header">
                    <div class="kpi-title">2024å¹´æ•¬ä¸šåº¦</div>
                    <div class="kpi-icon">ğŸ”¥</div>
                </div>
                <div class="kpi-value">68%</div>
                <div class="kpi-change">
                    <span class="trend-up">â–² +8%</span> vs 2023å¹´
                </div>
            </div>
            <div class="kpi-card">
                <div class="kpi-header">
                    <div class="kpi-title">2024å¹´æ»¡æ„åº¦</div>
                    <div class="kpi-icon">ğŸ˜Š</div>
                </div>
                <div class="kpi-value">68%</div>
                <div class="kpi-change">
                    <span class="trend-up">â–² +8%</span> vs 2023å¹´
                </div>
            </div>
            <div class="kpi-card">
                <div class="kpi-header">
                    <div class="kpi-title">é«˜æ•ˆå‘˜å·¥æ¯”ä¾‹</div>
                    <div class="kpi-icon">â­</div>
                </div>
                <div class="kpi-value">62.8%</div>
                <div class="kpi-change">
                    <span class="trend-up">â–² æ•¬ä¸šä¸”æ»¡æ„</span>
                </div>
            </div>
        </div>

        <!-- å›¾è¡¨ç½‘æ ¼ -->
        <div class="charts-grid">
            <!-- æ•¬ä¸šåº¦-æ»¡æ„åº¦å››è±¡é™å›¾ -->
            <div class="chart-card">
                <div class="chart-header">
                    <div class="chart-title">å‘˜å·¥æ•¬ä¸š-æ»¡æ„åº¦äº¤å‰åˆ†æ</div>
                </div>
                <div class="chart-container">
                    <canvas id="quadrantChart"></canvas>
                </div>
            </div>

            <!-- å¹´åº¦å¯¹æ¯”å›¾ -->
            <div class="chart-card">
                <div class="chart-header">
                    <div class="chart-title">å¹´åº¦å¯¹æ¯”è¶‹åŠ¿</div>
                </div>
                <div class="chart-container">
                    <canvas id="yearly-trend"></canvas>
                </div>
            </div>
        </div>

        <!-- æ ‡ç­¾é¡µ -->
        <div class="tabs">
            <button class="tab active" onclick="showTab('departments')">å…¨éƒ¨éƒ¨é—¨</button>
            <button class="tab" onclick="showTab('subdepartments')">äºŒçº§éƒ¨é—¨</button>
            <button class="tab" onclick="showTab('management')">ç®¡ç†å±‚å¯¹æ¯”</button>
            <button class="tab" onclick="showTab('levels')">èŒçº§åˆ†æ</button>
        </div>

        <!-- æ ‡ç­¾é¡µå†…å®¹ -->
        <div id="departments" class="tab-content active">
            <table class="data-table department-table">
                <thead>
                    <tr>
                        <th style="width: 40%;">éƒ¨é—¨</th>
                        <th style="width: 12%;">å‚ä¸äººæ•°</th>
                        <th style="width: 16%;">æ•¬ä¸šåº¦</th>
                        <th style="width: 16%;">æ»¡æ„åº¦</th>
                        <th style="width: 16%;">é«˜æ•ˆå‘˜å·¥æ¯”ä¾‹</th>
                    </tr>
                </thead>
                <tbody id="departmentTableBody">
                    <!-- éƒ¨é—¨æ•°æ®å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                </tbody>
            </table>
        </div>

        <div id="subdepartments" class="tab-content">
            <table class="data-table department-table">
                <thead>
                    <tr>
                        <th style="width: 30%;">äºŒçº§éƒ¨é—¨</th>
                        <th style="width: 20%;">æ‰€å±ä¸€çº§éƒ¨é—¨</th>
                        <th style="width: 12%;">å‚ä¸äººæ•°</th>
                        <th style="width: 13%;">æ•¬ä¸šåº¦</th>
                        <th style="width: 13%;">æ»¡æ„åº¦</th>
                        <th style="width: 12%;">é«˜æ•ˆå‘˜å·¥æ¯”ä¾‹</th>
                    </tr>
                </thead>
                <tbody id="subDepartmentTableBody">
                    <!-- äºŒçº§éƒ¨é—¨æ•°æ®å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                </tbody>
            </table>
        </div>

        <div id="management" class="tab-content">
            <table class="data-table department-table">
                <thead>
                    <tr>
                        <th>ç®¡ç†å²—ä½</th>
                        <th>å¡«å†™äººæ•°</th>
                        <th>æ•¬ä¸šåº¦</th>
                        <th>æ»¡æ„åº¦</th>
                        <th>æ•¬ä¸šä¸”æ»¡æ„æ¯”ä¾‹</th>
                    </tr>
                </thead>
                <tbody id="managementTableBody">
                    <!-- ç®¡ç†å²—ä½æ•°æ®å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                </tbody>
            </table>
        </div>

        <div id="levels" class="tab-content">
            <table class="data-table department-table">
                <thead>
                    <tr>
                        <th>èŒçº§</th>
                        <th>å¡«å†™äººæ•°</th>
                        <th>æ•¬ä¸šåº¦</th>
                        <th>æ»¡æ„åº¦</th>
                        <th>æ•¬ä¸šä¸”æ»¡æ„æ¯”ä¾‹</th>
                    </tr>
                </thead>
                <tbody id="levelsTableBody">
                    <!-- èŒçº§æ•°æ®å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                </tbody>
            </table>
        </div>
    </div>

    <!-- èŠå¤©æœºå™¨äºº -->
    <div class="chatbot hidden" id="chatbot">
        <div class="chatbot-header">
            <span>ğŸ’¬ æ•°æ®åŠ©æ‰‹</span>
            <button class="chatbot-close" onclick="closeChatbot()">âœ•</button>
        </div>
        <div class="chatbot-messages" id="chat-messages">
            <div class="message bot">
                æ‚¨å¥½ï¼æˆ‘æ˜¯å‘˜å·¥æ•¬ä¸šåº¦è°ƒç ”æ•°æ®åŠ©æ‰‹ã€‚æ‚¨å¯ä»¥è¯¢é—®ï¼š<br>
                â€¢ å“ªä¸ªéƒ¨é—¨è¡¨ç°æœ€å¥½ï¼Ÿ<br>
                â€¢ æ•¬ä¸šåº¦å˜åŒ–è¶‹åŠ¿å¦‚ä½•ï¼Ÿ<br>
                â€¢ æ»¡æ„åº¦ä¸»è¦é—®é¢˜åœ¨å“ªé‡Œï¼Ÿ
            </div>
        </div>
        <div class="chatbot-input">
            <input type="text" id="chat-input" placeholder="è¾“å…¥æ‚¨çš„é—®é¢˜..." onkeypress="handleKeyPress(event)">
            <button onclick="sendMessage()">å‘é€</button>
        </div>
    </div>

    <script>
        // å…¨å±€æ•°æ®å­˜å‚¨
        let surveyData = {
            "å¡«å†™ç‡": [{"æ€»ä½“äººæ•°": 1284, "å¡«å†™äººæ•°": 828, "å¡«å†™ç‡": 0.645, "å¯¹æ¯”å»å¹´": 0.145}],
            "ç»“è®ºæ¦‚è§ˆ": [{"24å¹´æ•¬ä¸šåº¦": 0.68, "23å¹´æ•¬ä¸šåº¦": 0.6, "24å¹´æ»¡æ„åº¦": 0.68, "23å¹´æ»¡æ„åº¦": 0.6}],
            "æŒ‰ç®¡ç†å²—ä½": [
                {"å²—ä½ç±»å‹": "ç®¡ç†å²—ä½", "å¡«å†™äººæ•°": 157, "æ•¬ä¸šåº¦": 0.764, "æ»¡æ„åº¦": 0.783, "æ•¬ä¸šä¸”æ»¡æ„": 0.694},
                {"å²—ä½ç±»å‹": "éç®¡ç†å²—ä½", "å¡«å†™äººæ•°": 671, "æ•¬ä¸šåº¦": 0.662, "æ»¡æ„åº¦": 0.654, "æ•¬ä¸šä¸”æ»¡æ„": 0.613}
            ],
            "æŒ‰èŒçº§": [
                {"èŒçº§ç±»å‹": "3å’Œ4èŒçº§", "å¡«å†™äººæ•°": 325, "æ•¬ä¸šåº¦": 0.708, "æ»¡æ„åº¦": 0.705, "æ•¬ä¸šä¸”æ»¡æ„": 0.652},
                {"èŒçº§ç±»å‹": "1å’Œ2èŒçº§", "å¡«å†™äººæ•°": 503, "æ•¬ä¸šåº¦": 0.664, "æ»¡æ„åº¦": 0.662, "æ•¬ä¸šä¸”æ»¡æ„": 0.612}
            ]
        };
        
        let departmentData = [
            // ä¸€çº§éƒ¨é—¨æ•°æ®
            {name: 'è´¢åŠ¡éƒ¨', count: 10, engagement: 40, satisfaction: 40, efficiency: 0},
            {name: 'åŸåŒ—å¤§ç‹å¯¨å·¥ä½œå®¤', count: 172, engagement: 60, satisfaction: 61, efficiency: 55},
            {name: 'æ³•åŠ¡éƒ¨', count: 7, engagement: 71, satisfaction: 86, efficiency: 71},
            {name: 'æµ·å¤–å‘è¡Œéƒ¨', count: 3, engagement: 100, satisfaction: 100, efficiency: 100},
            {name: 'æå¿ƒç¤¾å·¥ä½œå®¤', count: 59, engagement: 68, satisfaction: 66, efficiency: 64},
            {name: 'æŠ€æœ¯æ”¯æ’‘éƒ¨', count: 62, engagement: 69, satisfaction: 66, efficiency: 61},
            {name: 'ç¾æœ¯æ”¯æ’‘éƒ¨', count: 46, engagement: 59, satisfaction: 59, efficiency: 52},
            {name: 'å¹³å°æ”¯æ’‘éƒ¨', count: 20, engagement: 60, satisfaction: 65, efficiency: 55},
            {name: 'æµ…æ°´å·¥ä½œå®¤', count: 12, engagement: 100, satisfaction: 100, efficiency: 100},
            {name: 'äººåŠ›èµ„æºéƒ¨', count: 18, engagement: 61, satisfaction: 78, efficiency: 56},
            {name: 'å¸‚åœºéƒ¨', count: 30, engagement: 63, satisfaction: 60, efficiency: 57},
            {name: 'é¡¹ç›®ç®¡ç†éƒ¨', count: 1, engagement: 100, satisfaction: 100, efficiency: 100},
            {name: 'éŸ³é¢‘æ”¯æ’‘éƒ¨', count: 11, engagement: 45, satisfaction: 64, efficiency: 45},
            {name: 'æ¸¸æˆèŒå·¥ä½œå®¤', count: 35, engagement: 66, satisfaction: 57, efficiency: 54},
            {name: 'å‘˜å·¥æœåŠ¡ä¸­å¿ƒ', count: 5, engagement: 100, satisfaction: 100, efficiency: 100},
            {name: 'è¿ç»´æ”¯æ’‘éƒ¨', count: 6, engagement: 100, satisfaction: 100, efficiency: 100},
            {name: 'è¿è¥éƒ¨', count: 47, engagement: 74, satisfaction: 72, efficiency: 68},
            {name: 'æ”¿ç­–å…³ç³»ä¸åˆè§„æ”¯æŒä¸­å¿ƒ', count: 19, engagement: 89, satisfaction: 89, efficiency: 89},
            {name: 'æ‰§è¡ŒåŠå…¬å®¤', count: 4, engagement: 75, satisfaction: 100, efficiency: 75},
            {name: 'ADN', count: 7, engagement: 71, satisfaction: 71, efficiency: 71},
            {name: 'Bæ ¼çŒ«å·¥ä½œå®¤', count: 60, engagement: 77, satisfaction: 72, efficiency: 68},
            {name: 'Digital & IT', count: 6, engagement: 67, satisfaction: 100, efficiency: 67},
            {name: 'Filo', count: 1, engagement: 100, satisfaction: 100, efficiency: 100},
            {name: 'Flash Party', count: 4, engagement: 75, satisfaction: 100, efficiency: 75},
            {name: 'PG å‘è¡Œ & å•†åŠ¡éƒ¨', count: 15, engagement: 73, satisfaction: 73, efficiency: 73},
            {name: 'TapTap', count: 168, engagement: 71, satisfaction: 69, efficiency: 66}
        ];

        // åŸºäºCSVæ•°æ®çš„äºŒçº§éƒ¨é—¨æ•°æ®
        const subDepartmentData = {
            'åŸåŒ—å¤§ç‹å¯¨å·¥ä½œå®¤': [
                {name: 'æµ·ç›—é¡¹ç›®ç»„', count: 60, engagement: 55, satisfaction: 60, efficiency: 50},
                {name: 'æ¨ªæ‰«åƒå†›é¡¹ç›®ç»„', count: 2, engagement: 50, satisfaction: 50, efficiency: 50},
                {name: 'å…¶ä»–', count: 2, engagement: 50, satisfaction: 50, efficiency: 50},
                {name: 'ä¼Šç‘Ÿé¡¹ç›®ç»„ï¼ˆEtheriaï¼‰', count: 53, engagement: 72, satisfaction: 66, efficiency: 62},
                {name: 'Mekaé¡¹ç›®ç»„', count: 55, engagement: 56, satisfaction: 58, efficiency: 53}
            ],
            'æå¿ƒç¤¾å·¥ä½œå®¤': [
                {name: 'ç­–åˆ’', count: 21, engagement: 86, satisfaction: 81, efficiency: 81},
                {name: 'æŠ€æœ¯', count: 9, engagement: 56, satisfaction: 56, efficiency: 56},
                {name: 'ç¾æœ¯', count: 24, engagement: 58, satisfaction: 58, efficiency: 54},
                {name: 'å…¶ä»–', count: 5, engagement: 60, satisfaction: 60, efficiency: 60}
            ],
            'TapTap': [
                {name: 'Contents', count: 1, engagement: 100, satisfaction: 100, efficiency: 100},
                {name: 'Core Product & Services', count: 46, engagement: 65, satisfaction: 61, efficiency: 59},
                {name: 'Design Team', count: 10, engagement: 70, satisfaction: 60, efficiency: 60},
                {name: 'Developer Ops', count: 9, engagement: 89, satisfaction: 78, efficiency: 78},
                {name: 'Editors', count: 11, engagement: 91, satisfaction: 91, efficiency: 91},
                {name: 'IEM', count: 31, engagement: 74, satisfaction: 74, efficiency: 71},
                {name: 'International', count: 3, engagement: 0, satisfaction: 0, efficiency: 0},
                {name: 'Ops', count: 19, engagement: 84, satisfaction: 84, efficiency: 84},
                {name: 'Project SCE', count: 8, engagement: 63, satisfaction: 63, efficiency: 63},
                {name: 'Store', count: 11, engagement: 36, satisfaction: 55, efficiency: 36},
                {name: 'UG', count: 18, engagement: 83, satisfaction: 78, efficiency: 72}
            ]
        };

        let isAIResponding = false;

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            loadDashboard();
            createCharts();
            generateDepartmentTable();
        });
        
        function loadDashboard() {
            // KPIæ•°æ®å·²åœ¨HTMLä¸­ç¡¬ç¼–ç ï¼Œè¿™é‡Œå¯ä»¥æ·»åŠ åŠ¨æ€æ›´æ–°é€»è¾‘
        }
        
        function createCharts() {
            createQuadrantChart();
            createYearlyTrendChart();
        }
        
        function createQuadrantChart() {
            const ctx = document.getElementById('quadrantChart').getContext('2d');
            
            // å‘˜å·¥åˆ†ç±»æ•°æ® - æ ¹æ®å›¾ç‰‡ä¸­çš„æ•°æ®
            const employeeData = [
                {
                    label: 'é«˜æ•ˆå‘˜å·¥ (æ•¬ä¸šä¸”æ»¡æ„)',
                    x: 78,  // æ»¡æ„åº¦
                    y: 78,  // æ•¬ä¸šåº¦
                    r: 25,  // 62.8%å¯¹åº”çš„å¤§åœ†
                    backgroundColor: 'rgba(40, 167, 69, 0.7)',
                    borderColor: 'rgba(40, 167, 69, 1)',
                    percentage: '62.8%'
                },
                {
                    label: 'å—æŒ«å‘˜å·¥ (æ•¬ä¸šä¸æ»¡æ„)',
                    x: 25,  // æ»¡æ„åº¦
                    y: 75,  // æ•¬ä¸šåº¦
                    r: 8,   // 5.3%å¯¹åº”çš„å°åœ†
                    backgroundColor: 'rgba(255, 193, 7, 0.7)',
                    borderColor: 'rgba(255, 193, 7, 1)',
                    percentage: '5.3%'
                },
                {
                    label: 'æ¼ ç„¶å‘˜å·¥ (ä¸æ•¬ä¸šä½†æ»¡æ„)',
                    x: 75,  // æ»¡æ„åº¦
                    y: 25,  // æ•¬ä¸šåº¦
                    r: 8,   // 5.1%å¯¹åº”çš„å°åœ†
                    backgroundColor: 'rgba(0, 123, 255, 0.7)',
                    borderColor: 'rgba(0, 123, 255, 1)',
                    percentage: '5.1%'
                },
                {
                    label: 'ä½æ•ˆå‘˜å·¥ (ä¸æ•¬ä¸šä¸æ»¡æ„)',
                    x: 25,  // æ»¡æ„åº¦
                    y: 22,  // æ•¬ä¸šåº¦
                    r: 15,  // 26.8%å¯¹åº”çš„ä¸­åœ†
                    backgroundColor: 'rgba(220, 53, 69, 0.7)',
                    borderColor: 'rgba(220, 53, 69, 1)',
                    percentage: '26.8%'
                }
            ];

            new Chart(ctx, {
                type: 'bubble',
                data: {
                    datasets: employeeData.map(item => ({
                        label: item.label,
                        data: [{
                            x: item.x,
                            y: item.y,
                            r: item.r
                        }],
                        backgroundColor: item.backgroundColor,
                        borderColor: item.borderColor,
                        borderWidth: 2,
                        percentage: item.percentage
                    }))
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: true,
                            position: 'bottom',
                            labels: {
                                usePointStyle: true,
                                generateLabels: function(chart) {
                                    return employeeData.map((item, index) => ({
                                        text: `${item.label.split(' ')[0]} ${item.percentage}`,
                                        fillStyle: item.backgroundColor,
                                        strokeStyle: item.borderColor,
                                        lineWidth: 2,
                                        pointStyle: 'circle'
                                    }));
                                }
                            }
                        },
                        tooltip: {
                            callbacks: {
                                title: function() {
                                    return '';
                                },
                                label: function(context) {
                                    const dataset = context.dataset;
                                    const dataPoint = context.parsed;
                                    return [
                                        `${dataset.label}`,
                                        `æ¯”ä¾‹: ${dataset.percentage}`,
                                        `æ»¡æ„åº¦: ${dataPoint.x}%`,
                                        `æ•¬ä¸šåº¦: ${dataPoint.y}%`
                                    ];
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            type: 'linear',
                            position: 'bottom',
                            min: 0,
                            max: 100,
                            title: {
                                display: true,
                                text: 'æ»¡æ„åº¦ (%)',
                                font: {
                                    size: 14,
                                    weight: 'bold'
                                }
                            },
                            grid: {
                                display: true,
                                color: 'rgba(0, 0, 0, 0.1)'
                            },
                            ticks: {
                                stepSize: 25,
                                callback: function(value) {
                                    return value + '%';
                                }
                            }
                        },
                        y: {
                            min: 0,
                            max: 100,
                            title: {
                                display: true,
                                text: 'æ•¬ä¸šåº¦ (%)',
                                font: {
                                    size: 14,
                                    weight: 'bold'
                                }
                            },
                            grid: {
                                display: true,
                                color: 'rgba(0, 0, 0, 0.1)'
                            },
                            ticks: {
                                stepSize: 25,
                                callback: function(value) {
                                    return value + '%';
                                }
                            }
                        }
                    },
                    interaction: {
                        intersect: false
                    }
                }
            });
        }
        
        function createYearlyTrendChart() {
            const ctx = document.getElementById('yearly-trend').getContext('2d');
            
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['2023å¹´', '2024å¹´'],
                    datasets: [
                        {
                            label: 'æ•¬ä¸šåº¦',
                            data: [60, 68],
                            borderColor: '#0078d4',
                            backgroundColor: 'rgba(0, 120, 212, 0.1)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4
                        },
                        {
                            label: 'æ»¡æ„åº¦',
                            data: [60, 68],
                            borderColor: '#107c10',
                            backgroundColor: 'rgba(16, 124, 16, 0.1)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: { callback: value => value + '%' }
                        }
                    },
                    plugins: {
                        legend: { position: 'top' }
                    }
                }
            });
        }
        
        // æ ‡ç­¾é¡µåˆ‡æ¢
        function showTab(tabName) {
            // éšè—æ‰€æœ‰æ ‡ç­¾é¡µå†…å®¹
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // ç§»é™¤æ‰€æœ‰æ ‡ç­¾é¡µçš„æ´»åŠ¨çŠ¶æ€
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // æ˜¾ç¤ºé€‰ä¸­çš„æ ‡ç­¾é¡µå†…å®¹
            document.getElementById(tabName).classList.add('active');
            
            // æ¿€æ´»é€‰ä¸­çš„æ ‡ç­¾é¡µ
            event.target.classList.add('active');
            
            // æ ¹æ®æ ‡ç­¾é¡µç±»å‹æ›´æ–°è¡¨æ ¼æ•°æ®
            if (tabName === 'departments') {
                generateDepartmentTable();
            } else if (tabName === 'subdepartments') {
                generateSubDepartmentTable();
            } else if (tabName === 'management') {
                generateManagementTable();
            } else if (tabName === 'levels') {
                generateLevelsTable();
            }
        }

        function generateDepartmentTable() {
            const tbody = document.getElementById('departmentTableBody');
            tbody.innerHTML = '';
            
            departmentData.forEach((dept, index) => {
                // ä¸€çº§éƒ¨é—¨è¡Œ
                const row = document.createElement('tr');
                const hasSubDepts = subDepartmentData[dept.name] && subDepartmentData[dept.name].length > 0;
                
                if (hasSubDepts) {
                    row.className = 'expandable';
                    row.onclick = () => toggleSubDepartments(index);
                }
                
                row.innerHTML = `
                    <td><strong>${dept.name}</strong></td>
                    <td>${dept.count}</td>
                    <td>${getBadge(dept.engagement)}</td>
                    <td>${getBadge(dept.satisfaction)}</td>
                    <td>${getBadge(dept.efficiency)}</td>
                `;
                tbody.appendChild(row);
                
                // äºŒçº§éƒ¨é—¨è¡Œ
                if (hasSubDepts) {
                    subDepartmentData[dept.name].forEach(subDept => {
                        const subRow = document.createElement('tr');
                        subRow.className = `sub-department sub-${index}`;
                        subRow.innerHTML = `
                            <td>${subDept.name}</td>
                            <td>${subDept.count}</td>
                            <td>${getBadge(subDept.engagement)}</td>
                            <td>${getBadge(subDept.satisfaction)}</td>
                            <td>${getBadge(subDept.efficiency)}</td>
                        `;
                        tbody.appendChild(subRow);
                    });
                }
            });
        }

        function toggleSubDepartments(index) {
            const parentRow = document.querySelector(`tr.expandable:nth-of-type(${index + 1})`);
            const subRows = document.querySelectorAll(`.sub-${index}`);
            
            if (parentRow.classList.contains('expanded')) {
                parentRow.classList.remove('expanded');
                subRows.forEach(row => row.classList.remove('show'));
            } else {
                parentRow.classList.add('expanded');
                subRows.forEach(row => row.classList.add('show'));
            }
        }

        function getBadge(value) {
            const percentage = Math.round(typeof value === 'number' ? value : value * 100);
            let badgeClass = 'badge-poor';
            
            if (percentage >= 80) badgeClass = 'badge-excellent';
            else if (percentage >= 60) badgeClass = 'badge-good';
            else if (percentage >= 40) badgeClass = 'badge-average';
            
            return `<span class="metric-badge ${badgeClass}">${percentage}%</span>`;
        }

        function generateSubDepartmentTable() {
            const tbody = document.getElementById('subDepartmentTableBody');
            tbody.innerHTML = '';
            
            departmentData.forEach((dept, index) => {
                if (subDepartmentData[dept.name]) {
                    subDepartmentData[dept.name].forEach((subDept, subIndex) => {
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td>${subDept.name}</td>
                            <td>${dept.name}</td>
                            <td>${subDept.count}</td>
                            <td>${getBadge(subDept.engagement)}</td>
                            <td>${getBadge(subDept.satisfaction)}</td>
                            <td>${getBadge(subDept.efficiency)}</td>
                        `;
                        tbody.appendChild(row);
                    });
                }
            });
        }

        function generateManagementTable() {
            const tbody = document.getElementById('managementTableBody');
            tbody.innerHTML = '';
            
            const managementData = surveyData['æŒ‰ç®¡ç†å²—ä½'];
            managementData.forEach(dept => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${dept.å²—ä½ç±»å‹}</td>
                    <td>${dept.å¡«å†™äººæ•°}</td>
                    <td>${getBadge(dept.æ•¬ä¸šåº¦)}</td>
                    <td>${getBadge(dept.æ»¡æ„åº¦)}</td>
                    <td>${getBadge(dept.æ•¬ä¸šä¸”æ»¡æ„)}</td>
                `;
                tbody.appendChild(row);
            });
        }

        function generateLevelsTable() {
            const tbody = document.getElementById('levelsTableBody');
            tbody.innerHTML = '';
            
            const levelsData = surveyData['æŒ‰èŒçº§'];
            levelsData.forEach(dept => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${dept.èŒçº§ç±»å‹}</td>
                    <td>${dept.å¡«å†™äººæ•°}</td>
                    <td>${getBadge(dept.æ•¬ä¸šåº¦)}</td>
                    <td>${getBadge(dept.æ»¡æ„åº¦)}</td>
                    <td>${getBadge(dept.æ•¬ä¸šä¸”æ»¡æ„)}</td>
                `;
                tbody.appendChild(row);
            });
        }
        
        function toggleChatbot() {
            const chatbot = document.getElementById('chatbot');
            chatbot.classList.toggle('hidden');
        }

        function closeChatbot() {
            const chatbot = document.getElementById('chatbot');
            chatbot.classList.add('hidden');
        }
        
        function sendMessage() {
            if (isAIResponding) return;
            
            const input = document.getElementById('chat-input');
            const message = input.value.trim();
            if (!message) return;
            
            const messages = document.getElementById('chat-messages');
            
            // æ·»åŠ ç”¨æˆ·æ¶ˆæ¯
            const userMsg = document.createElement('div');
            userMsg.className = 'message user';
            userMsg.textContent = message;
            messages.appendChild(userMsg);
            
            input.value = '';
            messages.scrollTop = messages.scrollHeight;
            
            // æ˜¾ç¤ºAIæ€è€ƒçŠ¶æ€
            isAIResponding = true;
            const thinkingMsg = document.createElement('div');
            thinkingMsg.className = 'message bot';
            thinkingMsg.innerHTML = 'AIæ­£åœ¨æ€è€ƒ<span class="typing-dots">...</span>';
            messages.appendChild(thinkingMsg);
            messages.scrollTop = messages.scrollHeight;
            
            // ç”Ÿæˆæ™ºèƒ½å›å¤
            setTimeout(() => {
                messages.removeChild(thinkingMsg);
                const botMsg = document.createElement('div');
                botMsg.className = 'message bot';
                botMsg.innerHTML = generateIntelligentResponse(message);
                messages.appendChild(botMsg);
                messages.scrollTop = messages.scrollHeight;
                isAIResponding = false;
            }, 1500);
        }
        
        function generateIntelligentResponse(message) {
            const msg = message.toLowerCase();
            
            // éƒ¨é—¨ç›¸å…³é—®é¢˜
            if (msg.includes('éƒ¨é—¨') || msg.includes('è¡¨ç°') || msg.includes('æœ€å¥½') || msg.includes('æœ€å·®')) {
                return `ğŸ“Š <strong>éƒ¨é—¨è¡¨ç°åˆ†æï¼š</strong><br><br>
                ğŸ† <strong>è¡¨ç°ä¼˜ç§€çš„éƒ¨é—¨ï¼š</strong><br>
                â€¢ æµ…æ°´å·¥ä½œå®¤ã€å‘˜å·¥æœåŠ¡ä¸­å¿ƒã€è¿ç»´æ”¯æ’‘éƒ¨ï¼šå„é¡¹æŒ‡æ ‡å‡è¾¾åˆ°100%<br>
                â€¢ æ”¿ç­–å…³ç³»ä¸åˆè§„æ”¯æŒä¸­å¿ƒï¼šæ•¬ä¸šåº¦å’Œæ»¡æ„åº¦å‡ä¸º89%<br>
                â€¢ æ³•åŠ¡éƒ¨ï¼šæ»¡æ„åº¦é«˜è¾¾86%ï¼Œæ•¬ä¸šåº¦71%<br><br>
                âš ï¸ <strong>éœ€è¦å…³æ³¨çš„éƒ¨é—¨ï¼š</strong><br>
                â€¢ è´¢åŠ¡éƒ¨ï¼šæ•¬ä¸šåº¦å’Œæ»¡æ„åº¦å‡ä¸º40%ï¼Œé«˜æ•ˆå‘˜å·¥æ¯”ä¾‹ä¸º0%<br>
                â€¢ éŸ³é¢‘æ”¯æ’‘éƒ¨ï¼šæ•¬ä¸šåº¦ä»…45%<br>
                â€¢ ç¾æœ¯æ”¯æ’‘éƒ¨ï¼šå„é¡¹æŒ‡æ ‡å‡åœ¨59%å·¦å³<br><br>
                ğŸ’¡ <strong>å»ºè®®ï¼š</strong>å‘è¡¨ç°ä¼˜ç§€çš„éƒ¨é—¨å­¦ä¹ ç®¡ç†ç»éªŒï¼Œé‡ç‚¹æ”¹å–„è´¢åŠ¡éƒ¨çš„å·¥ä½œç¯å¢ƒå’Œæ¿€åŠ±æœºåˆ¶ã€‚`;
            }
            
            // æ•¬ä¸šåº¦ç›¸å…³é—®é¢˜
            if (msg.includes('æ•¬ä¸šåº¦') || msg.includes('æ•¬ä¸š')) {
                return `ğŸ”¥ <strong>æ•¬ä¸šåº¦æ·±åº¦åˆ†æï¼š</strong><br><br>
                ğŸ“ˆ <strong>æ•´ä½“è¶‹åŠ¿ï¼š</strong>2024å¹´æ•¬ä¸šåº¦68%ï¼Œè¾ƒ2023å¹´60%æå‡8ä¸ªç™¾åˆ†ç‚¹<br><br>
                ğŸ‘¥ <strong>äººç¾¤å¯¹æ¯”ï¼š</strong><br>
                â€¢ ç®¡ç†å²—ä½ï¼š76.4%ï¼ˆä¼˜ç§€ï¼‰<br>
                â€¢ éç®¡ç†å²—ä½ï¼š66.2%ï¼ˆè‰¯å¥½ï¼‰<br>
                â€¢ 3-4èŒçº§ï¼š70.8%<br>
                â€¢ 1-2èŒçº§ï¼š66.4%<br><br>
                ğŸ¯ <strong>å››è±¡é™åˆ†å¸ƒï¼š</strong><br>
                â€¢ é«˜æ•ˆå‘˜å·¥ï¼ˆæ•¬ä¸šä¸”æ»¡æ„ï¼‰ï¼š62.8%<br>
                â€¢ å—æŒ«å‘˜å·¥ï¼ˆæ•¬ä¸šä½†ä¸æ»¡æ„ï¼‰ï¼š5.3%<br>
                â€¢ æ¼ ç„¶å‘˜å·¥ï¼ˆä¸æ•¬ä¸šä½†æ»¡æ„ï¼‰ï¼š5.1%<br>
                â€¢ ä½æ•ˆå‘˜å·¥ï¼ˆä¸æ•¬ä¸šä¸æ»¡æ„ï¼‰ï¼š26.8%<br><br>
                ğŸ’¡ <strong>æ”¹è¿›å»ºè®®ï¼š</strong>é‡ç‚¹å…³æ³¨26.8%çš„ä½æ•ˆå‘˜å·¥ç¾¤ä½“ï¼Œåˆ†æå…¶ä¸æ•¬ä¸šçš„æ ¹æœ¬åŸå› ã€‚`;
            }
            
            // æ»¡æ„åº¦ç›¸å…³é—®é¢˜
            if (msg.includes('æ»¡æ„åº¦') || msg.includes('æ»¡æ„')) {
                return `ğŸ˜Š <strong>æ»¡æ„åº¦å…¨é¢è§£æï¼š</strong><br><br>
                ğŸ“Š <strong>æ€»ä½“æƒ…å†µï¼š</strong>2024å¹´æ»¡æ„åº¦68%ï¼ŒåŒæ¯”æå‡8ä¸ªç™¾åˆ†ç‚¹<br><br>
                ğŸ¢ <strong>éƒ¨é—¨å·®å¼‚æ˜¾è‘—ï¼š</strong><br>
                â€¢ æœ€é«˜ï¼šæµ…æ°´å·¥ä½œå®¤ã€å‘˜å·¥æœåŠ¡ä¸­å¿ƒç­‰è¾¾100%<br>
                â€¢ è¾ƒé«˜ï¼šæ‰§è¡ŒåŠå…¬å®¤ã€Digital & ITã€Flash Partyè¾¾100%<br>
                â€¢ éœ€æ”¹å–„ï¼šè´¢åŠ¡éƒ¨40%ï¼Œæ¸¸æˆèŒå·¥ä½œå®¤57%<br><br>
                ğŸ‘” <strong>å²—ä½å±‚çº§ï¼š</strong><br>
                â€¢ ç®¡ç†å²—ä½æ»¡æ„åº¦ï¼š78.3%<br>
                â€¢ éç®¡ç†å²—ä½æ»¡æ„åº¦ï¼š65.4%<br><br>
                ğŸ” <strong>å…³é”®å‘ç°ï¼š</strong>ç®¡ç†å±‚æ»¡æ„åº¦æ˜æ˜¾é«˜äºåŸºå±‚å‘˜å·¥ï¼Œå»ºè®®åŠ å¼ºå¯¹åŸºå±‚å‘˜å·¥çš„å…³æ€€å’Œå‘å±•æ”¯æŒã€‚`;
            }
            
            // æ”¹è¿›å»ºè®®ç›¸å…³é—®é¢˜
            if (msg.includes('å»ºè®®') || msg.includes('æ”¹è¿›') || msg.includes('æå‡') || msg.includes('æ€ä¹ˆåŠ')) {
                return `ğŸ’¡ <strong>ä¸“ä¸šæ”¹è¿›å»ºè®®ï¼š</strong><br><br>
                ğŸ¯ <strong>çŸ­æœŸè¡ŒåŠ¨ï¼ˆ1-3ä¸ªæœˆï¼‰ï¼š</strong><br>
                â€¢ é‡ç‚¹å…³æ³¨è´¢åŠ¡éƒ¨ï¼Œå¼€å±•ä¸€å¯¹ä¸€è®¿è°ˆäº†è§£å…·ä½“é—®é¢˜<br>
                â€¢ ç»„ç»‡è·¨éƒ¨é—¨äº¤æµï¼Œè®©ä¼˜ç§€éƒ¨é—¨åˆ†äº«ç®¡ç†ç»éªŒ<br>
                â€¢ é’ˆå¯¹26.8%çš„ä½æ•ˆå‘˜å·¥ç¾¤ä½“åˆ¶å®šä¸ªæ€§åŒ–æ”¹è¿›è®¡åˆ’<br><br>
                ğŸ“ˆ <strong>ä¸­æœŸè§„åˆ’ï¼ˆ3-6ä¸ªæœˆï¼‰ï¼š</strong><br>
                â€¢ å»ºç«‹ç®¡ç†å²—ä½ä¸åŸºå±‚å‘˜å·¥çš„å®šæœŸæ²Ÿé€šæœºåˆ¶<br>
                â€¢ å®Œå–„éç®¡ç†å²—ä½çš„èŒä¸šå‘å±•é€šé“<br>
                â€¢ åŠ å¼ºå¯¹1-2èŒçº§å‘˜å·¥çš„åŸ¹è®­å’Œå‘å±•æ”¯æŒ<br><br>
                ğŸ† <strong>é•¿æœŸç›®æ ‡ï¼ˆ6-12ä¸ªæœˆï¼‰ï¼š</strong><br>
                â€¢ å°†é«˜æ•ˆå‘˜å·¥æ¯”ä¾‹ä»62.8%æå‡è‡³75%ä»¥ä¸Š<br>
                â€¢ ç¼©å°éƒ¨é—¨é—´å·®è·ï¼Œç¡®ä¿æ‰€æœ‰éƒ¨é—¨æ•¬ä¸šåº¦ä¸ä½äº60%<br>
                â€¢ å»ºç«‹å¯æŒç»­çš„å‘˜å·¥æ•¬ä¸šåº¦æå‡æœºåˆ¶`;
            }
            
            // æ•°æ®ç›¸å…³é—®é¢˜
            if (msg.includes('æ•°æ®') || msg.includes('ç»Ÿè®¡') || msg.includes('äººæ•°')) {
                return `ğŸ“‹ <strong>å…³é”®æ•°æ®æ€»è§ˆï¼š</strong><br><br>
                ğŸ‘¥ <strong>å‚ä¸æƒ…å†µï¼š</strong><br>
                â€¢ å‘˜å·¥æ€»æ•°ï¼š1,284äºº<br>
                â€¢ å¡«å†™äººæ•°ï¼š828äºº<br>
                â€¢ å¡«å†™ç‡ï¼š64.5%ï¼ˆè¾ƒå»å¹´æå‡14.5%ï¼‰<br><br>
                ğŸ“Š <strong>æ ¸å¿ƒæŒ‡æ ‡ï¼š</strong><br>
                â€¢ 2024å¹´æ•¬ä¸šåº¦ï¼š68%ï¼ˆâ†‘8% vs 2023ï¼‰<br>
                â€¢ 2024å¹´æ»¡æ„åº¦ï¼š68%ï¼ˆâ†‘8% vs 2023ï¼‰<br>
                â€¢ é«˜æ•ˆå‘˜å·¥æ¯”ä¾‹ï¼š62.8%<br><br>
                ğŸ¢ <strong>éƒ¨é—¨åˆ†å¸ƒï¼š</strong><br>
                â€¢ æœ€å¤§éƒ¨é—¨ï¼šTapTapï¼ˆ168äººï¼‰ã€åŸåŒ—å¤§ç‹å¯¨å·¥ä½œå®¤ï¼ˆ172äººï¼‰<br>
                â€¢ ç®¡ç†å²—ä½ï¼š157äºº<br>
                â€¢ éç®¡ç†å²—ä½ï¼š671äºº<br><br>
                ğŸ“ˆ <strong>è¶‹åŠ¿ï¼š</strong>å„é¡¹æŒ‡æ ‡å‡å‘ˆç°ç§¯æå‘ä¸Šè¶‹åŠ¿ï¼Œå‘˜å·¥æ•´ä½“çŠ¶æ€è‰¯å¥½ã€‚`;
            }
            
            // é»˜è®¤å›å¤
            return `ğŸ¤– <strong>æ™ºèƒ½åˆ†æåŠ©æ‰‹</strong><br><br>
            æ„Ÿè°¢æ‚¨çš„æé—®ï¼æˆ‘å¯ä»¥ä¸ºæ‚¨æä¾›ä»¥ä¸‹æ–¹é¢çš„ä¸“ä¸šåˆ†æï¼š<br><br>
            ğŸ“Š <strong>æ•°æ®åˆ†æï¼š</strong>éƒ¨é—¨è¡¨ç°ã€æ•¬ä¸šåº¦ã€æ»¡æ„åº¦è¶‹åŠ¿<br>
            ğŸ’¡ <strong>æ”¹è¿›å»ºè®®ï¼š</strong>é’ˆå¯¹æ€§çš„æå‡æ–¹æ¡ˆå’Œè¡ŒåŠ¨è®¡åˆ’<br>
            ğŸ” <strong>æ·±åº¦æ´å¯Ÿï¼š</strong>å‘˜å·¥åˆ†ç±»ã€ç®¡ç†å±‚å¯¹æ¯”ã€èŒçº§åˆ†æ<br><br>
            è¯·å‘Šè¯‰æˆ‘æ‚¨æœ€å…³å¿ƒçš„å…·ä½“é—®é¢˜ï¼Œæˆ‘ä¼šä¸ºæ‚¨æä¾›è¯¦ç»†çš„æ•°æ®åˆ†æå’Œä¸“ä¸šå»ºè®®ï¼`;
        }

        function handleKeyPress(event) {
            if (event.key === 'Enter' && !isAIResponding) {
                sendMessage();
            }
        }
    </script>
</body>
</html> 