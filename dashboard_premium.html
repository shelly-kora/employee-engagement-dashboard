<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¿ƒåŠ¨å‘˜å·¥æ•¬ä¸šåº¦è°ƒç ”æ•°æ® - ç®€çº¦ç‰ˆ</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <style>
        :root {
            /* ç®€çº¦ç™½è‰²ä¸»é¢˜é…è‰²æ–¹æ¡ˆ */
            --primary: #2563eb;
            --primary-dark: #1d4ed8;
            --primary-light: #3b82f6;
            --success: #059669;
            --success-light: #10b981;
            --warning: #d97706;
            --warning-light: #f59e0b;
            --danger: #dc2626;
            --danger-light: #ef4444;
            --info: #0891b2;
            --info-light: #06b6d4;
            
            /* ä¼˜é›…çš„æ¸å˜è‰² */
            --gradient-primary: linear-gradient(135deg, #2563eb 0%, #3b82f6 100%);
            --gradient-success: linear-gradient(135deg, #059669 0%, #10b981 100%);
            --gradient-warning: linear-gradient(135deg, #d97706 0%, #f59e0b 100%);
            --gradient-danger: linear-gradient(135deg, #dc2626 0%, #ef4444 100%);
            
            /* å¹²å‡€çš„èƒŒæ™¯è‰²å’Œè¡¨é¢è‰² */
            --bg-primary: #ffffff;
            --bg-secondary: #f8fafc;
            --surface: #ffffff;
            --surface-light: #f1f5f9;
            --surface-hover: #e2e8f0;
            
            /* ç°ä»£åŒ–çš„è¾¹æ¡†å’Œé˜´å½± */
            --border: #e2e8f0;
            --border-light: #f1f5f9;
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.1);
            --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.08);
            --shadow-lg: 0 10px 25px rgba(0, 0, 0, 0.1);
            --shadow-xl: 0 20px 40px rgba(0, 0, 0, 0.12);
            
            /* æ¸…æ™°çš„æ–‡å­—è‰²å½© */
            --text-primary: #0f172a;
            --text-secondary: #475569;
            --text-muted: #64748b;
            --text-light: #94a3b8;
            --text-inverse: #ffffff;
            
            /* ç»ç’ƒæ€æ•ˆæœ */
            --glass-bg: rgba(255, 255, 255, 0.8);
            --glass-border: rgba(226, 232, 240, 0.8);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
        }
        
        /* æ·»åŠ å¾®å¦™çš„èƒŒæ™¯çº¹ç† */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 80%, rgba(37, 99, 235, 0.03) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(5, 150, 105, 0.03) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(217, 119, 6, 0.02) 0%, transparent 50%);
            z-index: -1;
        }
        
        .header {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--border);
            padding: 20px 32px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: var(--shadow-sm);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .logo-section {
            display: flex;
            align-items: center;
            gap: 16px;
        }
        
        .logo {
            font-size: 28px;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 700;
        }
        
        .title-group h1 {
            font-size: 24px;
            font-weight: 700;
            color: var(--text-primary);
            margin: 0;
            letter-spacing: -0.5px;
        }
        
        .title-group .subtitle {
            font-size: 14px;
            color: var(--text-secondary);
            margin-top: 4px;
            font-weight: 500;
        }
        
        .actions {
            display: flex;
            gap: 12px;
        }
        
        .btn {
            padding: 12px 24px;
            border-radius: 12px;
            border: none;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }
        
        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.5s;
        }
        
        .btn:hover::before {
            left: 100%;
        }
        
        .btn-outline {
            background: var(--surface);
            border: 1px solid var(--border);
            color: var(--text-primary);
        }
        
        .btn-primary {
            background: var(--gradient-primary);
            color: white;
            box-shadow: var(--shadow-md);
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 32px 24px;
        }
        
        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 24px;
            margin-bottom: 32px;
        }
        
        .kpi-card {
            background: var(--surface);
            border-radius: 20px;
            padding: 32px;
            border: 1px solid var(--border);
            position: relative;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            overflow: hidden;
            box-shadow: var(--shadow-sm);
        }
        
        .kpi-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--gradient-primary);
        }
        
        .kpi-card:nth-child(2)::before {
            background: var(--gradient-success);
        }
        
        .kpi-card:nth-child(3)::before {
            background: var(--gradient-warning);
        }
        
        .kpi-card:nth-child(4)::before {
            background: var(--gradient-danger);
        }
        
        .kpi-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: var(--shadow-xl);
            border-color: var(--primary-light);
        }
        
        .kpi-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .kpi-title {
            font-size: 16px;
            color: var(--text-secondary);
            font-weight: 600;
            letter-spacing: 0.5px;
        }
        
        .kpi-icon {
            font-size: 32px;
            opacity: 0.8;
        }
        
        .kpi-value {
            font-size: 48px;
            font-weight: 800;
            color: var(--text-primary);
            margin-bottom: 12px;
            letter-spacing: -2px;
        }
        
        .kpi-change {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            font-weight: 600;
        }
        
        .trend-up {
            color: var(--success);
        }
        
        .trend-down {
            color: var(--danger);
        }
        
        .charts-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
            margin-bottom: 32px;
        }
        
        .chart-card {
            background: var(--surface);
            border-radius: 20px;
            padding: 32px;
            border: 1px solid var(--border);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: var(--shadow-sm);
        }
        
        .chart-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-lg);
        }
        
        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--border);
        }
        
        .chart-title {
            font-size: 20px;
            font-weight: 700;
            color: var(--text-primary);
            letter-spacing: -0.5px;
        }
        
        .chart-container {
            height: 360px;
            position: relative;
        }
        
        .full-width {
            grid-column: 1 / -1;
        }
        
        .tabs {
            display: flex;
            background: var(--surface-light);
            border-radius: 16px;
            padding: 8px;
            margin-bottom: 24px;
            border: 1px solid var(--border);
        }
        
        .tab {
            flex: 1;
            padding: 16px 24px;
            font-size: 14px;
            font-weight: 600;
            color: var(--text-secondary);
            cursor: pointer;
            border-radius: 12px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            text-align: center;
        }
        
        .tab.active {
            background: var(--surface);
            color: var(--primary);
            box-shadow: var(--shadow-sm);
        }
        
        .tab:hover:not(.active) {
            background: var(--surface-hover);
            color: var(--text-primary);
        }
        
        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border);
        }
        
        .data-table th {
            background: var(--surface-light);
            padding: 20px 24px;
            text-align: left;
            font-weight: 700;
            color: var(--text-primary);
            border-bottom: 2px solid var(--border);
            font-size: 13px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .data-table td {
            padding: 20px 24px;
            border-bottom: 1px solid var(--border);
            background: var(--surface);
        }
        
        .data-table tr:hover td {
            background: var(--surface-light);
        }
        
        .metric-badge {
            display: inline-flex;
            align-items: center;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .badge-excellent {
            background: var(--gradient-success);
            color: white;
            box-shadow: 0 4px 12px rgba(5, 150, 105, 0.2);
        }
        
        .badge-good {
            background: var(--gradient-warning);
            color: white;
            box-shadow: 0 4px 12px rgba(217, 119, 6, 0.2);
        }
        
        .badge-poor {
            background: var(--gradient-danger);
            color: white;
            box-shadow: 0 4px 12px rgba(220, 38, 38, 0.2);
        }
        
        .department-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(340px, 1fr));
            gap: 20px;
            margin-top: 24px;
        }
        
        .department-card {
            background: var(--surface);
            border-radius: 16px;
            padding: 24px;
            border: 1px solid var(--border);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow-sm);
        }
        
        .department-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-lg);
        }
        
        .department-name {
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 16px;
            font-size: 16px;
            letter-spacing: -0.5px;
        }
        
        .department-metrics {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
        }
        
        .metric {
            text-align: center;
            padding: 16px;
            background: var(--surface-light);
            border-radius: 12px;
            transition: all 0.3s ease;
        }
        
        .metric:hover {
            background: var(--surface-hover);
            transform: scale(1.05);
        }
        
        .metric-value {
            font-size: 24px;
            font-weight: 800;
            color: var(--primary);
            margin-bottom: 4px;
            letter-spacing: -1px;
        }
        
        .metric-label {
            font-size: 12px;
            color: var(--text-muted);
            margin-top: 4px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .hidden {
            display: none !important;
        }
        
        .chatbot {
            position: fixed;
            bottom: 24px;
            right: 24px;
            width: 400px;
            height: 600px;
            background: var(--surface);
            border-radius: 20px;
            border: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            z-index: 1000;
            box-shadow: var(--shadow-xl);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .chatbot.hidden {
            display: none !important;
        }
        
        .chatbot:hover {
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
        }
        
        .chatbot-header {
            padding: 20px;
            background: var(--gradient-primary);
            color: white;
            border-radius: 20px 20px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 600;
        }
        
        .chatbot-close {
            background: none;
            border: none;
            color: white;
            font-size: 20px;
            cursor: pointer;
            padding: 8px;
            border-radius: 8px;
            transition: all 0.3s ease;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .chatbot-close:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.1);
        }
        
        .chatbot-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: var(--border) transparent;
        }
        
        .chatbot-messages::-webkit-scrollbar {
            width: 6px;
        }
        
        .chatbot-messages::-webkit-scrollbar-track {
            background: transparent;
        }
        
        .chatbot-messages::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 3px;
        }
        
        .message {
            margin-bottom: 16px;
            padding: 16px 20px;
            border-radius: 16px;
            max-width: 90%;
            font-size: 14px;
            line-height: 1.6;
            animation: slideIn 0.3s ease;
            word-wrap: break-word;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .message.user {
            background: var(--gradient-primary);
            color: white;
            margin-left: auto;
            border-bottom-right-radius: 4px;
        }
        
        .message.bot {
            background: var(--surface-light);
            color: var(--text-primary);
            border-bottom-left-radius: 4px;
            border: 1px solid var(--border);
        }
        
        .chatbot-input {
            padding: 20px;
            border-top: 1px solid var(--border);
            display: flex;
            gap: 12px;
            background: var(--surface);
        }
        
        .chatbot-input input {
            flex: 1;
            padding: 12px 16px;
            border: 1px solid var(--border);
            border-radius: 12px;
            background: var(--surface);
            color: var(--text-primary);
            font-size: 14px;
            outline: none;
            transition: all 0.3s ease;
        }
        
        .chatbot-input input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }
        
        .chatbot-input input::placeholder {
            color: var(--text-muted);
        }
        
        .chatbot-input button {
            padding: 12px 20px;
            background: var(--gradient-primary);
            border: none;
            border-radius: 12px;
            color: white;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            min-width: 60px;
        }
        
        .chatbot-input button:hover {
            transform: scale(1.05);
            box-shadow: var(--shadow-md);
        }
        
        .chatbot-input button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .typing-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 16px 20px;
            margin-bottom: 16px;
            background: var(--surface-light);
            border-radius: 16px;
            border-bottom-left-radius: 4px;
            max-width: 90%;
            border: 1px solid var(--border);
        }
        
        .typing-dots {
            display: flex;
            gap: 4px;
        }
        
        .typing-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--primary);
            animation: typing 1.4s infinite ease-in-out;
        }
        
        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }
        
        @keyframes typing {
            0%, 80%, 100% { transform: scale(0.8); opacity: 0.5; }
            40% { transform: scale(1); opacity: 1; }
        }
        
        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .charts-grid {
                grid-template-columns: 1fr;
            }
            
            .kpi-grid {
                grid-template-columns: 1fr;
            }
            
            .container {
                padding: 20px 16px;
            }
            
            .chatbot {
                width: calc(100vw - 32px);
                height: calc(100vh - 120px);
                right: 16px;
                bottom: 16px;
            }
        }
        
        /* åŠ è½½åŠ¨ç”» */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid var(--border);
            border-radius: 50%;
            border-top-color: var(--primary);
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="logo-section">
            <div class="logo">â™¥</div>
            <div class="title-group">
                <h1>å¿ƒåŠ¨å‘˜å·¥æ•¬ä¸šåº¦è°ƒç ”æ•°æ®</h1>
                <div class="subtitle">2024å¹´åº¦åˆ†ææŠ¥å‘Š - ç®€çº¦ç‰ˆ</div>
            </div>
        </div>
        <div class="actions">
            <button class="btn btn-outline" onclick="document.getElementById('file-input').click()">
                ğŸ“Š å¯¼å…¥æ•°æ®
            </button>
            <button class="btn btn-primary" onclick="toggleChatbot()">
                ğŸ’¬ AIåŠ©æ‰‹
            </button>
        </div>
    </div>
    
    <input type="file" id="file-input" accept=".xlsx,.xls" style="display: none;" onchange="handleFileUpload(event)">
    
    <div class="container">
        <!-- KPI å¡ç‰‡ -->
        <div class="kpi-grid">
            <div class="kpi-card">
                <div class="kpi-header">
                    <div class="kpi-title">æ€»ä½“æ•¬ä¸šåº¦</div>
                    <div class="kpi-icon">ğŸ“ˆ</div>
                </div>
                <div class="kpi-value">68%</div>
                <div class="kpi-change trend-up">
                    â–² +8% è¾ƒå»å¹´
                </div>
            </div>
            
            <div class="kpi-card">
                <div class="kpi-header">
                    <div class="kpi-title">æ€»ä½“æ»¡æ„åº¦</div>
                    <div class="kpi-icon">ğŸ˜Š</div>
                </div>
                <div class="kpi-value">68%</div>
                <div class="kpi-change trend-up">
                    â–² +8% è¾ƒå»å¹´
                </div>
            </div>
            
            <div class="kpi-card">
                <div class="kpi-header">
                    <div class="kpi-title">å‚ä¸ç‡</div>
                    <div class="kpi-icon">ğŸ‘¥</div>
                </div>
                <div class="kpi-value">64.5%</div>
                <div class="kpi-change">
                    828 / 1,284 äºº
                </div>
            </div>
            
            <div class="kpi-card">
                <div class="kpi-header">
                    <div class="kpi-title">é«˜æ•ˆå‘˜å·¥æ¯”ä¾‹</div>
                    <div class="kpi-icon">â­</div>
                </div>
                <div class="kpi-value">46%</div>
                <div class="kpi-change trend-up">
                    æ•¬ä¸šä¸”æ»¡æ„
                </div>
            </div>
        </div>
        
        <!-- å›¾è¡¨åŒºåŸŸ -->
        <div class="charts-grid">
            <div class="chart-card">
                <div class="chart-header">
                    <div class="chart-title">æ•¬ä¸šåº¦-æ»¡æ„åº¦è±¡é™åˆ†æ</div>
                </div>
                <div class="chart-container">
                    <canvas id="quadrant-chart"></canvas>
                </div>
            </div>
            
            <div class="chart-card">
                <div class="chart-header">
                    <div class="chart-title">å¹´åº¦è¶‹åŠ¿å¯¹æ¯”</div>
                </div>
                <div class="chart-container">
                    <canvas id="yearly-trend"></canvas>
                </div>
            </div>
        </div>
        
        <!-- éƒ¨é—¨è¡¨ç° -->
        <div class="chart-card full-width">
            <div class="chart-header">
                <div class="chart-title">éƒ¨é—¨è¡¨ç°åˆ†æ</div>
            </div>
            
            <div class="tabs">
                <div class="tab active" onclick="switchDepartmentTab('all')">å…¨éƒ¨é—¨</div>
                <div class="tab" onclick="switchDepartmentTab('management')">ç®¡ç†å±‚çº§</div>
                <div class="tab" onclick="switchDepartmentTab('position')">èŒçº§åˆ†æ</div>
            </div>
            
            <div id="department-grid" class="department-grid"></div>
        </div>
    </div>
    
    <!-- æ™ºèƒ½èŠå¤©æœºå™¨äºº -->
    <div class="chatbot hidden" id="chatbot">
        <div class="chatbot-header">
            <div>ğŸ¤– æ™ºèƒ½æ•°æ®åˆ†æåŠ©æ‰‹</div>
            <button class="chatbot-close" onclick="toggleChatbot()" title="å…³é—­åŠ©æ‰‹">Ã—</button>
        </div>
        <div class="chatbot-messages" id="chat-messages">
            <div class="message bot">
                ğŸ‘‹ æ‚¨å¥½ï¼æˆ‘æ˜¯æ‚¨çš„ä¸“ä¸šæ•°æ®åˆ†æåŠ©æ‰‹ã€‚æˆ‘å¯ä»¥å¸®æ‚¨æ·±å…¥åˆ†æå‘˜å·¥æ•¬ä¸šåº¦æ•°æ®ï¼Œæä¾›ä¸“ä¸šè§è§£å’Œæ”¹è¿›å»ºè®®ã€‚
                
                <br><br>æ‚¨å¯ä»¥è¯¢é—®ï¼š
                <br>â€¢ ğŸ“Š å„éƒ¨é—¨è¡¨ç°å¯¹æ¯”åˆ†æ
                <br>â€¢ ğŸ“ˆ æ•¬ä¸šåº¦è¶‹åŠ¿å˜åŒ–åŸå› 
                <br>â€¢ ğŸ’¡ é’ˆå¯¹æ€§æ”¹è¿›å»ºè®®
                <br>â€¢ ğŸ¯ é‡ç‚¹å…³æ³¨æŒ‡æ ‡è§£è¯»
                <br>â€¢ ğŸ“‹ ç®¡ç†å±‚ä¸å‘˜å·¥å·®å¼‚åˆ†æ
            </div>
        </div>
        <div class="chatbot-input">
            <input type="text" id="chat-input" placeholder="è¯·è¾“å…¥æ‚¨çš„é—®é¢˜..." onkeypress="if(event.key==='Enter' && !event.shiftKey) { event.preventDefault(); sendMessage(); }">
            <button onclick="sendMessage()" id="send-btn">å‘é€</button>
        </div>
    </div>
    
    <script>
        let departmentData = [];
        let surveyData = {};
        let isTyping = false;
        
        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            createQuadrantChart();
            createYearlyTrendChart();
            loadDepartmentData();
        });
        
        function createQuadrantChart() {
            const ctx = document.getElementById('quadrant-chart').getContext('2d');
            
            new Chart(ctx, {
                type: 'bubble',
                data: {
                    datasets: [
                        {
                            label: 'é«˜æ•ˆå‘˜å·¥ (æ•¬ä¸šä¸”æ»¡æ„)',
                            data: [{x: 75, y: 75, r: 20}],
                            backgroundColor: 'rgba(5, 150, 105, 0.8)',
                            borderColor: '#059669',
                            borderWidth: 3,
                            hoverBorderWidth: 5
                        },
                        {
                            label: 'å—æŒ«å‘˜å·¥ (æ•¬ä¸šä¸æ»¡æ„)', 
                            data: [{x: 25, y: 75, r: 12}],
                            backgroundColor: 'rgba(217, 119, 6, 0.8)',
                            borderColor: '#d97706',
                            borderWidth: 3,
                            hoverBorderWidth: 5
                        },
                        {
                            label: 'æ¼ ç„¶å‘˜å·¥ (ä¸æ•¬ä¸šä½†æ»¡æ„)',
                            data: [{x: 75, y: 25, r: 15}],
                            backgroundColor: 'rgba(37, 99, 235, 0.8)',
                            borderColor: '#2563eb',
                            borderWidth: 3,
                            hoverBorderWidth: 5
                        },
                        {
                            label: 'ä½æ•ˆå‘˜å·¥ (ä¸æ•¬ä¸šä¸æ»¡æ„)',
                            data: [{x: 25, y: 25, r: 18}],
                            backgroundColor: 'rgba(220, 38, 38, 0.8)',
                            borderColor: '#dc2626',
                            borderWidth: 3,
                            hoverBorderWidth: 5
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { 
                            position: 'bottom',
                            labels: {
                                color: '#0f172a',
                                font: { size: 12, weight: '600' },
                                padding: 20,
                                usePointStyle: true,
                                pointStyle: 'circle'
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(255, 255, 255, 0.95)',
                            titleColor: '#0f172a',
                            bodyColor: '#475569',
                            borderColor: '#e2e8f0',
                            borderWidth: 1,
                            cornerRadius: 12,
                            padding: 12,
                            callbacks: {
                                label: function(context) {
                                    return `${context.dataset.label}: ${context.parsed.y}% æ•¬ä¸šåº¦, ${context.parsed.x}% æ»¡æ„åº¦`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            title: { 
                                display: true, 
                                text: 'æ»¡æ„åº¦ (%)',
                                color: '#475569',
                                font: { size: 14, weight: '600' }
                            },
                            min: 0,
                            max: 100,
                            grid: { 
                                color: 'rgba(226, 232, 240, 0.8)',
                                drawOnChartArea: true
                            },
                            ticks: { color: '#64748b', font: { size: 12 } }
                        },
                        y: {
                            title: { 
                                display: true, 
                                text: 'æ•¬ä¸šåº¦ (%)',
                                color: '#475569',
                                font: { size: 14, weight: '600' }
                            },
                            min: 0,
                            max: 100,
                            grid: { 
                                color: 'rgba(226, 232, 240, 0.8)',
                                drawOnChartArea: true
                            },
                            ticks: { color: '#64748b', font: { size: 12 } }
                        }
                    },
                    animation: {
                        duration: 2000,
                        easing: 'easeOutQuart'
                    }
                }
            });
        }
        
        function createYearlyTrendChart() {
            const ctx = document.getElementById('yearly-trend').getContext('2d');
            
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['2023å¹´', '2024å¹´'],
                    datasets: [
                        {
                            label: 'æ•¬ä¸šåº¦',
                            data: [60, 68],
                            borderColor: '#2563eb',
                            backgroundColor: 'rgba(37, 99, 235, 0.1)',
                            borderWidth: 4,
                            fill: true,
                            tension: 0.4,
                            pointBackgroundColor: '#2563eb',
                            pointBorderColor: '#ffffff',
                            pointBorderWidth: 3,
                            pointRadius: 8,
                            pointHoverRadius: 12
                        },
                        {
                            label: 'æ»¡æ„åº¦',
                            data: [60, 68],
                            borderColor: '#059669',
                            backgroundColor: 'rgba(5, 150, 105, 0.1)',
                            borderWidth: 4,
                            fill: true,
                            tension: 0.4,
                            pointBackgroundColor: '#059669',
                            pointBorderColor: '#ffffff',
                            pointBorderWidth: 3,
                            pointRadius: 8,
                            pointHoverRadius: 12
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { 
                            position: 'top',
                            labels: {
                                color: '#0f172a',
                                font: { size: 14, weight: '600' },
                                padding: 20,
                                usePointStyle: true
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(255, 255, 255, 0.95)',
                            titleColor: '#0f172a',
                            bodyColor: '#475569',
                            borderColor: '#e2e8f0',
                            borderWidth: 1,
                            cornerRadius: 12,
                            padding: 12
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            grid: { 
                                color: 'rgba(226, 232, 240, 0.8)',
                                drawOnChartArea: true
                            },
                            ticks: { 
                                callback: value => value + '%',
                                color: '#64748b',
                                font: { size: 12 }
                            },
                            title: {
                                display: true,
                                text: 'ç™¾åˆ†æ¯” (%)',
                                color: '#475569',
                                font: { size: 14, weight: '600' }
                            }
                        },
                        x: {
                            grid: { display: false },
                            ticks: { 
                                color: '#64748b',
                                font: { size: 12, weight: '600' }
                            }
                        }
                    },
                    animation: {
                        duration: 2000,
                        easing: 'easeOutQuart'
                    }
                }
            });
        }
        
        function loadDepartmentData() {
            // æ¨¡æ‹Ÿéƒ¨é—¨æ•°æ®
            departmentData = [
                {name: 'è´¢åŠ¡éƒ¨', count: 10, engagement: 40, satisfaction: 40, efficiency: 40},
                {name: 'åŸåŒ—å¤§ç‹å¯¨å·¥ä½œå®¤', count: 172, engagement: 60, satisfaction: 61, efficiency: 55},
                {name: 'TapTap', count: 89, engagement: 72, satisfaction: 70, efficiency: 65},
                {name: 'è‡ªç ”éƒ¨', count: 120, engagement: 75, satisfaction: 78, efficiency: 68},
                {name: 'è¿è¥éƒ¨', count: 95, engagement: 65, satisfaction: 68, efficiency: 58}
            ];
            
            updateDepartmentGrid();
        }
        
        function updateDepartmentGrid() {
            const grid = document.getElementById('department-grid');
            grid.innerHTML = '';
            
            departmentData.forEach(dept => {
                const card = document.createElement('div');
                card.className = 'department-card';
                card.innerHTML = `
                    <div class="department-name">${dept.name}</div>
                    <div class="department-metrics">
                        <div class="metric">
                            <div class="metric-value">${dept.count}</div>
                            <div class="metric-label">å¡«å†™äººæ•°</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value">${dept.engagement}%</div>
                            <div class="metric-label">æ•¬ä¸šåº¦</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value">${dept.satisfaction}%</div>
                            <div class="metric-label">æ»¡æ„åº¦</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value">${dept.efficiency}%</div>
                            <div class="metric-label">é«˜æ•ˆæ¯”ä¾‹</div>
                        </div>
                    </div>
                `;
                grid.appendChild(card);
            });
        }
        
        function switchDepartmentTab(tabType) {
            // æ›´æ–°é€‰ä¸­çŠ¶æ€
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            event.target.classList.add('active');
            
            // æ ¹æ®é€‰æ‹©çš„æ ‡ç­¾é¡µæ›´æ–°æ•°æ®
            switch(tabType) {
                case 'management':
                    showManagementData();
                    break;
                case 'position':
                    showPositionData();
                    break;
                default:
                    updateDepartmentGrid();
            }
        }
        
        function showManagementData() {
            const grid = document.getElementById('department-grid');
            grid.innerHTML = '';
            
            const managementData = [
                {å²—ä½ç±»å‹: 'ç®¡ç†å²—ä½', å¡«å†™äººæ•°: 158, æ•¬ä¸šåº¦: 0.764, æ»¡æ„åº¦: 0.783, æ•¬ä¸šä¸”æ»¡æ„: 0.599},
                {å²—ä½ç±»å‹: 'éç®¡ç†å²—ä½', å¡«å†™äººæ•°: 670, æ•¬ä¸šåº¦: 0.662, æ»¡æ„åº¦: 0.654, æ•¬ä¸šä¸”æ»¡æ„: 0.432}
            ];
            
            managementData.forEach(item => {
                const card = document.createElement('div');
                card.className = 'department-card';
                card.innerHTML = `
                    <div class="department-name">${item.å²—ä½ç±»å‹}</div>
                    <div class="department-metrics">
                        <div class="metric">
                            <div class="metric-value">${item.å¡«å†™äººæ•°}</div>
                            <div class="metric-label">å¡«å†™äººæ•°</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value">${Math.round(item.æ•¬ä¸šåº¦ * 100)}%</div>
                            <div class="metric-label">æ•¬ä¸šåº¦</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value">${Math.round(item.æ»¡æ„åº¦ * 100)}%</div>
                            <div class="metric-label">æ»¡æ„åº¦</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value">${Math.round(item.æ•¬ä¸šä¸”æ»¡æ„ * 100)}%</div>
                            <div class="metric-label">é«˜æ•ˆæ¯”ä¾‹</div>
                        </div>
                    </div>
                `;
                grid.appendChild(card);
            });
        }
        
        function showPositionData() {
            const grid = document.getElementById('department-grid');
            grid.innerHTML = '';
            
            const positionData = [
                {èŒçº§ç±»å‹: 'é«˜çº§èŒçº§', å¡«å†™äººæ•°: 203, æ•¬ä¸šåº¦: 0.708, æ»¡æ„åº¦: 0.723, æ•¬ä¸šä¸”æ»¡æ„: 0.512},
                {èŒçº§ç±»å‹: 'ä¸­ä½çº§èŒçº§', å¡«å†™äººæ•°: 625, æ•¬ä¸šåº¦: 0.664, æ»¡æ„åº¦: 0.663, æ•¬ä¸šä¸”æ»¡æ„: 0.440}
            ];
            
            positionData.forEach(item => {
                const card = document.createElement('div');
                card.className = 'department-card';
                card.innerHTML = `
                    <div class="department-name">${item.èŒçº§ç±»å‹}</div>
                    <div class="department-metrics">
                        <div class="metric">
                            <div class="metric-value">${item.å¡«å†™äººæ•°}</div>
                            <div class="metric-label">å¡«å†™äººæ•°</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value">${Math.round(item.æ•¬ä¸šåº¦ * 100)}%</div>
                            <div class="metric-label">æ•¬ä¸šåº¦</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value">${Math.round(item.æ»¡æ„åº¦ * 100)}%</div>
                            <div class="metric-label">æ»¡æ„åº¦</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value">${Math.round(item.æ•¬ä¸šä¸”æ»¡æ„ * 100)}%</div>
                            <div class="metric-label">é«˜æ•ˆæ¯”ä¾‹</div>
                        </div>
                    </div>
                `;
                grid.appendChild(card);
            });
        }
        
        function toggleChatbot() {
            const chatbot = document.getElementById('chatbot');
            if (chatbot) {
                const isHidden = chatbot.classList.contains('hidden');
                console.log('Chatbot current state:', isHidden ? 'hidden' : 'visible');
                
                if (isHidden) {
                    chatbot.classList.remove('hidden');
                    console.log('Showing chatbot');
                } else {
                    chatbot.classList.add('hidden');
                    console.log('Hiding chatbot');
                }
            } else {
                console.error('Chatbot element not found');
            }
        }
        
        function showTypingIndicator() {
            const messages = document.getElementById('chat-messages');
            const typingDiv = document.createElement('div');
            typingDiv.className = 'typing-indicator';
            typingDiv.id = 'typing-indicator';
            typingDiv.innerHTML = `
                <span style="color: #64748b; font-size: 13px;">AIæ­£åœ¨æ€è€ƒ</span>
                <div class="typing-dots">
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                </div>
            `;
            messages.appendChild(typingDiv);
            messages.scrollTop = messages.scrollHeight;
        }
        
        function hideTypingIndicator() {
            const typingIndicator = document.getElementById('typing-indicator');
            if (typingIndicator) {
                typingIndicator.remove();
            }
        }
        
        async function sendMessage() {
            const input = document.getElementById('chat-input');
            const sendBtn = document.getElementById('send-btn');
            const message = input.value.trim();
            
            if (!message || isTyping) return;
            
            const messages = document.getElementById('chat-messages');
            
            // æ·»åŠ ç”¨æˆ·æ¶ˆæ¯
            const userMsg = document.createElement('div');
            userMsg.className = 'message user';
            userMsg.textContent = message;
            messages.appendChild(userMsg);
            
            // æ¸…ç©ºè¾“å…¥æ¡†å¹¶ç¦ç”¨å‘é€æŒ‰é’®
            input.value = '';
            sendBtn.disabled = true;
            isTyping = true;
            
            // æ˜¾ç¤ºæ‰“å­—æŒ‡ç¤ºå™¨
            showTypingIndicator();
            
            // æ¨¡æ‹Ÿæ€è€ƒæ—¶é—´
            await new Promise(resolve => setTimeout(resolve, 1500 + Math.random() * 1000));
            
            // éšè—æ‰“å­—æŒ‡ç¤ºå™¨
            hideTypingIndicator();
            
            // ç”Ÿæˆæ™ºèƒ½å›å¤
            const botMsg = document.createElement('div');
            botMsg.className = 'message bot';
            botMsg.innerHTML = generateIntelligentResponse(message);
            messages.appendChild(botMsg);
            
            // é‡æ–°å¯ç”¨å‘é€æŒ‰é’®
            sendBtn.disabled = false;
            isTyping = false;
            
            messages.scrollTop = messages.scrollHeight;
        }
        
        function generateIntelligentResponse(message) {
            const msg = message.toLowerCase();
            
            // æ™ºèƒ½å…³é”®è¯åˆ†æå’Œä¸Šä¸‹æ–‡ç†è§£
            if (msg.includes('æ•¬ä¸šåº¦æœ€é«˜') || msg.includes('è¡¨ç°æœ€å¥½') || msg.includes('æ’åç¬¬ä¸€')) {
                return `<strong>ğŸ“Š éƒ¨é—¨è¡¨ç°åˆ†æ</strong><br><br>
                æ ¹æ®å½“å‰æ•°æ®ï¼Œ<strong>è‡ªç ”éƒ¨</strong>è¡¨ç°æœ€ä¸ºçªå‡ºï¼š<br>
                â€¢ æ•¬ä¸šåº¦ï¼š75%ï¼ˆè¿œè¶…å¹³å‡æ°´å¹³ï¼‰<br>
                â€¢ æ»¡æ„åº¦ï¼š78%ï¼ˆå…¨å…¬å¸æœ€é«˜ï¼‰<br>
                â€¢ é«˜æ•ˆå‘˜å·¥æ¯”ä¾‹ï¼š68%<br><br>
                <strong>ğŸ’¡ æˆåŠŸå› ç´ åˆ†æï¼š</strong><br>
                1. æŠ€æœ¯é©±åŠ¨çš„å·¥ä½œç¯å¢ƒæ¿€å‘åˆ›æ–°çƒ­æƒ…<br>
                2. é¡¹ç›®è‡ªä¸»æ€§é«˜ï¼Œå‘˜å·¥æˆå°±æ„Ÿå¼º<br>
                3. å›¢é˜Ÿåä½œæ°›å›´è‰¯å¥½<br><br>
                å»ºè®®å°†è‡ªç ”éƒ¨çš„ç®¡ç†ç»éªŒæ¨å¹¿åˆ°å…¶ä»–éƒ¨é—¨ã€‚`;
            }
            
            if (msg.includes('è´¢åŠ¡éƒ¨') || msg.includes('è¡¨ç°æœ€å·®') || msg.includes('éœ€è¦æ”¹è¿›')) {
                return `<strong>âš ï¸ è´¢åŠ¡éƒ¨é—¨æ·±åº¦åˆ†æ</strong><br><br>
                è´¢åŠ¡éƒ¨ç¡®å®éœ€è¦é‡ç‚¹å…³æ³¨ï¼Œå„é¡¹æŒ‡æ ‡å‡å¤„äºè¾ƒä½æ°´å¹³ï¼š<br>
                â€¢ æ•¬ä¸šåº¦ï¼š40%ï¼ˆä½äºå¹³å‡28ä¸ªç™¾åˆ†ç‚¹ï¼‰<br>
                â€¢ æ»¡æ„åº¦ï¼š40%ï¼ˆéœ€è¦ç´§æ€¥æ”¹å–„ï¼‰<br>
                â€¢ å¡«å†™äººæ•°ï¼šä»…10äººï¼ˆå¯èƒ½å­˜åœ¨å‚ä¸åº¦é—®é¢˜ï¼‰<br><br>
                <strong>ğŸ¯ æ”¹è¿›å»ºè®®ï¼š</strong><br>
                1. <strong>å·¥ä½œç¯å¢ƒä¼˜åŒ–</strong>ï¼šæ”¹å–„åŠå…¬æ¡ä»¶ï¼Œæä¾›æ›´å¥½çš„å·¥ä½œå·¥å…·<br>
                2. <strong>èŒä¸šå‘å±•è§„åˆ’</strong>ï¼šä¸ºè´¢åŠ¡äººå‘˜åˆ¶å®šæ¸…æ™°çš„æ™‹å‡è·¯å¾„<br>
                3. <strong>å·¥ä½œè´Ÿè·å¹³è¡¡</strong>ï¼šåˆç†åˆ†é…å·¥ä½œé‡ï¼Œé¿å…è¿‡åº¦åŠ ç­<br>
                4. <strong>å›¢é˜Ÿå»ºè®¾æ´»åŠ¨</strong>ï¼šå¢å¼ºéƒ¨é—¨å‡èšåŠ›å’Œå½’å±æ„Ÿ<br>
                5. <strong>è–ªé…¬ç¦åˆ©review</strong>ï¼šç¡®ä¿è–ªé…¬ä½“ç³»çš„ç«äº‰åŠ›`;
            }
            
            if (msg.includes('ç®¡ç†') && (msg.includes('éç®¡ç†') || msg.includes('å·®å¼‚') || msg.includes('å¯¹æ¯”'))) {
                return `<strong>ğŸ‘” ç®¡ç†å±‚vséç®¡ç†å±‚å¯¹æ¯”åˆ†æ</strong><br><br>
                æ•°æ®æ˜¾ç¤ºä¸¤ä¸ªç¾¤ä½“é—´å­˜åœ¨æ˜æ˜¾å·®å¼‚ï¼š<br><br>
                <strong>ç®¡ç†å²—ä½ï¼ˆ158äººï¼‰ï¼š</strong><br>
                â€¢ æ•¬ä¸šåº¦ï¼š76.4% â¬†ï¸<br>
                â€¢ æ»¡æ„åº¦ï¼š78.3% â¬†ï¸<br>
                â€¢ é«˜æ•ˆæ¯”ä¾‹ï¼š59.9% â¬†ï¸<br><br>
                <strong>éç®¡ç†å²—ä½ï¼ˆ670äººï¼‰ï¼š</strong><br>
                â€¢ æ•¬ä¸šåº¦ï¼š66.2% â¬‡ï¸<br>
                â€¢ æ»¡æ„åº¦ï¼š65.4% â¬‡ï¸<br>
                â€¢ é«˜æ•ˆæ¯”ä¾‹ï¼š43.2% â¬‡ï¸<br><br>
                <strong>ğŸ” å·®å¼‚åŸå› åˆ†æï¼š</strong><br>
                1. <strong>å†³ç­–å‚ä¸åº¦</strong>ï¼šç®¡ç†å±‚æœ‰æ›´å¤šè¯è¯­æƒ<br>
                2. <strong>èŒä¸šå‘å±•æœºä¼š</strong>ï¼šæ™‹å‡é€šé“ç›¸å¯¹æ¸…æ™°<br>
                3. <strong>è–ªé…¬å¾…é‡</strong>ï¼šæ”¶å…¥æ°´å¹³å·®å¼‚<br>
                4. <strong>å·¥ä½œè‡ªä¸»æ€§</strong>ï¼šç®¡ç†å±‚äº«æœ‰æ›´é«˜è‡ªä¸»æƒ<br><br>
                <strong>ğŸ’¡ ç¼©å°å·®è·çš„å»ºè®®ï¼š</strong><br>
                â€¢ å»ºç«‹å‘˜å·¥å‚ä¸å†³ç­–çš„æœºåˆ¶<br>
                â€¢ å®Œå–„éç®¡ç†å²—ä½çš„èŒä¸šå‘å±•è·¯å¾„<br>
                â€¢ æä¾›æ›´å¤šåŸ¹è®­å’Œæˆé•¿æœºä¼š<br>
                â€¢ ä¼˜åŒ–ç»©æ•ˆè€ƒæ ¸å’Œæ¿€åŠ±æœºåˆ¶`;
            }
            
            if (msg.includes('è¶‹åŠ¿') || msg.includes('å˜åŒ–') || msg.includes('å¢é•¿') || msg.includes('2023') || msg.includes('2024')) {
                return `<strong>ğŸ“ˆ å¹´åº¦è¶‹åŠ¿æ·±åº¦è§£è¯»</strong><br><br>
                2024å¹´æ•°æ®æ˜¾ç¤ºç§¯æå‘ä¸Šçš„å‘å±•è¶‹åŠ¿ï¼š<br><br>
                <strong>æ•´ä½“æå‡æƒ…å†µï¼š</strong><br>
                â€¢ æ•¬ä¸šåº¦ï¼š60% â†’ 68% (+8ä¸ªç™¾åˆ†ç‚¹) ğŸš€<br>
                â€¢ æ»¡æ„åº¦ï¼š60% â†’ 68% (+8ä¸ªç™¾åˆ†ç‚¹) ğŸš€<br><br>
                <strong>âœ¨ å¢é•¿é©±åŠ¨å› ç´ åˆ†æï¼š</strong><br>
                1. <strong>ä¼ä¸šæ–‡åŒ–å»ºè®¾</strong>ï¼šä»·å€¼è§‚å®£è´¯æ•ˆæœæ˜¾è‘—<br>
                2. <strong>ç®¡ç†åˆ¶åº¦ä¼˜åŒ–</strong>ï¼šæ›´åŠ äººæ€§åŒ–çš„ç®¡ç†æ–¹å¼<br>
                3. <strong>å‘˜å·¥ç¦åˆ©æå‡</strong>ï¼šè–ªé…¬ç¦åˆ©ä½“ç³»çš„æŒç»­æ”¹å–„<br>
                4. <strong>å·¥ä½œç¯å¢ƒæ”¹å–„</strong>ï¼šåŠå…¬æ¡ä»¶å’Œæ°›å›´çš„æå‡<br>
                5. <strong>å‘å±•æœºä¼šå¢åŠ </strong>ï¼šåŸ¹è®­å’Œæ™‹å‡æœºä¼šçš„å¢å¤š<br><br>
                <strong>ğŸ¯ æœªæ¥å‘å±•å»ºè®®ï¼š</strong><br>
                â€¢ ä¿æŒç°æœ‰ç§¯æè¶‹åŠ¿ï¼Œå·©å›ºæ”¹é©æˆæœ<br>
                â€¢ é‡ç‚¹å…³æ³¨ç›¸å¯¹è–„å¼±çš„éƒ¨é—¨å’Œç¾¤ä½“<br>
                â€¢ å»ºç«‹é•¿æ•ˆçš„å‘˜å·¥åé¦ˆå’Œæ”¹è¿›æœºåˆ¶<br>
                â€¢ è®¾å®š2025å¹´çš„æ›´é«˜ç›®æ ‡ï¼ˆå»ºè®®75%ä»¥ä¸Šï¼‰`;
            }
            
            if (msg.includes('å»ºè®®') || msg.includes('æ”¹è¿›') || msg.includes('æå‡') || msg.includes('æ€ä¹ˆ') || msg.includes('å¦‚ä½•')) {
                return `<strong>ğŸ¯ å‘˜å·¥æ•¬ä¸šåº¦æå‡å…¨æ–¹ä½å»ºè®®</strong><br><br>
                åŸºäºæ•°æ®åˆ†æï¼Œä¸ºæ‚¨æä¾›ç³»ç»Ÿæ€§æ”¹è¿›æ–¹æ¡ˆï¼š<br><br>
                <strong>ğŸ† çŸ­æœŸè¡ŒåŠ¨è®¡åˆ’ï¼ˆ1-3ä¸ªæœˆï¼‰ï¼š</strong><br>
                1. <strong>å»ºç«‹å®šæœŸæ²Ÿé€šæœºåˆ¶</strong>ï¼šæ¯æœˆéƒ¨é—¨åº§è°ˆä¼š<br>
                2. <strong>ä¼˜åŒ–å·¥ä½œç¯å¢ƒ</strong>ï¼šæ”¹å–„åŠå…¬è®¾æ–½å’Œæ°›å›´<br>
                3. <strong>æ¨è¡Œçµæ´»å·¥ä½œåˆ¶</strong>ï¼šè¿œç¨‹åŠå…¬ã€å¼¹æ€§æ—¶é—´<br>
                4. <strong>åŠ å¼ºå›¢é˜Ÿå»ºè®¾</strong>ï¼šç»„ç»‡å›¢å»ºå’Œäº¤æµæ´»åŠ¨<br><br>
                <strong>ğŸ“‹ ä¸­æœŸå‘å±•ç­–ç•¥ï¼ˆ3-12ä¸ªæœˆï¼‰ï¼š</strong><br>
                1. <strong>å®Œå–„èŒä¸šå‘å±•ä½“ç³»</strong>ï¼šæ¸…æ™°çš„æ™‹å‡è·¯å¾„å’ŒåŸ¹è®­è®¡åˆ’<br>
                2. <strong>ä¼˜åŒ–ç»©æ•ˆç®¡ç†</strong>ï¼šæ›´åŠ å…¬å¹³é€æ˜çš„è€ƒæ ¸æœºåˆ¶<br>
                3. <strong>æå‡è–ªé…¬ç«äº‰åŠ›</strong>ï¼šå®šæœŸå¸‚åœºè–ªé…¬è°ƒç ”<br>
                4. <strong>æ¨å¹¿ä¼˜ç§€ç»éªŒ</strong>ï¼šå°†TapTapå’Œè‡ªç ”éƒ¨çš„æˆåŠŸåšæ³•å¤åˆ¶<br><br>
                <strong>ğŸš€ é•¿æœŸæ–‡åŒ–å»ºè®¾ï¼ˆ12ä¸ªæœˆä»¥ä¸Šï¼‰ï¼š</strong><br>
                1. <strong>æ·±åŒ–ä¼ä¸šæ–‡åŒ–</strong>ï¼šè®©ä»·å€¼è§‚çœŸæ­£è½åœ°<br>
                2. <strong>å»ºç«‹åˆ›æ–°æœºåˆ¶</strong>ï¼šé¼“åŠ±å‘˜å·¥æå‡ºæ”¹è¿›å»ºè®®<br>
                3. <strong>å®Œå–„ç¦åˆ©ä½“ç³»</strong>ï¼šå…¨æ–¹ä½å…³çˆ±å‘˜å·¥ç”Ÿæ´»<br>
                4. <strong>å»ºç«‹äººæ‰æ¢¯é˜Ÿ</strong>ï¼šå†…éƒ¨åŸ¹å…»å’Œå¤–éƒ¨å¼•è¿›å¹¶é‡<br><br>
                <strong>ğŸ“Š æ•ˆæœè·Ÿè¸ªæœºåˆ¶ï¼š</strong><br>
                â€¢ å­£åº¦æ•¬ä¸šåº¦å¿«é€Ÿè°ƒç ”<br>
                â€¢ æœˆåº¦éƒ¨é—¨æŒ‡æ ‡ç›‘æ§<br>
                â€¢ å¹´åº¦æ·±åº¦åˆ†ææŠ¥å‘Š`;
            }
            
            if (msg.includes('éƒ¨é—¨') || msg.includes('taptap') || msg.includes('è‡ªç ”') || msg.includes('è¿è¥') || msg.includes('åŸåŒ—')) {
                return `<strong>ğŸ¢ å„éƒ¨é—¨è¡¨ç°å¯¹æ¯”åˆ†æ</strong><br><br>
                <strong>ğŸ¥‡ ç¬¬ä¸€æ¢¯é˜Ÿï¼ˆæ•¬ä¸šåº¦â‰¥70%ï¼‰ï¼š</strong><br>
                â€¢ <strong>è‡ªç ”éƒ¨</strong>ï¼š75% æ•¬ä¸šåº¦ï¼Œ78% æ»¡æ„åº¦ï¼ˆ120äººï¼‰<br>
                â€¢ <strong>TapTap</strong>ï¼š72% æ•¬ä¸šåº¦ï¼Œ70% æ»¡æ„åº¦ï¼ˆ89äººï¼‰<br><br>
                <strong>ğŸ¥ˆ ç¬¬äºŒæ¢¯é˜Ÿï¼ˆæ•¬ä¸šåº¦60-70%ï¼‰ï¼š</strong><br>
                â€¢ <strong>è¿è¥éƒ¨</strong>ï¼š65% æ•¬ä¸šåº¦ï¼Œ68% æ»¡æ„åº¦ï¼ˆ95äººï¼‰<br>
                â€¢ <strong>åŸåŒ—å¤§ç‹å¯¨å·¥ä½œå®¤</strong>ï¼š60% æ•¬ä¸šåº¦ï¼Œ61% æ»¡æ„åº¦ï¼ˆ172äººï¼‰<br><br>
                <strong>âš ï¸ é‡ç‚¹å…³æ³¨ï¼ˆæ•¬ä¸šåº¦<60%ï¼‰ï¼š</strong><br>
                â€¢ <strong>è´¢åŠ¡éƒ¨</strong>ï¼š40% æ•¬ä¸šåº¦ï¼Œ40% æ»¡æ„åº¦ï¼ˆ10äººï¼‰<br><br>
                <strong>ğŸ’¡ éƒ¨é—¨ç‰¹è‰²åˆ†æï¼š</strong><br>
                1. <strong>æŠ€æœ¯ç±»éƒ¨é—¨</strong>ï¼ˆè‡ªç ”ã€TapTapï¼‰è¡¨ç°ä¼˜å¼‚ï¼Œåˆ›æ–°æ°›å›´æµ“åš<br>
                2. <strong>ä¸šåŠ¡ç±»éƒ¨é—¨</strong>ï¼ˆè¿è¥ï¼‰ä¸­ç­‰æ°´å¹³ï¼Œéœ€è¦æ›´å¤šæ¿€åŠ±<br>
                3. <strong>èŒèƒ½ç±»éƒ¨é—¨</strong>ï¼ˆè´¢åŠ¡ï¼‰äºŸéœ€æ”¹è¿›ï¼Œå·¥ä½œæ»¡æ„åº¦åä½<br>
                4. <strong>å·¥ä½œå®¤å½¢å¼</strong>ï¼ˆåŸåŒ—å¤§ç‹å¯¨ï¼‰æœ‰ç‰¹è‰²ä½†è¿˜æœ‰æå‡ç©ºé—´<br><br>
                å»ºè®®é‡ç‚¹å­¦ä¹ è‡ªç ”éƒ¨çš„ç®¡ç†ç»éªŒï¼Œå¹¶é’ˆå¯¹è´¢åŠ¡éƒ¨åˆ¶å®šä¸“é¡¹æ”¹è¿›è®¡åˆ’ã€‚`;
            }
            
            if (msg.includes('è±¡é™') || msg.includes('åˆ†ç±»') || msg.includes('ç±»å‹') || msg.includes('é«˜æ•ˆ') || msg.includes('å—æŒ«')) {
                return `<strong>ğŸ“Š å‘˜å·¥è±¡é™åˆ†æè¯¦è§£</strong><br><br>
                æ ¹æ®æ•¬ä¸šåº¦å’Œæ»¡æ„åº¦ç»´åº¦ï¼Œå‘˜å·¥å¯åˆ†ä¸ºå››ç±»ï¼š<br><br>
                <strong>ğŸŸ¢ é«˜æ•ˆå‘˜å·¥ï¼ˆæ•¬ä¸šä¸”æ»¡æ„ï¼‰- 46%</strong><br>
                â€¢ ç‰¹å¾ï¼šå·¥ä½œç§¯æä¸»åŠ¨ï¼Œå¯¹å…¬å¸é«˜åº¦è®¤åŒ<br>
                â€¢ ç®¡ç†ç­–ç•¥ï¼šæŒç»­æ¿€åŠ±ï¼Œå§”ä»¥é‡ä»»ï¼Œä½œä¸ºæ¦œæ ·<br>
                â€¢ é£é™©ï¼šé¿å…è¿‡åº¦ä¾èµ–ï¼Œæ³¨æ„å·¥ä½œè´Ÿè·å¹³è¡¡<br><br>
                <strong>ğŸŸ¡ å—æŒ«å‘˜å·¥ï¼ˆæ•¬ä¸šä¸æ»¡æ„ï¼‰- çº¦22%</strong><br>
                â€¢ ç‰¹å¾ï¼šå·¥ä½œåŠªåŠ›ä½†å¯¹ç°çŠ¶ä¸æ»¡<br>
                â€¢ ç®¡ç†ç­–ç•¥ï¼šé‡ç‚¹å…³æ³¨ï¼Œæ”¹å–„å·¥ä½œæ¡ä»¶å’Œå¾…é‡<br>
                â€¢ æœºä¼šï¼šæœ€å®¹æ˜“è½¬åŒ–ä¸ºé«˜æ•ˆå‘˜å·¥çš„ç¾¤ä½“<br><br>
                <strong>ğŸ”µ æ¼ ç„¶å‘˜å·¥ï¼ˆä¸æ•¬ä¸šä½†æ»¡æ„ï¼‰- çº¦20%</strong><br>
                â€¢ ç‰¹å¾ï¼šå¯¹å·¥ä½œç¼ºä¹æ¿€æƒ…ä½†å®‰äºç°çŠ¶<br>
                â€¢ ç®¡ç†ç­–ç•¥ï¼šæ¿€å‘å·¥ä½œçƒ­æƒ…ï¼Œæä¾›æŒ‘æˆ˜æ€§ä»»åŠ¡<br>
                â€¢ é£é™©ï¼šå®¹æ˜“æˆä¸ºå›¢é˜Ÿ"æ¸©æ°´ç…®é’è›™"<br><br>
                <strong>ğŸ”´ ä½æ•ˆå‘˜å·¥ï¼ˆä¸æ•¬ä¸šä¸æ»¡æ„ï¼‰- çº¦12%</strong><br>
                â€¢ ç‰¹å¾ï¼šå·¥ä½œæ¶ˆæï¼Œå¯¹å…¬å¸ä¸æ»¡<br>
                â€¢ ç®¡ç†ç­–ç•¥ï¼šæ·±å…¥äº†è§£åŸå› ï¼Œè€ƒè™‘å²—ä½è°ƒæ•´<br>
                â€¢ å…³æ³¨ï¼šå¯èƒ½å­˜åœ¨ç¦»èŒé£é™©<br><br>
                <strong>ğŸ¯ ç®¡ç†é‡ç‚¹ï¼š</strong><br>
                1. ç»´æŠ¤å¥½46%çš„é«˜æ•ˆå‘˜å·¥<br>
                2. é‡ç‚¹è½¬åŒ–22%çš„å—æŒ«å‘˜å·¥<br>
                3. æ¿€å‘20%æ¼ ç„¶å‘˜å·¥çš„å·¥ä½œçƒ­æƒ…<br>
                4. æ·±åº¦åˆ†æ12%ä½æ•ˆå‘˜å·¥çš„é—®é¢˜æ ¹æº`;
            }
            
            // é»˜è®¤æ™ºèƒ½å›å¤
            const responses = [
                `<strong>ğŸ¤– æ™ºèƒ½åˆ†æç»“æœ</strong><br><br>åŸºäºæ‚¨çš„é—®é¢˜ï¼Œæˆ‘ä¸ºæ‚¨æä¾›ä»¥ä¸‹ä¸“ä¸šè§è§£ï¼š<br><br>ä»æ•´ä½“æ•°æ®æ¥çœ‹ï¼Œå¿ƒåŠ¨ç½‘ç»œ2024å¹´å‘˜å·¥æ•¬ä¸šåº¦è°ƒç ”å‘ˆç°ç§¯ææ€åŠ¿ã€‚68%çš„æ•¬ä¸šåº¦å’Œæ»¡æ„åº¦ç›¸è¾ƒå»å¹´60%å®ç°äº†æ˜¾è‘—æå‡ï¼Œè¿™è¡¨æ˜å…¬å¸åœ¨å‘˜å·¥å…³æ€€å’Œä¼ä¸šæ–‡åŒ–å»ºè®¾æ–¹é¢çš„åŠªåŠ›å–å¾—äº†å®æ•ˆã€‚<br><br><strong>ğŸ“ˆ å…³é”®äº®ç‚¹ï¼š</strong><br>â€¢ æŠ€æœ¯éƒ¨é—¨ï¼ˆè‡ªç ”ã€TapTapï¼‰è¡¨ç°çªå‡º<br>â€¢ ç®¡ç†å±‚ä¸å‘˜å·¥æ•¬ä¸šåº¦å·®å¼‚å€¼å¾—å…³æ³¨<br>â€¢ é«˜æ•ˆå‘˜å·¥æ¯”ä¾‹è¾¾åˆ°46%ï¼Œå…·å¤‡è‰¯å¥½åŸºç¡€<br><br>å¦‚éœ€äº†è§£ç‰¹å®šéƒ¨é—¨è¡¨ç°æˆ–è·å–è¯¦ç»†å»ºè®®ï¼Œè¯·å‘Šè¯‰æˆ‘æ‚¨å…³æ³¨çš„å…·ä½“æ–¹é¢ã€‚`,
                
                `<strong>ğŸ’¡ ä¸“ä¸šå»ºè®®åé¦ˆ</strong><br><br>æ„Ÿè°¢æ‚¨çš„æé—®ï¼æ ¹æ®å½“å‰æ•¬ä¸šåº¦æ•°æ®åˆ†æï¼š<br><br><strong>ä¼˜åŠ¿é¢†åŸŸï¼š</strong><br>â€¢ æ•´ä½“å‘ä¸Šè¶‹åŠ¿æ˜æ˜¾ï¼ˆåŒæ¯”+8%ï¼‰<br>â€¢ æŠ€æœ¯åˆ›æ–°éƒ¨é—¨è¡¨ç°ä¼˜å¼‚<br>â€¢ å‘˜å·¥å‚ä¸åº¦è¾ƒé«˜ï¼ˆ64.5%ï¼‰<br><br><strong>æ”¹è¿›ç©ºé—´ï¼š</strong><br>â€¢ èŒèƒ½éƒ¨é—¨éœ€è¦é‡ç‚¹å…³æ³¨<br>â€¢ ç®¡ç†å±‚ä¸åŸºå±‚å‘˜å·¥å·®å¼‚éœ€è¦ç¼©å°<br>â€¢ ä¸åŒèŒçº§é—´çš„æ»¡æ„åº¦å·®å¼‚<br><br>æˆ‘å¯ä»¥ä¸ºæ‚¨æ·±å…¥åˆ†æä»»ä½•ç‰¹å®šç»´åº¦çš„æ•°æ®ï¼Œæˆ–æä¾›é’ˆå¯¹æ€§çš„æ”¹è¿›å»ºè®®ã€‚è¯·å‘Šè¯‰æˆ‘æ‚¨æœ€å…³å¿ƒçš„é—®é¢˜ï¼`,
                
                `<strong>ğŸ“‹ æ•°æ®è§£è¯»ä¸å»ºè®®</strong><br><br>åŸºäºæ‚¨çš„è¯¢é—®ï¼Œæˆ‘å‘ç°ä»¥ä¸‹å‡ ä¸ªå€¼å¾—å…³æ³¨çš„å…³é”®ç‚¹ï¼š<br><br><strong>1. éƒ¨é—¨é—´å·®å¼‚æ˜¾è‘—</strong><br>è‡ªç ”éƒ¨75%æ•¬ä¸šåº¦ vs è´¢åŠ¡éƒ¨40%æ•¬ä¸šåº¦ï¼Œå·®è·é«˜è¾¾35ä¸ªç™¾åˆ†ç‚¹<br><br><strong>2. ç®¡ç†å±‚æ•ˆåº”æ˜æ˜¾</strong><br>ç®¡ç†å²—ä½å„é¡¹æŒ‡æ ‡å‡æ˜¾è‘—é«˜äºéç®¡ç†å²—ä½<br><br><strong>3. æ•´ä½“è¶‹åŠ¿ç§¯æ</strong><br>è¿ç»­åŒæ¯”å¢é•¿æ˜¾ç¤ºæ”¹é©æªæ–½æœ‰æ•ˆ<br><br><strong>å»ºè®®æ‚¨é‡ç‚¹å…³æ³¨ï¼š</strong><br>â€¢ å­¦ä¹ å€Ÿé‰´ä¼˜ç§€éƒ¨é—¨ç»éªŒ<br>â€¢ å»ºç«‹è·¨éƒ¨é—¨äº¤æµæœºåˆ¶<br>â€¢ å®Œå–„éç®¡ç†å²—ä½å‘å±•é€šé“<br><br>éœ€è¦æˆ‘é’ˆå¯¹å“ªä¸ªå…·ä½“æ–¹é¢è¿›è¡Œæ·±åº¦åˆ†æï¼Ÿ`
            ];
            
            return responses[Math.floor(Math.random() * responses.length)];
        }
        
        function handleFileUpload(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, {type: 'array'});
                    
                    // å¤„ç†Excelæ•°æ®
                    const sheetName = workbook.SheetNames[0];
                    const worksheet = workbook.Sheets[sheetName];
                    const jsonData = XLSX.utils.sheet_to_json(worksheet);
                    
                    console.log('å¯¼å…¥çš„æ•°æ®:', jsonData);
                    alert('æ•°æ®å¯¼å…¥æˆåŠŸï¼ä»ªè¡¨ç›˜å°†ä½¿ç”¨æ–°æ•°æ®è¿›è¡Œåˆ†æã€‚');
                    
                } catch (error) {
                    console.error('æ–‡ä»¶è§£æé”™è¯¯:', error);
                    alert('æ–‡ä»¶æ ¼å¼é”™è¯¯ï¼Œè¯·ç¡®ä¿ä¸Šä¼ çš„æ˜¯Excelæ–‡ä»¶ã€‚');
                }
            };
            reader.readAsArrayBuffer(file);
        }
    </script>
</body>
</html> 