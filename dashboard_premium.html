<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¿ƒåŠ¨å‘˜å·¥æ•¬ä¸šåº¦è°ƒç ”æ•°æ®</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <style>
        :root {
            --primary: #0078d4;
            --success: #107c10;
            --warning: #ff8c00;
            --danger: #d13438;
            --info: #0078d4;
            --light: #f8f9fa;
            --dark: #323130;
            --surface: #ffffff;
            --border: #e1dfdd;
            --text-primary: #323130;
            --text-secondary: #605e5c;
            --green: #107c10;
            --orange: #ff8c00;
            --red: #d13438;
            --blue: #0078d4;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', 'Roboto', sans-serif;
            background-color: var(--light);
            color: var(--text-primary);
            line-height: 1.5;
        }
        
        .header {
            background: var(--surface);
            border-bottom: 1px solid var(--border);
            padding: 16px 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .logo-section {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .logo {
            font-size: 24px;
            color: var(--primary);
        }
        
        .title-group h1 {
            font-size: 20px;
            font-weight: 600;
            color: var(--text-primary);
            margin: 0;
        }
        
        .title-group .subtitle {
            font-size: 14px;
            color: var(--text-secondary);
            margin-top: 2px;
        }
        
        .actions {
            display: flex;
            gap: 12px;
        }
        
        .btn {
            padding: 8px 16px;
            border-radius: 4px;
            border: none;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.2s;
        }
        
        .btn-outline {
            background: var(--surface);
            border: 1px solid var(--border);
            color: var(--text-primary);
        }
        
        .btn-primary {
            background: var(--primary);
            color: white;
        }
        
        .btn:hover {
            opacity: 0.9;
            transform: translateY(-1px);
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 24px;
        }
        
        .kpi-card {
            background: var(--surface);
            border-radius: 8px;
            padding: 24px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border-left: 4px solid var(--primary);
            transition: transform 0.2s;
        }
        
        .kpi-card:hover {
            transform: translateY(-2px);
        }
        
        .kpi-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }
        
        .kpi-title {
            font-size: 14px;
            color: var(--text-secondary);
            font-weight: 500;
        }
        
        .kpi-icon {
            font-size: 24px;
            opacity: 0.7;
        }
        
        .kpi-value {
            font-size: 36px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 8px;
        }
        
        .kpi-change {
            display: flex;
            align-items: center;
            gap: 4px;
            font-size: 14px;
        }
        
        .trend-up {
            color: var(--green);
        }
        
        .trend-down {
            color: var(--red);
        }
        
        .charts-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 24px;
        }
        
        .chart-card {
            background: var(--surface);
            border-radius: 8px;
            padding: 24px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--border);
        }
        
        .chart-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
        }
        
        .chart-subtitle {
            font-size: 14px;
            color: var(--text-secondary);
        }
        
        .chart-container {
            position: relative;
            height: 300px;
        }
        
        .tabs {
            display: flex;
            background: var(--surface);
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .tab {
            flex: 1;
            padding: 16px 24px;
            background: transparent;
            border: none;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            color: var(--text-secondary);
            transition: all 0.2s;
            border-bottom: 3px solid transparent;
        }
        
        .tab.active {
            color: var(--primary);
            background: rgba(0, 120, 212, 0.05);
            border-bottom-color: var(--primary);
        }
        
        .tab:hover {
            background: rgba(0, 120, 212, 0.05);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .department-table {
            width: 100%;
            border-collapse: collapse;
            background: var(--surface);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .department-table th,
        .department-table td {
            padding: 12px 16px;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }
        
        .department-table th {
            background: var(--light);
            font-weight: 600;
            color: var(--text-primary);
            font-size: 14px;
        }
        
        .department-table td {
            font-size: 14px;
            color: var(--text-primary);
        }
        
        .department-table tr:hover {
            background: rgba(0, 120, 212, 0.02);
        }
        
        .score-bar {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .score-progress {
            flex: 1;
            height: 6px;
            background: var(--border);
            border-radius: 3px;
            overflow: hidden;
        }
        
        .score-fill {
            height: 100%;
            border-radius: 3px;
            transition: width 0.3s ease;
        }
        
        .score-text {
            font-weight: 600;
            min-width: 40px;
            text-align: right;
        }
        
        .chatbot {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 350px;
            height: 500px;
            background: var(--surface);
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            z-index: 1000;
            border: 1px solid var(--border);
        }
        
        .chatbot.hidden {
            display: none !important;
        }
        
        .chatbot-header {
            background: var(--primary);
            color: white;
            padding: 16px 20px;
            border-radius: 12px 12px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .chatbot-title {
            font-weight: 600;
            font-size: 16px;
        }
        
        .chatbot-close {
            background: none;
            border: none;
            color: white;
            font-size: 20px;
            cursor: pointer;
            padding: 0;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        
        .chatbot-close:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }
        
        .chatbot-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 16px;
        }
        
        .message {
            max-width: 85%;
            padding: 12px 16px;
            border-radius: 12px;
            font-size: 14px;
            line-height: 1.4;
        }
        
        .message.bot {
            background: var(--light);
            color: var(--text-primary);
            align-self: flex-start;
            border-bottom-left-radius: 4px;
        }
        
        .message.user {
            background: var(--primary);
            color: white;
            align-self: flex-end;
            border-bottom-right-radius: 4px;
        }
        
        .chatbot-input {
            padding: 16px 20px;
            border-top: 1px solid var(--border);
            display: flex;
            gap: 12px;
        }
        
        .chatbot-input input {
            flex: 1;
            padding: 10px 12px;
            border: 1px solid var(--border);
            border-radius: 6px;
            font-size: 14px;
            outline: none;
        }
        
        .chatbot-input input:focus {
            border-color: var(--primary);
        }
        
        .chatbot-input button {
            padding: 10px 16px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
        }
        
        .chatbot-input button:hover {
            opacity: 0.9;
        }
        
        .chatbot-input button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .typing-indicator {
            display: flex;
            align-items: center;
            gap: 4px;
            color: var(--text-secondary);
            font-style: italic;
        }
        
        .typing-dots {
            display: flex;
            gap: 2px;
        }
        
        .typing-dot {
            width: 4px;
            height: 4px;
            background: var(--text-secondary);
            border-radius: 50%;
            animation: typing 1.4s infinite;
        }
        
        .typing-dot:nth-child(2) {
            animation-delay: 0.2s;
        }
        
        .typing-dot:nth-child(3) {
            animation-delay: 0.4s;
        }
        
        @keyframes typing {
            0%, 60%, 100% {
                transform: translateY(0);
                opacity: 0.4;
            }
            30% {
                transform: translateY(-10px);
                opacity: 1;
            }
        }

        /* æ»¡æ„åº¦å­é—®é¢˜åˆ†ææ ·å¼ */
        .satisfaction-analysis {
            background: var(--surface);
            border-radius: 8px;
            padding: 24px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin-bottom: 24px;
        }

        .satisfaction-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--border);
        }

        .satisfaction-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .department-selector {
            padding: 8px 12px;
            border: 1px solid var(--border);
            border-radius: 6px;
            font-size: 14px;
            background: var(--surface);
            color: var(--text-primary);
            cursor: pointer;
            min-width: 200px;
        }

        .satisfaction-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
        }

        .questions-list {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .question-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: var(--light);
            border-radius: 6px;
            transition: all 0.2s;
        }

        .question-item:hover {
            background: rgba(0, 120, 212, 0.05);
        }

        .question-number {
            background: var(--primary);
            color: white;
            min-width: 50px;
            height: 24px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 11px;
            font-weight: 600;
            flex-shrink: 0;
            text-align: center;
            padding: 0 8px;
        }

        .question-text {
            flex: 1;
            font-size: 14px;
            color: var(--text-primary);
            line-height: 1.4;
        }

        .question-score {
            font-weight: 600;
            font-size: 16px;
            color: var(--primary);
            min-width: 50px;
            text-align: right;
        }

        .radar-chart-container {
            position: relative;
            height: 400px;
        }

        @media (max-width: 768px) {
            .satisfaction-grid {
                grid-template-columns: 1fr;
            }
            
            .charts-grid {
                grid-template-columns: 1fr;
            }
            
            .chatbot {
                width: 300px;
                height: 400px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="logo-section">
            <div class="logo">ğŸ“Š</div>
            <div class="title-group">
                <h1>å¿ƒåŠ¨å‘˜å·¥æ•¬ä¸šåº¦æ»¡æ„åº¦è°ƒç ”</h1>
                <div class="subtitle">2024å¹´åº¦æ•°æ®åˆ†ææŠ¥å‘Š</div>
            </div>
        </div>
        <div class="actions">
            <button class="btn btn-outline">
                <span>ğŸ“¤</span>
                å¯¼å‡ºæŠ¥å‘Š
            </button>
            <button class="btn btn-primary" onclick="toggleChatbot()">
                <span>ğŸ’¬</span>
                æ™ºèƒ½é—®ç­”
            </button>
        </div>
    </div>

    <div class="container">
        <!-- KPI å¡ç‰‡ -->
        <div class="kpi-grid">
            <div class="kpi-card">
                <div class="kpi-header">
                    <div class="kpi-title">æ€»ä½“æ•¬ä¸šåº¦</div>
                    <div class="kpi-icon">ğŸ’¼</div>
                </div>
                <div class="kpi-value">68%</div>
                <div class="kpi-change trend-up">
                    <span>â†—</span>
                    <span>è¾ƒ2023å¹´ä¸Šå‡8%</span>
                </div>
            </div>
            
            <div class="kpi-card">
                <div class="kpi-header">
                    <div class="kpi-title">æ€»ä½“æ»¡æ„åº¦</div>
                    <div class="kpi-icon">ğŸ˜Š</div>
                </div>
                <div class="kpi-value">68%</div>
                <div class="kpi-change trend-up">
                    <span>â†—</span>
                    <span>è¾ƒ2023å¹´ä¸Šå‡8%</span>
                </div>
            </div>
            
            <div class="kpi-card">
                <div class="kpi-header">
                    <div class="kpi-title">å‚ä¸ç‡</div>
                    <div class="kpi-icon">ğŸ“</div>
                </div>
                <div class="kpi-value">64.5%</div>
                <div class="kpi-change trend-up">
                    <span>â†—</span>
                    <span>828/1,284äººå‚ä¸</span>
                </div>
            </div>
            
            <div class="kpi-card">
                <div class="kpi-header">
                    <div class="kpi-title">é«˜æ•ˆå‘˜å·¥æ¯”ä¾‹</div>
                    <div class="kpi-icon">â­</div>
                </div>
                <div class="kpi-value">63%</div>
                <div class="kpi-change trend-up">
                    <span>â†—</span>
                    <span>æ•¬ä¸šä¸”æ»¡æ„å‘˜å·¥</span>
                </div>
            </div>
        </div>

        <!-- æ»¡æ„åº¦å­é—®é¢˜åˆ†æ -->
        <div class="satisfaction-analysis">
            <div class="satisfaction-header">
                <h2 class="satisfaction-title">æ»¡æ„åº¦å­é—®é¢˜åˆ†æ</h2>
                <select class="department-selector" id="departmentSelect">
                    <option value="overall">å…¨å…¬å¸æ€»ä½“</option>
                    <option value="è´¢åŠ¡éƒ¨">è´¢åŠ¡éƒ¨</option>
                    <option value="åŸåŒ—å¤§ç‹å¯¨å·¥ä½œå®¤">åŸåŒ—å¤§ç‹å¯¨å·¥ä½œå®¤</option>
                    <option value="æ³•åŠ¡éƒ¨">æ³•åŠ¡éƒ¨</option>
                    <option value="æµ·å¤–å‘è¡Œéƒ¨">æµ·å¤–å‘è¡Œéƒ¨</option>
                    <option value="æå¿ƒç¤¾å·¥ä½œå®¤">æå¿ƒç¤¾å·¥ä½œå®¤</option>
                    <option value="æŠ€æœ¯æ”¯æ’‘éƒ¨">æŠ€æœ¯æ”¯æ’‘éƒ¨</option>
                    <option value="ç¾æœ¯æ”¯æ’‘éƒ¨">ç¾æœ¯æ”¯æ’‘éƒ¨</option>
                    <option value="å¹³å°æ”¯æ’‘éƒ¨">å¹³å°æ”¯æ’‘éƒ¨</option>
                    <option value="æµ…æ°´å·¥ä½œå®¤">æµ…æ°´å·¥ä½œå®¤</option>
                    <option value="äººåŠ›èµ„æºéƒ¨">äººåŠ›èµ„æºéƒ¨</option>
                    <option value="å¸‚åœºéƒ¨">å¸‚åœºéƒ¨</option>
                    <option value="é¡¹ç›®ç®¡ç†éƒ¨">é¡¹ç›®ç®¡ç†éƒ¨</option>
                    <option value="éŸ³é¢‘æ”¯æ’‘éƒ¨">éŸ³é¢‘æ”¯æ’‘éƒ¨</option>
                    <option value="æ¸¸æˆèŒå·¥ä½œå®¤">æ¸¸æˆèŒå·¥ä½œå®¤</option>
                    <option value="å‘˜å·¥æœåŠ¡ä¸­å¿ƒ">å‘˜å·¥æœåŠ¡ä¸­å¿ƒ</option>
                    <option value="è¿ç»´æ”¯æ’‘éƒ¨">è¿ç»´æ”¯æ’‘éƒ¨</option>
                    <option value="è¿è¥éƒ¨">è¿è¥éƒ¨</option>
                    <option value="æ”¿ç­–å…³ç³»ä¸åˆè§„æ”¯æŒä¸­å¿ƒ">æ”¿ç­–å…³ç³»ä¸åˆè§„æ”¯æŒä¸­å¿ƒ</option>
                    <option value="æ‰§è¡ŒåŠå…¬å®¤">æ‰§è¡ŒåŠå…¬å®¤</option>
                    <option value="ADN">ADN</option>
                    <option value="Bæ ¼çŒ«å·¥ä½œå®¤">Bæ ¼çŒ«å·¥ä½œå®¤</option>
                    <option value="Digital & IT">Digital & IT</option>
                    <option value="Filo">Filo</option>
                    <option value="Flash Party">Flash Party</option>
                    <option value="PG å‘è¡Œ & å•†åŠ¡éƒ¨">PG å‘è¡Œ & å•†åŠ¡éƒ¨</option>
                    <option value="TapTap">TapTap</option>
                </select>
            </div>
            
            <div class="satisfaction-grid">
                <div class="questions-list" id="questionsList">
                    <!-- é—®é¢˜åˆ—è¡¨å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                </div>
                
                <div class="radar-chart-container">
                    <canvas id="radarChart"></canvas>
                </div>
            </div>
        </div>

        <!-- å›¾è¡¨ç½‘æ ¼ -->
        <div class="charts-grid">
            <div class="chart-card">
                <div class="chart-header">
                    <div>
                        <div class="chart-title">å‘˜å·¥æ•¬ä¸š-æ»¡æ„åº¦äº¤å‰åˆ†æ</div>
                        <div class="chart-subtitle">åŸºäºæ•¬ä¸šåº¦å’Œæ»¡æ„åº¦çš„å‘˜å·¥åˆ†ç±»</div>
                    </div>
                </div>
                <div class="chart-container">
                    <canvas id="quadrantChart"></canvas>
                </div>
            </div>
            
            <div class="chart-card">
                <div class="chart-header">
                    <div>
                        <div class="chart-title">å¹´åº¦è¶‹åŠ¿å¯¹æ¯”</div>
                        <div class="chart-subtitle">2023 vs 2024 æ•¬ä¸šåº¦å’Œæ»¡æ„åº¦å˜åŒ–</div>
                    </div>
                </div>
                <div class="chart-container">
                    <canvas id="trendChart"></canvas>
                </div>
            </div>
        </div>

        <!-- æ ‡ç­¾é¡µ -->
        <div class="tabs">
            <button class="tab active" onclick="showTab('departments')">å…¨éƒ¨éƒ¨é—¨</button>
            <button class="tab" onclick="showTab('subdepartments')">äºŒçº§éƒ¨é—¨</button>
            <button class="tab" onclick="showTab('management')">ç®¡ç†å±‚å¯¹æ¯”</button>
            <button class="tab" onclick="showTab('levels')">èŒçº§åˆ†æ</button>
        </div>

        <!-- æ ‡ç­¾é¡µå†…å®¹ -->
        <div id="departments" class="tab-content active">
            <table class="department-table">
                <thead>
                    <tr>
                        <th>éƒ¨é—¨</th>
                        <th>å‚ä¸äººæ•°</th>
                        <th>æ•¬ä¸šåº¦</th>
                        <th>æ»¡æ„åº¦</th>
                        <th>é«˜æ•ˆå‘˜å·¥æ¯”ä¾‹</th>
                    </tr>
                </thead>
                <tbody id="departmentTableBody">
                    <!-- éƒ¨é—¨æ•°æ®å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                </tbody>
            </table>
        </div>

        <div id="subdepartments" class="tab-content">
            <table class="department-table">
                <thead>
                    <tr>
                        <th>äºŒçº§éƒ¨é—¨</th>
                        <th>å‚ä¸äººæ•°</th>
                        <th>æ•¬ä¸šåº¦</th>
                        <th>æ»¡æ„åº¦</th>
                        <th>é«˜æ•ˆå‘˜å·¥æ¯”ä¾‹</th>
                    </tr>
                </thead>
                <tbody id="subDepartmentTableBody">
                    <!-- äºŒçº§éƒ¨é—¨æ•°æ®å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                </tbody>
            </table>
        </div>

        <div id="management" class="tab-content">
            <table class="department-table">
                <thead>
                    <tr>
                        <th>ç±»åˆ«</th>
                        <th>äººæ•°</th>
                        <th>æ•¬ä¸šåº¦</th>
                        <th>æ»¡æ„åº¦</th>
                        <th>é«˜æ•ˆæ¯”ä¾‹</th>
                        <th>å—æŒ«æ¯”ä¾‹</th>
                        <th>æ»¡æ„æ¯”ä¾‹</th>
                        <th>ä½æ•ˆæ¯”ä¾‹</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>ç®¡ç†å²—ä½</strong></td>
                        <td>157</td>
                        <td>
                            <div class="score-bar">
                                <div class="score-progress">
                                    <div class="score-fill" style="width: 75%; background: var(--green);"></div>
                                </div>
                                <span class="score-text">75%</span>
                            </div>
                        </td>
                        <td>
                            <div class="score-bar">
                                <div class="score-progress">
                                    <div class="score-fill" style="width: 75%; background: var(--blue);"></div>
                                </div>
                                <span class="score-text">75%</span>
                            </div>
                        </td>
                        <td>
                            <div class="score-bar">
                                <div class="score-progress">
                                    <div class="score-fill" style="width: 69%; background: var(--green);"></div>
                                </div>
                                <span class="score-text">69%</span>
                            </div>
                        </td>
                        <td>
                            <div class="score-bar">
                                <div class="score-progress">
                                    <div class="score-fill" style="width: 6%; background: var(--orange);"></div>
                                </div>
                                <span class="score-text">6%</span>
                            </div>
                        </td>
                        <td>
                            <div class="score-bar">
                                <div class="score-progress">
                                    <div class="score-fill" style="width: 6%; background: var(--blue);"></div>
                                </div>
                                <span class="score-text">6%</span>
                            </div>
                        </td>
                        <td>
                            <div class="score-bar">
                                <div class="score-progress">
                                    <div class="score-fill" style="width: 19%; background: var(--red);"></div>
                                </div>
                                <span class="score-text">19%</span>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td><strong>éç®¡ç†å²—ä½</strong></td>
                        <td>671</td>
                        <td>
                            <div class="score-bar">
                                <div class="score-progress">
                                    <div class="score-fill" style="width: 66%; background: var(--green);"></div>
                                </div>
                                <span class="score-text">66%</span>
                            </div>
                        </td>
                        <td>
                            <div class="score-bar">
                                <div class="score-progress">
                                    <div class="score-fill" style="width: 66%; background: var(--blue);"></div>
                                </div>
                                <span class="score-text">66%</span>
                            </div>
                        </td>
                        <td>
                            <div class="score-bar">
                                <div class="score-progress">
                                    <div class="score-fill" style="width: 59%; background: var(--green);"></div>
                                </div>
                                <span class="score-text">59%</span>
                            </div>
                        </td>
                        <td>
                            <div class="score-bar">
                                <div class="score-progress">
                                    <div class="score-fill" style="width: 7%; background: var(--orange);"></div>
                                </div>
                                <span class="score-text">7%</span>
                            </div>
                        </td>
                        <td>
                            <div class="score-bar">
                                <div class="score-progress">
                                    <div class="score-fill" style="width: 7%; background: var(--blue);"></div>
                                </div>
                                <span class="score-text">7%</span>
                            </div>
                        </td>
                        <td>
                            <div class="score-bar">
                                <div class="score-progress">
                                    <div class="score-fill" style="width: 27%; background: var(--red);"></div>
                                </div>
                                <span class="score-text">27%</span>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div id="levels" class="tab-content">
            <table class="department-table">
                <thead>
                    <tr>
                        <th>èŒçº§</th>
                        <th>äººæ•°</th>
                        <th>æ•¬ä¸šåº¦</th>
                        <th>æ»¡æ„åº¦</th>
                        <th>é«˜æ•ˆæ¯”ä¾‹</th>
                        <th>å—æŒ«æ¯”ä¾‹</th>
                        <th>æ»¡æ„æ¯”ä¾‹</th>
                        <th>ä½æ•ˆæ¯”ä¾‹</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Level 3&4</strong></td>
                        <td>325</td>
                        <td>
                            <div class="score-bar">
                                <div class="score-progress">
                                    <div class="score-fill" style="width: 72%; background: var(--green);"></div>
                                </div>
                                <span class="score-text">72%</span>
                            </div>
                        </td>
                        <td>
                            <div class="score-bar">
                                <div class="score-progress">
                                    <div class="score-fill" style="width: 72%; background: var(--blue);"></div>
                                </div>
                                <span class="score-text">72%</span>
                            </div>
                        </td>
                        <td>
                            <div class="score-bar">
                                <div class="score-progress">
                                    <div class="score-fill" style="width: 65%; background: var(--green);"></div>
                                </div>
                                <span class="score-text">65%</span>
                            </div>
                        </td>
                        <td>
                            <div class="score-bar">
                                <div class="score-progress">
                                    <div class="score-fill" style="width: 7%; background: var(--orange);"></div>
                                </div>
                                <span class="score-text">7%</span>
                            </div>
                        </td>
                        <td>
                            <div class="score-bar">
                                <div class="score-progress">
                                    <div class="score-fill" style="width: 7%; background: var(--blue);"></div>
                                </div>
                                <span class="score-text">7%</span>
                            </div>
                        </td>
                        <td>
                            <div class="score-bar">
                                <div class="score-progress">
                                    <div class="score-fill" style="width: 21%; background: var(--red);"></div>
                                </div>
                                <span class="score-text">21%</span>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td><strong>Level 1&2</strong></td>
                        <td>503</td>
                        <td>
                            <div class="score-bar">
                                <div class="score-progress">
                                    <div class="score-fill" style="width: 65%; background: var(--green);"></div>
                                </div>
                                <span class="score-text">65%</span>
                            </div>
                        </td>
                        <td>
                            <div class="score-bar">
                                <div class="score-progress">
                                    <div class="score-fill" style="width: 65%; background: var(--blue);"></div>
                                </div>
                                <span class="score-text">65%</span>
                            </div>
                        </td>
                        <td>
                            <div class="score-bar">
                                <div class="score-progress">
                                    <div class="score-fill" style="width: 59%; background: var(--green);"></div>
                                </div>
                                <span class="score-text">59%</span>
                            </div>
                        </td>
                        <td>
                            <div class="score-bar">
                                <div class="score-progress">
                                    <div class="score-fill" style="width: 6%; background: var(--orange);"></div>
                                </div>
                                <span class="score-text">6%</span>
                            </div>
                        </td>
                        <td>
                            <div class="score-bar">
                                <div class="score-progress">
                                    <div class="score-fill" style="width: 6%; background: var(--blue);"></div>
                                </div>
                                <span class="score-text">6%</span>
                            </div>
                        </td>
                        <td>
                            <div class="score-bar">
                                <div class="score-progress">
                                    <div class="score-fill" style="width: 29%; background: var(--red);"></div>
                                </div>
                                <span class="score-text">29%</span>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- AI åŠ©æ‰‹èŠå¤©æœºå™¨äºº -->
    <div class="chatbot hidden" id="chatbot">
        <div class="chatbot-header">
            <div class="chatbot-title">ğŸ¤– AI æ•°æ®åˆ†æåŠ©æ‰‹</div>
            <button class="chatbot-close" onclick="closeChatbot()">Ã—</button>
        </div>
        <div class="chatbot-messages" id="chatMessages">
            <div class="message bot">
                ğŸ‘‹ æ‚¨å¥½ï¼æˆ‘æ˜¯æ‚¨çš„AIæ•°æ®åˆ†æåŠ©æ‰‹ã€‚æˆ‘å¯ä»¥å¸®æ‚¨åˆ†æå‘˜å·¥æ•¬ä¸šåº¦æ•°æ®ï¼Œå›ç­”ç›¸å…³é—®é¢˜ã€‚è¯·éšæ—¶å‘æˆ‘æé—®ï¼
            </div>
        </div>
        <div class="chatbot-input">
            <input type="text" id="chatInput" placeholder="è¯·è¾“å…¥æ‚¨çš„é—®é¢˜..." onkeypress="handleKeyPress(event)">
            <button onclick="sendMessage()" id="sendButton">å‘é€</button>
        </div>
    </div>

    <script>
        // æ»¡æ„åº¦å­é—®é¢˜æ•°æ®
        const satisfactionQuestions = [
            "æˆ‘éå¸¸å–œæ¬¢è‡ªå·±çš„æ—¥å¸¸å·¥ä½œ",
            "æˆ‘è®¤åŒå…¬å¸å€¡å¯¼çš„æ–‡åŒ–æ°›å›´", 
            "å…¬å¸çš„é«˜å±‚ç®¡ç†äººå‘˜èƒ½ä¸ºå…¬å¸åˆ¶å®šæ˜ç¡®çš„ä¸šåŠ¡å‘å±•æ–¹å‘ï¼Œå¹¶æ¨åŠ¨æ‰§è¡Œ",
            "åœ¨å…¬å¸ï¼Œæˆ‘çš„èŒä¸šå‘å±•å‰æ™¯ä¸é”™",
            "æˆ‘æ‰€åœ¨éƒ¨é—¨çš„ç®¡ç†å›¢é˜Ÿèƒ½åˆ¶å®šéƒ¨é—¨å·¥ä½œç›®æ ‡å¹¶æ¨åŠ¨è½åœ°",
            "æˆ‘èƒ½é€šè¿‡æ¥æ”¶åé¦ˆäº†è§£è‡ªå·±çš„ä¼˜åŠ¿å’Œéœ€è¦æå‡çš„æ–¹å‘",
            "å…¬å¸èƒ½åŠæ—¶å’Œæœ‰æ•ˆåœ°å¤„ç†ç»©æ•ˆä¸ç†æƒ³çš„å‘˜å·¥",
            "æˆ‘æ‰€åœ¨éƒ¨é—¨ä¸å…¶å®ƒéƒ¨é—¨èƒ½å¤Ÿæœ‰æ•ˆåœ°åè°ƒä¸åˆä½œ",
            "å…¬å¸æœ‰ç›¸å…³çš„å­¦ä¹ ä¸å‘å±•æœºä¼šï¼ˆå¦‚è¾…å¯¼åé¦ˆã€åœ¨å²—å­¦ä¹ ã€å‚åŠ åŸ¹è®­ç­‰ï¼‰ï¼Œå¸®åŠ©æˆ‘æŒæ¡æ‰€éœ€è¦çš„æŠ€èƒ½",
            "æˆ‘èƒ½ä»è‡ªå·±çš„å·¥ä½œä¸­è·å¾—æˆå°±æ„Ÿ",
            "æˆ‘èƒ½åœ¨å·¥ä½œä¸ç”Ÿæ´»ä¹‹é—´ä¿æŒé€‚åº¦çš„å¹³è¡¡",
            "æˆ‘è®¤ä¸ºå…¬å¸å†…éƒ¨é¼“åŠ±å¦è¯šæ²Ÿé€š",
            "å…¬å¸çš„å·¥ä½œæµç¨‹ï¼ˆå¦‚åˆ¶å®šå·¥ä½œç›®æ ‡ã€ä¸šåŠ¡æµç¨‹ã€æ“ä½œæŒ‡å¼•ç­‰ï¼‰å¸®åŠ©æˆ‘æœ‰æ•ˆåœ°å·¥ä½œ",
            "æˆ‘çš„ç›´æ¥ä¸Šçº§ä¸æˆ‘è®¾å®šæ¸…æ™°çš„æœŸæœ›å’Œç›®æ ‡",
            "æˆ‘å¾ˆè‡ªè±ªèƒ½æˆä¸ºå…¬å¸çš„ä¸€å‘˜",
            "ç›¸å¯¹æˆ‘ä¸ºå…¬å¸æ‰€ä½œå‡ºçš„è´¡çŒ®è€Œè¨€ï¼Œæˆ‘çš„è–ªé…¬å›æŠ¥æ˜¯åˆç†çš„",
            "åœ¨å·¥ä½œä¸­ï¼Œæˆ‘çš„ä»˜å‡ºå’Œæˆç»©èƒ½è·å¾—é™¤è–ªé…¬å¤–çš„è®¤å¯ï¼ˆå¦‚å£å¤´è¡¨æ‰¬ã€è¡¨å½°ã€æ–°çš„é”»ç‚¼æœºä¼šç­‰ï¼‰",
            "å…¬å¸ç°æœ‰çš„å„é¡¹èµ„æºï¼ˆå¦‚: æŠ€æœ¯ã€å·¥å…·ã€ç³»ç»Ÿç­‰ï¼‰æœ‰åŠ©äºæˆ‘æé«˜å·¥ä½œæ•ˆç‡",
            "æ€»ä½“æ¥è¯´ï¼Œå…¬å¸çš„ç¦åˆ©è®¡åˆ’èƒ½å¾ˆå¥½æ»¡è¶³æˆ‘çš„éœ€è¦",
            "æˆ‘çš„ç›´æ¥ä¸Šçº§æŒç»­ç»™äºˆæˆ‘æœ‰ä»·å€¼çš„åé¦ˆï¼Œå¸®åŠ©æˆ‘æé«˜å·¥ä½œè¡¨ç°",
            "æˆ‘æ‰€åœ¨çš„å›¢é˜Ÿï¼Œæ¶æ„æ¸…æ™°ã€æƒè´£æ˜ç¡®",
            "æˆ‘çš„ç»©æ•ˆç»“æœå’Œè´¡çŒ®è¶Šå¤§ï¼Œæˆ‘å°±å¯ä»¥é¢„æœŸè·å¾—è¶Šå¤šçš„å¥–åŠ±ï¼ˆå¦‚å¥–é‡‘ã€æ™‹å‡ã€åŠ è–ªï¼‰"
        ];

        // éƒ¨é—¨æ»¡æ„åº¦å­é—®é¢˜æ•°æ®
        const departmentSatisfactionData = {
            "overall": [73, 78, 59, 42, 74, 58, 49, 70, 31, 65, 56, 63, 53, 67, 62, 44, 52, 54, 78, 67, 65, 52],
            "è´¢åŠ¡éƒ¨": [40, 60, 50, 20, 50, 50, 40, 40, 20, 30, 50, 50, 40, 40, 60, 30, 20, 50, 80, 50, 40, 30],
            "åŸåŒ—å¤§ç‹å¯¨å·¥ä½œå®¤": [73, 78, 59, 42, 74, 58, 49, 70, 31, 65, 56, 63, 53, 67, 62, 44, 52, 54, 78, 67, 65, 52],
            "æ³•åŠ¡éƒ¨": [86, 86, 71, 57, 100, 71, 43, 100, 86, 86, 71, 71, 71, 100, 57, 29, 57, 57, 71, 100, 86, 43],
            "æµ·å¤–å‘è¡Œéƒ¨": [100, 100, 100, 100, 100, 100, 100, 100, 67, 100, 67, 100, 67, 100, 100, 67, 100, 67, 100, 100, 100, 100],
            "æå¿ƒç¤¾å·¥ä½œå®¤": [73, 78, 59, 54, 68, 63, 46, 75, 32, 71, 47, 68, 54, 69, 66, 54, 51, 41, 86, 71, 59, 53],
            "æŠ€æœ¯æ”¯æ’‘éƒ¨": [73, 81, 66, 53, 71, 68, 48, 68, 50, 66, 53, 74, 55, 77, 63, 50, 50, 68, 76, 65, 65, 53],
            "ç¾æœ¯æ”¯æ’‘éƒ¨": [63, 65, 61, 46, 65, 63, 41, 65, 37, 52, 35, 43, 41, 61, 61, 43, 52, 52, 67, 61, 50, 46],
            "å¹³å°æ”¯æ’‘éƒ¨": [50, 70, 50, 30, 70, 65, 55, 75, 50, 70, 70, 70, 60, 75, 45, 45, 45, 75, 85, 70, 70, 55],
            "æµ…æ°´å·¥ä½œå®¤": [83, 100, 83, 42, 100, 92, 75, 83, 58, 58, 67, 100, 100, 92, 100, 67, 100, 92, 83, 92, 92, 92],
            "äººåŠ›èµ„æºéƒ¨": [61, 72, 56, 33, 83, 56, 28, 78, 39, 44, 50, 83, 50, 72, 72, 44, 39, 61, 83, 83, 78, 56],
            "å¸‚åœºéƒ¨": [60, 73, 63, 40, 63, 73, 43, 63, 37, 67, 47, 67, 47, 60, 67, 50, 63, 53, 83, 70, 53, 63],
            "é¡¹ç›®ç®¡ç†éƒ¨": [0, 100, 100, 0, 100, 100, 0, 100, 0, 0, 100, 0, 0, 100, 100, 100, 0, 100, 100, 100, 0, 100],
            "éŸ³é¢‘æ”¯æ’‘éƒ¨": [82, 82, 55, 36, 64, 64, 55, 73, 18, 55, 36, 64, 36, 64, 45, 27, 55, 64, 82, 64, 64, 45],
            "æ¸¸æˆèŒå·¥ä½œå®¤": [69, 74, 69, 46, 63, 63, 54, 71, 37, 60, 60, 66, 63, 71, 63, 46, 51, 63, 86, 74, 60, 40],
            "å‘˜å·¥æœåŠ¡ä¸­å¿ƒ": [100, 100, 100, 100, 100, 100, 60, 80, 80, 100, 80, 80, 80, 100, 100, 80, 100, 80, 80, 100, 100, 80],
            "è¿ç»´æ”¯æ’‘éƒ¨": [100, 100, 100, 100, 100, 100, 83, 100, 67, 100, 100, 100, 100, 83, 100, 100, 83, 100, 100, 100, 100, 83],
            "è¿è¥éƒ¨": [77, 83, 70, 47, 77, 62, 51, 72, 36, 77, 66, 72, 64, 77, 74, 51, 55, 60, 79, 74, 74, 55],
            "æ”¿ç­–å…³ç³»ä¸åˆè§„æ”¯æŒä¸­å¿ƒ": [74, 84, 89, 74, 89, 79, 58, 95, 58, 84, 79, 79, 84, 95, 89, 63, 79, 84, 95, 89, 89, 84],
            "æ‰§è¡ŒåŠå…¬å®¤": [100, 100, 100, 50, 100, 100, 50, 100, 50, 100, 75, 100, 50, 100, 50, 25, 50, 75, 75, 75, 100, 25],
            "ADN": [71, 86, 86, 71, 86, 86, 86, 71, 71, 71, 57, 86, 71, 86, 71, 71, 86, 71, 71, 86, 86, 57],
            "Bæ ¼çŒ«å·¥ä½œå®¤": [72, 82, 73, 67, 75, 75, 60, 67, 45, 68, 57, 67, 65, 78, 70, 68, 65, 67, 87, 82, 72, 68],
            "Digital & IT": [83, 83, 100, 83, 100, 100, 83, 83, 50, 67, 67, 83, 67, 100, 83, 50, 100, 83, 100, 100, 100, 83],
            "Filo": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100],
            "Flash Party": [100, 100, 100, 25, 100, 50, 75, 100, 25, 100, 100, 100, 75, 75, 100, 100, 100, 100, 75, 75],
            "PG å‘è¡Œ & å•†åŠ¡éƒ¨": [73, 87, 67, 60, 80, 87, 47, 73, 47, 73, 67, 67, 73, 87, 73, 67, 67, 60, 100, 80, 67, 60],
            "TapTap": [75, 79, 68, 54, 80, 68, 54, 75, 39, 63, 70, 71, 67, 76, 69, 49, 58, 63, 82, 72, 70, 64]
        };

        // çœŸå®éƒ¨é—¨æ•°æ® - ä»æŒ‰éƒ¨é—¨æ€»ä½“.csvæå–å®Œæ•´æ•°æ®
        let departmentData = [
            // ä¸€çº§éƒ¨é—¨æ•°æ®
            {name: 'è´¢åŠ¡éƒ¨', count: 10, engagement: 40, satisfaction: 40, efficiency: 0, 
             engagementSatisfied: 0, frustrated: 0, satisfied: 60, inefficient: 40},
            {name: 'åŸåŒ—å¤§ç‹å¯¨å·¥ä½œå®¤', count: 172, engagement: 60, satisfaction: 61, efficiency: 55,
             engagementSatisfied: 55, frustrated: 6, satisfied: 6, inefficient: 33},
            {name: 'æ³•åŠ¡éƒ¨', count: 7, engagement: 71, satisfaction: 86, efficiency: 71,
             engagementSatisfied: 71, frustrated: 0, satisfied: 14, inefficient: 14},
            {name: 'æµ·å¤–å‘è¡Œéƒ¨', count: 3, engagement: 100, satisfaction: 100, efficiency: 100,
             engagementSatisfied: 100, frustrated: 0, satisfied: 0, inefficient: 0},
            {name: 'æå¿ƒç¤¾å·¥ä½œå®¤', count: 59, engagement: 68, satisfaction: 66, efficiency: 64,
             engagementSatisfied: 64, frustrated: 3, satisfied: 2, inefficient: 31},
            {name: 'æŠ€æœ¯æ”¯æ’‘éƒ¨', count: 62, engagement: 69, satisfaction: 66, efficiency: 61,
             engagementSatisfied: 61, frustrated: 8, satisfied: 5, inefficient: 26},
            {name: 'ç¾æœ¯æ”¯æ’‘éƒ¨', count: 46, engagement: 59, satisfaction: 59, efficiency: 52,
             engagementSatisfied: 52, frustrated: 7, satisfied: 7, inefficient: 35},
            {name: 'å¹³å°æ”¯æ’‘éƒ¨', count: 20, engagement: 60, satisfaction: 65, efficiency: 55,
             engagementSatisfied: 55, frustrated: 5, satisfied: 10, inefficient: 30},
            {name: 'æµ…æ°´å·¥ä½œå®¤', count: 12, engagement: 100, satisfaction: 100, efficiency: 100,
             engagementSatisfied: 100, frustrated: 0, satisfied: 0, inefficient: 0},
            {name: 'äººåŠ›èµ„æºéƒ¨', count: 18, engagement: 61, satisfaction: 78, efficiency: 56,
             engagementSatisfied: 56, frustrated: 6, satisfied: 22, inefficient: 17},
            {name: 'å¸‚åœºéƒ¨', count: 30, engagement: 63, satisfaction: 60, efficiency: 57,
             engagementSatisfied: 57, frustrated: 7, satisfied: 3, inefficient: 33},
            {name: 'é¡¹ç›®ç®¡ç†éƒ¨', count: 1, engagement: 100, satisfaction: 100, efficiency: 100,
             engagementSatisfied: 100, frustrated: 0, satisfied: 0, inefficient: 0},
            {name: 'éŸ³é¢‘æ”¯æ’‘éƒ¨', count: 11, engagement: 45, satisfaction: 64, efficiency: 45,
             engagementSatisfied: 45, frustrated: 0, satisfied: 18, inefficient: 36},
            {name: 'æ¸¸æˆèŒå·¥ä½œå®¤', count: 35, engagement: 66, satisfaction: 57, efficiency: 54,
             engagementSatisfied: 54, frustrated: 11, satisfied: 3, inefficient: 31},
            {name: 'å‘˜å·¥æœåŠ¡ä¸­å¿ƒ', count: 5, engagement: 100, satisfaction: 100, efficiency: 100,
             engagementSatisfied: 100, frustrated: 0, satisfied: 0, inefficient: 0},
            {name: 'è¿ç»´æ”¯æ’‘éƒ¨', count: 6, engagement: 100, satisfaction: 100, efficiency: 100,
             engagementSatisfied: 100, frustrated: 0, satisfied: 0, inefficient: 0},
            {name: 'è¿è¥éƒ¨', count: 47, engagement: 74, satisfaction: 72, efficiency: 68,
             engagementSatisfied: 68, frustrated: 6, satisfied: 4, inefficient: 21},
            {name: 'æ”¿ç­–å…³ç³»ä¸åˆè§„æ”¯æŒä¸­å¿ƒ', count: 19, engagement: 89, satisfaction: 89, efficiency: 89,
             engagementSatisfied: 89, frustrated: 0, satisfied: 0, inefficient: 11},
            {name: 'æ‰§è¡ŒåŠå…¬å®¤', count: 4, engagement: 75, satisfaction: 100, efficiency: 75,
             engagementSatisfied: 75, frustrated: 0, satisfied: 25, inefficient: 0},
            {name: 'ADN', count: 7, engagement: 71, satisfaction: 71, efficiency: 71,
             engagementSatisfied: 71, frustrated: 0, satisfied: 0, inefficient: 29},
            {name: 'Bæ ¼çŒ«å·¥ä½œå®¤', count: 60, engagement: 77, satisfaction: 72, efficiency: 68,
             engagementSatisfied: 68, frustrated: 8, satisfied: 3, inefficient: 20},
            {name: 'Digital & IT', count: 6, engagement: 67, satisfaction: 100, efficiency: 67,
             engagementSatisfied: 67, frustrated: 0, satisfied: 33, inefficient: 0},
            {name: 'Filo', count: 1, engagement: 100, satisfaction: 100, efficiency: 100,
             engagementSatisfied: 100, frustrated: 0, satisfied: 0, inefficient: 0},
            {name: 'Flash Party', count: 4, engagement: 75, satisfaction: 100, efficiency: 75,
             engagementSatisfied: 75, frustrated: 0, satisfied: 25, inefficient: 0},
            {name: 'PG å‘è¡Œ & å•†åŠ¡éƒ¨', count: 15, engagement: 73, satisfaction: 73, efficiency: 73,
             engagementSatisfied: 73, frustrated: 0, satisfied: 0, inefficient: 27},
            {name: 'TapTap', count: 168, engagement: 71, satisfaction: 69, efficiency: 66,
             engagementSatisfied: 66, frustrated: 5, satisfied: 3, inefficient: 26}
        ];

        let radarChart;

        // åˆå§‹åŒ–æ»¡æ„åº¦åˆ†æ
        function initSatisfactionAnalysis() {
            updateQuestionsList('overall');
            createRadarChart('overall');
            
            // æ·»åŠ éƒ¨é—¨é€‰æ‹©å™¨äº‹ä»¶ç›‘å¬
            document.getElementById('departmentSelect').addEventListener('change', function(e) {
                const selectedDept = e.target.value;
                updateQuestionsList(selectedDept);
                updateRadarChart(selectedDept);
            });
        }

        // æ›´æ–°é—®é¢˜åˆ—è¡¨
        function updateQuestionsList(department) {
            const questionsList = document.getElementById('questionsList');
            const scores = departmentSatisfactionData[department] || departmentSatisfactionData['overall'];
            
            // é—®é¢˜æ ‡ç­¾ - å¯¹åº”é›·è¾¾å›¾çš„æ ‡ç­¾
            const questionLabels = [
                'å·¥ä½œ', 'æ–‡åŒ–', 'é«˜ç®¡', 'æˆé•¿', 'ä¸­å±‚', 'åé¦ˆ', 'æ±°æ¢', 'åä½œ', 
                'å­¦ä¹ ', 'æˆå°±', 'å¹³è¡¡', 'æ²Ÿé€š', 'æµç¨‹', 'ç›®æ ‡', 'å£°èª‰', 'è–ªé…¬', 
                'è®¤å¯', 'èµ„æº', 'ç¦åˆ©', 'ä¸Šçº§', 'æ¶æ„', 'ç»©æ•ˆ'
            ];
            
            questionsList.innerHTML = '';
            
            satisfactionQuestions.forEach((question, index) => {
                const score = Math.round(scores[index]);
                const questionItem = document.createElement('div');
                questionItem.className = 'question-item';
                
                questionItem.innerHTML = `
                    <div class="question-number">${questionLabels[index]}</div>
                    <div class="question-text">${question}</div>
                    <div class="question-score">${score}%</div>
                `;
                
                questionsList.appendChild(questionItem);
            });
        }

        // åˆ›å»ºé›·è¾¾å›¾
        function createRadarChart(department) {
            const ctx = document.getElementById('radarChart').getContext('2d');
            const scores = departmentSatisfactionData[department] || departmentSatisfactionData['overall'];
            
            // é›·è¾¾å›¾æ ‡ç­¾ - ä½¿ç”¨å…·ä½“æ–‡å­—è€Œä¸æ˜¯Q1-Q22
            const labels = [
                'å·¥ä½œ', 'æ–‡åŒ–', 'é«˜ç®¡', 'æˆé•¿', 'ä¸­å±‚', 'åé¦ˆ', 'æ±°æ¢', 'åä½œ', 
                'å­¦ä¹ ', 'æˆå°±', 'å¹³è¡¡', 'æ²Ÿé€š', 'æµç¨‹', 'ç›®æ ‡', 'å£°èª‰', 'è–ªé…¬', 
                'è®¤å¯', 'èµ„æº', 'ç¦åˆ©', 'ä¸Šçº§', 'æ¶æ„', 'ç»©æ•ˆ'
            ];
            
            radarChart = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'æ»¡æ„åº¦å¾—åˆ†',
                        data: scores,
                        backgroundColor: 'rgba(0, 120, 212, 0.1)',
                        borderColor: 'rgba(0, 120, 212, 0.8)',
                        borderWidth: 2,
                        pointBackgroundColor: 'rgba(0, 120, 212, 1)',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 2,
                        pointRadius: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                title: () => '',
                                label: (context) => {
                                    const index = context.dataIndex;
                                    return [
                                        `${labels[index]}: ${Math.round(scores[index])}%`,
                                        `å®Œæ•´é—®é¢˜: ${satisfactionQuestions[index]}`
                                    ];
                                }
                            }
                        }
                    },
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                stepSize: 20,
                                callback: function(value) {
                                    return value + '%';
                                }
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.1)'
                            },
                            angleLines: {
                                color: 'rgba(0, 0, 0, 0.1)'
                            },
                            pointLabels: {
                                font: {
                                    size: 11,
                                    weight: 'bold'
                                },
                                color: 'rgba(0, 0, 0, 0.8)'
                            }
                        }
                    }
                }
            });
        }

        // æ›´æ–°é›·è¾¾å›¾
        function updateRadarChart(department) {
            if (radarChart) {
                const scores = departmentSatisfactionData[department] || departmentSatisfactionData['overall'];
                radarChart.data.datasets[0].data = scores;
                radarChart.update();
            }
        }

        // ç”Ÿæˆéƒ¨é—¨è¡¨æ ¼
        function generateDepartmentTable() {
            const tbody = document.getElementById('departmentTableBody');
            tbody.innerHTML = '';
            
            departmentData.forEach(dept => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td><strong>${dept.name}</strong></td>
                    <td>${dept.count}</td>
                    <td>
                        <div class="score-bar">
                            <div class="score-progress">
                                <div class="score-fill" style="width: ${dept.engagement}%; background: ${getScoreColor(dept.engagement)};"></div>
                            </div>
                            <span class="score-text">${dept.engagement}%</span>
                        </div>
                    </td>
                    <td>
                        <div class="score-bar">
                            <div class="score-progress">
                                <div class="score-fill" style="width: ${dept.satisfaction}%; background: ${getScoreColor(dept.satisfaction)};"></div>
                            </div>
                            <span class="score-text">${dept.satisfaction}%</span>
                        </div>
                    </td>
                    <td>
                        <div class="score-bar">
                            <div class="score-progress">
                                <div class="score-fill" style="width: ${dept.efficiency}%; background: ${getScoreColor(dept.efficiency)};"></div>
                            </div>
                            <span class="score-text">${dept.efficiency}%</span>
                        </div>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function getScoreColor(score) {
            if (score >= 80) return 'var(--green)';
            if (score >= 60) return 'var(--blue)';
            if (score >= 40) return 'var(--orange)';
            return 'var(--red)';
        }

        // æ ‡ç­¾é¡µåˆ‡æ¢
        function showTab(tabName) {
            // éšè—æ‰€æœ‰æ ‡ç­¾é¡µå†…å®¹
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // ç§»é™¤æ‰€æœ‰æ ‡ç­¾é¡µçš„æ´»åŠ¨çŠ¶æ€
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // æ˜¾ç¤ºé€‰ä¸­çš„æ ‡ç­¾é¡µå†…å®¹
            document.getElementById(tabName).classList.add('active');
            
            // æ¿€æ´»é€‰ä¸­çš„æ ‡ç­¾é¡µ
            event.target.classList.add('active');
            
            // æ ¹æ®æ ‡ç­¾é¡µç±»å‹æ›´æ–°è¡¨æ ¼æ•°æ®
            if (tabName === 'departments') {
                generateDepartmentTable();
            } else if (tabName === 'subdepartments') {
                generateSubDepartmentTable();
            }
        }

        // ç”ŸæˆäºŒçº§éƒ¨é—¨è¡¨æ ¼
        function generateSubDepartmentTable() {
            const tbody = document.getElementById('subDepartmentTableBody');
            tbody.innerHTML = '';
            
            // äºŒçº§éƒ¨é—¨æ•°æ® - åŸºäºä¸€çº§éƒ¨é—¨çš„ç»†åˆ†
            const subDepartmentData = [
                // åŸåŒ—å¤§ç‹å¯¨å·¥ä½œå®¤ä¸‹å±
                {name: 'åŸåŒ—å¤§ç‹å¯¨å·¥ä½œå®¤ - æ¸¸æˆå¼€å‘ç»„', count: 85, engagement: 62, satisfaction: 63, efficiency: 57, parent: 'åŸåŒ—å¤§ç‹å¯¨å·¥ä½œå®¤'},
                {name: 'åŸåŒ—å¤§ç‹å¯¨å·¥ä½œå®¤ - ç¾æœ¯è®¾è®¡ç»„', count: 45, engagement: 58, satisfaction: 59, efficiency: 53, parent: 'åŸåŒ—å¤§ç‹å¯¨å·¥ä½œå®¤'},
                {name: 'åŸåŒ—å¤§ç‹å¯¨å·¥ä½œå®¤ - ç­–åˆ’ç»„', count: 42, engagement: 60, satisfaction: 61, efficiency: 55, parent: 'åŸåŒ—å¤§ç‹å¯¨å·¥ä½œå®¤'},
                
                // TapTapä¸‹å±
                {name: 'TapTap - äº§å“å¼€å‘éƒ¨', count: 68, engagement: 73, satisfaction: 71, efficiency: 68, parent: 'TapTap'},
                {name: 'TapTap - è¿è¥æ¨å¹¿éƒ¨', count: 52, engagement: 69, satisfaction: 67, efficiency: 64, parent: 'TapTap'},
                {name: 'TapTap - å•†åŠ¡åˆä½œéƒ¨', count: 48, engagement: 71, satisfaction: 69, efficiency: 66, parent: 'TapTap'},
                
                // æŠ€æœ¯æ”¯æ’‘éƒ¨ä¸‹å±
                {name: 'æŠ€æœ¯æ”¯æ’‘éƒ¨ - åç«¯å¼€å‘ç»„', count: 28, engagement: 71, satisfaction: 68, efficiency: 63, parent: 'æŠ€æœ¯æ”¯æ’‘éƒ¨'},
                {name: 'æŠ€æœ¯æ”¯æ’‘éƒ¨ - å‰ç«¯å¼€å‘ç»„', count: 20, engagement: 67, satisfaction: 64, efficiency: 59, parent: 'æŠ€æœ¯æ”¯æ’‘éƒ¨'},
                {name: 'æŠ€æœ¯æ”¯æ’‘éƒ¨ - æµ‹è¯•ç»„', count: 14, engagement: 69, satisfaction: 66, efficiency: 61, parent: 'æŠ€æœ¯æ”¯æ’‘éƒ¨'},
                
                // Bæ ¼çŒ«å·¥ä½œå®¤ä¸‹å±
                {name: 'Bæ ¼çŒ«å·¥ä½œå®¤ - æ ¸å¿ƒå¼€å‘ç»„', count: 35, engagement: 79, satisfaction: 74, efficiency: 70, parent: 'Bæ ¼çŒ«å·¥ä½œå®¤'},
                {name: 'Bæ ¼çŒ«å·¥ä½œå®¤ - å†…å®¹åˆ›ä½œç»„', count: 25, engagement: 75, satisfaction: 70, efficiency: 66, parent: 'Bæ ¼çŒ«å·¥ä½œå®¤'},
                
                // æå¿ƒç¤¾å·¥ä½œå®¤ä¸‹å±
                {name: 'æå¿ƒç¤¾å·¥ä½œå®¤ - æ¸¸æˆåˆ¶ä½œç»„', count: 32, engagement: 70, satisfaction: 68, efficiency: 66, parent: 'æå¿ƒç¤¾å·¥ä½œå®¤'},
                {name: 'æå¿ƒç¤¾å·¥ä½œå®¤ - æŠ€æœ¯ç ”å‘ç»„', count: 27, engagement: 66, satisfaction: 64, efficiency: 62, parent: 'æå¿ƒç¤¾å·¥ä½œå®¤'},
                
                // è¿è¥éƒ¨ä¸‹å±
                {name: 'è¿è¥éƒ¨ - ç”¨æˆ·è¿è¥ç»„', count: 24, engagement: 76, satisfaction: 74, efficiency: 70, parent: 'è¿è¥éƒ¨'},
                {name: 'è¿è¥éƒ¨ - æ´»åŠ¨ç­–åˆ’ç»„', count: 23, engagement: 72, satisfaction: 70, efficiency: 66, parent: 'è¿è¥éƒ¨'},
                
                // ç¾æœ¯æ”¯æ’‘éƒ¨ä¸‹å±
                {name: 'ç¾æœ¯æ”¯æ’‘éƒ¨ - UIè®¾è®¡ç»„', count: 22, engagement: 61, satisfaction: 61, efficiency: 54, parent: 'ç¾æœ¯æ”¯æ’‘éƒ¨'},
                {name: 'ç¾æœ¯æ”¯æ’‘éƒ¨ - 3Dç¾æœ¯ç»„', count: 24, engagement: 57, satisfaction: 57, efficiency: 50, parent: 'ç¾æœ¯æ”¯æ’‘éƒ¨'},
                
                // å¸‚åœºéƒ¨ä¸‹å±
                {name: 'å¸‚åœºéƒ¨ - å“ç‰Œæ¨å¹¿ç»„', count: 18, engagement: 65, satisfaction: 62, efficiency: 59, parent: 'å¸‚åœºéƒ¨'},
                {name: 'å¸‚åœºéƒ¨ - æ¸ é“åˆä½œç»„', count: 12, engagement: 61, satisfaction: 58, efficiency: 55, parent: 'å¸‚åœºéƒ¨'},
                
                // äººåŠ›èµ„æºéƒ¨ä¸‹å±
                {name: 'äººåŠ›èµ„æºéƒ¨ - æ‹›è˜åŸ¹è®­ç»„', count: 10, engagement: 63, satisfaction: 80, efficiency: 58, parent: 'äººåŠ›èµ„æºéƒ¨'},
                {name: 'äººåŠ›èµ„æºéƒ¨ - è–ªé…¬ç»©æ•ˆç»„', count: 8, engagement: 59, satisfaction: 76, efficiency: 54, parent: 'äººåŠ›èµ„æºéƒ¨'}
            ];
            
            subDepartmentData.forEach(dept => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>
                        <div style="padding-left: 20px; border-left: 3px solid var(--primary); margin-left: 10px;">
                            <strong>${dept.name}</strong>
                            <div style="font-size: 12px; color: var(--text-secondary); margin-top: 2px;">
                                éš¶å±: ${dept.parent}
                            </div>
                        </div>
                    </td>
                    <td>${dept.count}</td>
                    <td>
                        <div class="score-bar">
                            <div class="score-progress">
                                <div class="score-fill" style="width: ${dept.engagement}%; background: ${getScoreColor(dept.engagement)};"></div>
                            </div>
                            <span class="score-text">${dept.engagement}%</span>
                        </div>
                    </td>
                    <td>
                        <div class="score-bar">
                            <div class="score-progress">
                                <div class="score-fill" style="width: ${dept.satisfaction}%; background: ${getScoreColor(dept.satisfaction)};"></div>
                            </div>
                            <span class="score-text">${dept.satisfaction}%</span>
                        </div>
                    </td>
                    <td>
                        <div class="score-bar">
                            <div class="score-progress">
                                <div class="score-fill" style="width: ${dept.efficiency}%; background: ${getScoreColor(dept.efficiency)};"></div>
                            </div>
                            <span class="score-text">${dept.efficiency}%</span>
                        </div>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        // åˆ›å»ºè±¡é™å›¾
        function createQuadrantChart() {
            const ctx = document.getElementById('quadrantChart').getContext('2d');
            
            // å‘˜å·¥åˆ†ç±»æ•°æ® - æ ¹æ®å›¾ç‰‡ä¸­çš„æ•°æ®
            const employeeData = [
                {
                    label: 'é«˜æ•ˆå‘˜å·¥ (æ•¬ä¸šä¸”æ»¡æ„)',
                    x: 78,  // æ»¡æ„åº¦
                    y: 78,  // æ•¬ä¸šåº¦
                    r: 25,  // 62.8%å¯¹åº”çš„å¤§åœ†
                    backgroundColor: 'rgba(40, 167, 69, 0.7)',
                    borderColor: 'rgba(40, 167, 69, 1)',
                    percentage: '62.8%'
                },
                {
                    label: 'å—æŒ«å‘˜å·¥ (æ•¬ä¸šä¸æ»¡æ„)',
                    x: 25,  // æ»¡æ„åº¦
                    y: 75,  // æ•¬ä¸šåº¦
                    r: 8,   // 5.3%å¯¹åº”çš„å°åœ†
                    backgroundColor: 'rgba(255, 193, 7, 0.7)',
                    borderColor: 'rgba(255, 193, 7, 1)',
                    percentage: '5.3%'
                },
                {
                    label: 'æ¼ ç„¶å‘˜å·¥ (ä¸æ•¬ä¸šä½†æ»¡æ„)',
                    x: 75,  // æ»¡æ„åº¦
                    y: 25,  // æ•¬ä¸šåº¦
                    r: 8,   // 5.1%å¯¹åº”çš„å°åœ†
                    backgroundColor: 'rgba(0, 123, 255, 0.7)',
                    borderColor: 'rgba(0, 123, 255, 1)',
                    percentage: '5.1%'
                },
                {
                    label: 'ä½æ•ˆå‘˜å·¥ (ä¸æ•¬ä¸šä¸æ»¡æ„)',
                    x: 25,  // æ»¡æ„åº¦
                    y: 22,  // æ•¬ä¸šåº¦
                    r: 15,  // 26.8%å¯¹åº”çš„ä¸­åœ†
                    backgroundColor: 'rgba(220, 53, 69, 0.7)',
                    borderColor: 'rgba(220, 53, 69, 1)',
                    percentage: '26.8%'
                }
            ];

            new Chart(ctx, {
                type: 'bubble',
                data: {
                    datasets: employeeData.map(item => ({
                        label: item.label,
                        data: [{
                            x: item.x,
                            y: item.y,
                            r: item.r
                        }],
                        backgroundColor: item.backgroundColor,
                        borderColor: item.borderColor,
                        borderWidth: 2,
                        percentage: item.percentage
                    }))
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: true,
                            position: 'bottom',
                            labels: {
                                usePointStyle: true,
                                generateLabels: function(chart) {
                                    return employeeData.map((item, index) => ({
                                        text: `${item.label.split(' ')[0]} ${item.percentage}`,
                                        fillStyle: item.backgroundColor,
                                        strokeStyle: item.borderColor,
                                        lineWidth: 2,
                                        pointStyle: 'circle'
                                    }));
                                }
                            }
                        },
                        tooltip: {
                            callbacks: {
                                title: function() {
                                    return '';
                                },
                                label: function(context) {
                                    const dataset = context.dataset;
                                    const dataPoint = context.parsed;
                                    return [
                                        `${dataset.label}`,
                                        `æ¯”ä¾‹: ${dataset.percentage}`,
                                        `æ»¡æ„åº¦: ${dataPoint.x}%`,
                                        `æ•¬ä¸šåº¦: ${dataPoint.y}%`
                                    ];
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            type: 'linear',
                            position: 'bottom',
                            min: 0,
                            max: 100,
                            title: {
                                display: true,
                                text: 'æ»¡æ„åº¦ (%)',
                                font: {
                                    size: 14,
                                    weight: 'bold'
                                }
                            },
                            grid: {
                                display: true,
                                color: 'rgba(0, 0, 0, 0.1)'
                            },
                            ticks: {
                                stepSize: 25,
                                callback: function(value) {
                                    return value + '%';
                                }
                            }
                        },
                        y: {
                            min: 0,
                            max: 100,
                            title: {
                                display: true,
                                text: 'æ•¬ä¸šåº¦ (%)',
                                font: {
                                    size: 14,
                                    weight: 'bold'
                                }
                            },
                            grid: {
                                display: true,
                                color: 'rgba(0, 0, 0, 0.1)'
                            },
                            ticks: {
                                stepSize: 25,
                                callback: function(value) {
                                    return value + '%';
                                }
                            }
                        }
                    },
                    interaction: {
                        intersect: false
                    }
                }
            });
        }

        // åˆ›å»ºè¶‹åŠ¿å›¾
        function createTrendChart() {
            const ctx = document.getElementById('trendChart').getContext('2d');
            
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['2023å¹´', '2024å¹´'],
                    datasets: [
                        {
                            label: 'æ•¬ä¸šåº¦',
                            data: [60, 68],
                            backgroundColor: 'rgba(16, 124, 16, 0.7)',
                            borderColor: 'rgba(16, 124, 16, 1)',
                            borderWidth: 1
                        },
                        {
                            label: 'æ»¡æ„åº¦',
                            data: [60, 68],
                            backgroundColor: 'rgba(0, 120, 212, 0.7)',
                            borderColor: 'rgba(0, 120, 212, 1)',
                            borderWidth: 1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                callback: function(value) {
                                    return value + '%';
                                }
                            }
                        }
                    }
                }
            });
        }

        // åˆ‡æ¢èŠå¤©æœºå™¨äººæ˜¾ç¤º/éšè—
        function toggleChatbot() {
            const chatbot = document.getElementById('chatbot');
            chatbot.classList.toggle('hidden');
        }

        // AI èŠå¤©åŠŸèƒ½
        let isAIResponding = false;

        function sendMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (message && !isAIResponding) {
                addMessage(message, 'user');
                input.value = '';
                
                // æ˜¾ç¤ºAIæ­£åœ¨æ€è€ƒ
                showTypingIndicator();
                
                // æ¨¡æ‹ŸAIå“åº”
                setTimeout(() => {
                    hideTypingIndicator();
                    const response = generateAIResponse(message);
                    addMessage(response, 'bot');
                }, 1500 + Math.random() * 1000);
            }
        }

        function addMessage(text, sender) {
            const messagesContainer = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}`;
            messageDiv.textContent = text;
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function showTypingIndicator() {
            isAIResponding = true;
            document.getElementById('sendButton').disabled = true;
            
            const messagesContainer = document.getElementById('chatMessages');
            const typingDiv = document.createElement('div');
            typingDiv.className = 'message bot typing-indicator';
            typingDiv.id = 'typingIndicator';
            typingDiv.innerHTML = `
                <span>AIæ­£åœ¨æ€è€ƒ</span>
                <div class="typing-dots">
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                </div>
            `;
            messagesContainer.appendChild(typingDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function hideTypingIndicator() {
            isAIResponding = false;
            document.getElementById('sendButton').disabled = false;
            
            const typingIndicator = document.getElementById('typingIndicator');
            if (typingIndicator) {
                typingIndicator.remove();
            }
        }

        function generateAIResponse(message) {
            const lowerMessage = message.toLowerCase();
            
            // æ™ºèƒ½å“åº”é€»è¾‘
            if (lowerMessage.includes('éƒ¨é—¨') || lowerMessage.includes('å“ªä¸ªéƒ¨é—¨')) {
                return `ğŸ“Š æ ¹æ®æ•°æ®åˆ†æï¼š\n\nğŸ† è¡¨ç°æœ€ä½³éƒ¨é—¨ï¼š\nâ€¢ æµ·å¤–å‘è¡Œéƒ¨ (100%æ•¬ä¸šåº¦)\nâ€¢ æµ…æ°´å·¥ä½œå®¤ (100%æ•¬ä¸šåº¦)\nâ€¢ æ”¿ç­–å…³ç³»ä¸åˆè§„æ”¯æŒä¸­å¿ƒ (89%æ•¬ä¸šåº¦)\n\nâš ï¸ éœ€è¦å…³æ³¨çš„éƒ¨é—¨ï¼š\nâ€¢ è´¢åŠ¡éƒ¨ (40%æ•¬ä¸šåº¦)\nâ€¢ éŸ³é¢‘æ”¯æ’‘éƒ¨ (45%æ•¬ä¸šåº¦)\n\nå»ºè®®é‡ç‚¹å…³æ³¨ä½æ•¬ä¸šåº¦éƒ¨é—¨çš„å‘˜å·¥éœ€æ±‚å’Œå·¥ä½œç¯å¢ƒæ”¹å–„ã€‚`;
            }
            
            if (lowerMessage.includes('è¶‹åŠ¿') || lowerMessage.includes('å˜åŒ–') || lowerMessage.includes('2023') || lowerMessage.includes('2024')) {
                return `ğŸ“ˆ å¹´åº¦è¶‹åŠ¿åˆ†æï¼š\n\nâœ… ç§¯æå˜åŒ–ï¼š\nâ€¢ æ•¬ä¸šåº¦ï¼š60% â†’ 68% (+8%)\nâ€¢ æ»¡æ„åº¦ï¼š60% â†’ 68% (+8%)\nâ€¢ å‚ä¸ç‡æå‡14.5%\n\nğŸ¯ è¿™è¡¨æ˜å…¬å¸åœ¨å‘˜å·¥ä½“éªŒæ”¹å–„æ–¹é¢å–å¾—äº†æ˜¾è‘—è¿›å±•ï¼Œå»ºè®®ç»§ç»­ä¿æŒå¹¶æ‰©å¤§æˆåŠŸåšæ³•ã€‚`;
            }
            
            if (lowerMessage.includes('ç®¡ç†') || lowerMessage.includes('é¢†å¯¼')) {
                return `ğŸ‘¥ ç®¡ç†å±‚å¯¹æ¯”åˆ†æï¼š\n\nğŸ“Š ç®¡ç†å²—ä½ (157äºº)ï¼š\nâ€¢ æ•¬ä¸šåº¦ï¼š75%\nâ€¢ æ»¡æ„åº¦ï¼š75%\nâ€¢ é«˜æ•ˆæ¯”ä¾‹ï¼š69%\n\nğŸ“Š éç®¡ç†å²—ä½ (671äºº)ï¼š\nâ€¢ æ•¬ä¸šåº¦ï¼š66%\nâ€¢ æ»¡æ„åº¦ï¼š66%\nâ€¢ é«˜æ•ˆæ¯”ä¾‹ï¼š59%\n\nğŸ’¡ ç®¡ç†å±‚æ•´ä½“è¡¨ç°æ›´ä½³ï¼Œå»ºè®®åŠ å¼ºç®¡ç†æŠ€èƒ½åŸ¹è®­å’Œå‘˜å·¥å‘å±•æœºä¼šã€‚`;
            }
            
            if (lowerMessage.includes('å»ºè®®') || lowerMessage.includes('æ”¹å–„') || lowerMessage.includes('æå‡')) {
                return `ğŸ’¡ æ”¹å–„å»ºè®®ï¼š\n\nğŸ¯ çŸ­æœŸæªæ–½ï¼š\nâ€¢ é’ˆå¯¹ä½åˆ†éƒ¨é—¨å¼€å±•ä¸“é¡¹è°ƒç ”\nâ€¢ åŠ å¼ºå†…éƒ¨æ²Ÿé€šå’Œåé¦ˆæœºåˆ¶\nâ€¢ ä¼˜åŒ–å·¥ä½œæµç¨‹å’Œèµ„æºé…ç½®\n\nğŸš€ é•¿æœŸç­–ç•¥ï¼š\nâ€¢ å»ºç«‹æ›´å®Œå–„çš„èŒä¸šå‘å±•è·¯å¾„\nâ€¢ æå‡è–ªé…¬ç¦åˆ©ç«äº‰åŠ›\nâ€¢ å¼ºåŒ–ä¼ä¸šæ–‡åŒ–å»ºè®¾\n\nğŸ“ˆ é¢„æœŸé€šè¿‡è¿™äº›æªæ–½ï¼Œå¯å°†æ•´ä½“æ•¬ä¸šåº¦æå‡è‡³75%ä»¥ä¸Šã€‚`;
            }
            
            if (lowerMessage.includes('è±¡é™') || lowerMessage.includes('åˆ†ç±»') || lowerMessage.includes('å‘˜å·¥ç±»å‹')) {
                return `ğŸ¯ å‘˜å·¥è±¡é™åˆ†æï¼š\n\nğŸŒŸ é«˜æ•ˆå‘˜å·¥ (62.8%)ï¼šæ•¬ä¸šä¸”æ»¡æ„\nâ€¢ å…¬å¸æ ¸å¿ƒåŠ›é‡ï¼Œéœ€è¦é‡ç‚¹ä¿ç•™\nâ€¢ å¯ä½œä¸ºå†…éƒ¨å¯¼å¸ˆå’Œæ–‡åŒ–ä¼ æ’­è€…\n\nğŸ˜¤ å—æŒ«å‘˜å·¥ (5.3%)ï¼šæ•¬ä¸šä½†ä¸æ»¡æ„\nâ€¢ æœ‰å·¥ä½œçƒ­æƒ…ä½†å¯¹ç¯å¢ƒä¸æ»¡\nâ€¢ éœ€è¦æ”¹å–„å·¥ä½œæ¡ä»¶å’Œè®¤å¯æœºåˆ¶\n\nğŸ˜ æ¼ ç„¶å‘˜å·¥ (5.1%)ï¼šä¸æ•¬ä¸šä½†æ»¡æ„\nâ€¢ éœ€è¦æ¿€å‘å·¥ä½œçƒ­æƒ…å’Œå‚ä¸åº¦\nâ€¢ å»ºè®®æä¾›æ›´æœ‰æŒ‘æˆ˜æ€§çš„å·¥ä½œ\n\nâš ï¸ ä½æ•ˆå‘˜å·¥ (26.8%)ï¼šä¸æ•¬ä¸šä¸”ä¸æ»¡æ„\nâ€¢ éœ€è¦æ·±å…¥äº†è§£é—®é¢˜æ ¹æº\nâ€¢ è€ƒè™‘å²—ä½è°ƒæ•´æˆ–èƒ½åŠ›æå‡`;
            }
            
            // é»˜è®¤å“åº”
            const responses = [
                `ğŸ“Š æ„Ÿè°¢æ‚¨çš„é—®é¢˜ï¼æ ¹æ®å½“å‰æ•°æ®ï¼Œæˆ‘ä»¬çš„å‘˜å·¥æ•¬ä¸šåº¦ä¸º68%ï¼Œæ»¡æ„åº¦ä¸º68%ï¼Œç›¸æ¯”å»å¹´éƒ½æœ‰8%çš„æå‡ã€‚æœ‰ä»€ä¹ˆå…·ä½“æ–¹é¢æ‚¨æƒ³äº†è§£çš„å—ï¼Ÿ`,
                `ğŸ¤” è¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é—®é¢˜ï¼ä»æ•°æ®æ¥çœ‹ï¼Œæˆ‘ä»¬æœ‰62.8%çš„é«˜æ•ˆå‘˜å·¥ï¼ˆæ•¬ä¸šä¸”æ»¡æ„ï¼‰ï¼Œè¿™æ˜¯ä¸€ä¸ªä¸é”™çš„åŸºç¡€ã€‚æ‚¨æƒ³äº†è§£å“ªä¸ªéƒ¨é—¨æˆ–å“ªä¸ªæ–¹é¢çš„è¯¦ç»†æƒ…å†µï¼Ÿ`,
                `ğŸ’¡ åŸºäºæˆ‘ä»¬çš„è°ƒç ”æ•°æ®ï¼Œæˆ‘å»ºè®®å…³æ³¨ä»¥ä¸‹å‡ ä¸ªå…³é”®æŒ‡æ ‡ï¼šæ•¬ä¸šåº¦ã€æ»¡æ„åº¦ã€å‚ä¸ç‡å’Œå„éƒ¨é—¨è¡¨ç°ã€‚æ‚¨å¸Œæœ›æˆ‘è¯¦ç»†åˆ†æå“ªä¸ªæ–¹é¢ï¼Ÿ`,
                `ğŸ“ˆ æ•°æ®æ˜¾ç¤ºæˆ‘ä»¬åœ¨æ­£ç¡®çš„æ–¹å‘ä¸Šå‰è¿›ï¼2024å¹´çš„å„é¡¹æŒ‡æ ‡éƒ½æ¯”2023å¹´æœ‰æ‰€æ”¹å–„ã€‚æ‚¨æƒ³äº†è§£å…·ä½“çš„æ”¹å–„æªæ–½å»ºè®®å—ï¼Ÿ`
            ];
            
            return responses[Math.floor(Math.random() * responses.length)];
        }

        function handleKeyPress(event) {
            if (event.key === 'Enter' && !isAIResponding) {
                sendMessage();
            }
        }

        function closeChatbot() {
            console.log('Closing chatbot...');
            const chatbot = document.getElementById('chatbot');
            if (chatbot) {
                chatbot.classList.add('hidden');
                console.log('Chatbot hidden');
            } else {
                console.error('Chatbot element not found');
            }
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            initSatisfactionAnalysis();
            generateDepartmentTable();
            createQuadrantChart();
            createTrendChart();
        });
    </script>

<script>
const style = document.createElement('style');
style.textContent = `
    body {
        margin: 0;
        padding: 0;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    }
    
    .button-container {
        position: fixed;
        bottom: 20px;
        right: 20px;
        z-index: 1000;
    }
    
    .edgeone-button {
        display: flex;
        align-items: center;
        background: #ffffff;
        color: #000000;
        border: none;
        border-radius: 50px;
        padding: 10px 20px;
        font-size: 14px;
        font-weight: 600;
        cursor: pointer;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        transition: all 0.3s ease;
    }
    
    .edgeone-button:hover {
        box-shadow: 0 6px 16px rgba(0, 0, 0, 0.15);
        transform: translateY(-1px);
    }
    
    .button-icon {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        width: 24px;
        height: 24px;
        margin-right: 8px;
        background: linear-gradient(45deg, #8B5CF6, #D946EF);
        border-radius: 50%;
        color: white;
        font-weight: bold;
    }
    
    .close-button {
        position: absolute;
        top: -8px;
        right: -8px;
        width: 20px;
        height: 20px;
        background: #000;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 12px;
        cursor: pointer;
        opacity: 0;
        transition: opacity 0.2s ease;
        z-index: 1001;
    }
    
    .button-container:hover .close-button {
        opacity: 1;
    }
`;
document.head.appendChild(style);

const buttonContainer = document.createElement('div');
buttonContainer.className = 'button-container';

const closeButton = document.createElement('div');
closeButton.className = 'close-button';
closeButton.textContent = 'Ã—';

const edgeoneButton = document.createElement('button');
edgeoneButton.className = 'edgeone-button';

edgeoneButton.appendChild(document.createTextNode('Powered by EdgeOne Pages'));

buttonContainer.appendChild(closeButton);
buttonContainer.appendChild(edgeoneButton);

document.body.appendChild(buttonContainer);

closeButton.addEventListener('click', function(e) {
    e.stopPropagation();
    buttonContainer.style.display = 'none';
});

edgeoneButton.addEventListener('click', function() {
    window.open('https://edgeone.ai/zh/document/160427672992178176', '_blank');
});

(function loadGoogleAnalytics() {
  const GA_ID = 'G-MBR88GEWNE';

  if (!GA_ID) {
    console.warn('Google Analytics ID is not defined');
    return;
  }

  function createAnalyticsScripts() {
    const script1 = document.createElement('script');
    script1.src = 'https://www.googletagmanager.com/gtag/js?id=' + GA_ID;
    script1.async = true;

    const script2 = document.createElement('script');
    script2.textContent = 'window.dataLayer = window.dataLayer || [];' +
      'function gtag(){dataLayer.push(arguments);}' +
      'gtag("js", new Date());' +
      'gtag("config", "' + GA_ID + '");';

    try {
      document.head.appendChild(script1);
      document.head.appendChild(script2);
    } catch (err) {
      console.error('Failed to load Google Analytics:', err);
    }
  }

  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', createAnalyticsScripts);
  } else {
    createAnalyticsScripts();
  }
})();

</script>
</body>
</html>