<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¿ƒåŠ¨å‘˜å·¥æ•¬ä¸šåº¦è°ƒç ”æ•°æ®</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
            background: #f5f7fa;
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.1);
        }
        
        .header h1 {
            font-size: 2.2rem;
            color: #2c3e50;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .header .subtitle {
            color: #7f8c8d;
            font-size: 1.1rem;
            margin-bottom: 20px;
        }
        
        .header .actions {
            display: flex;
            justify-content: center;
            gap: 15px;
        }
        
        .btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: background 0.3s;
        }
        
        .btn:hover {
            background: #2980b9;
        }
        
        .kpi-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .kpi-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.1);
            border-left: 4px solid #3498db;
            text-align: center;
        }
        
        .kpi-card .icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }
        
        .kpi-card .title {
            font-size: 0.9rem;
            color: #7f8c8d;
            margin-bottom: 8px;
        }
        
        .kpi-card .value {
            font-size: 2.2rem;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 8px;
        }
        
        .kpi-card .trend {
            font-size: 0.85rem;
            color: #27ae60;
            font-weight: 500;
        }
        
        .section {
            background: white;
            margin-bottom: 30px;
            border-radius: 12px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .section-header {
            padding: 20px 25px;
            border-bottom: 1px solid #ecf0f1;
            background: #fafbfc;
        }
        
        .section-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #2c3e50;
        }
        
        .section-content {
            padding: 25px;
        }
        
        .department-selector {
            margin-bottom: 20px;
        }
        
        .department-selector select {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 0.9rem;
            min-width: 200px;
        }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .metric-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #ecf0f1;
        }
        
        .metric-item:last-child {
            border-bottom: none;
        }
        
        .metric-label {
            font-size: 0.9rem;
            color: #2c3e50;
            flex: 1;
        }
        
        .metric-value {
            font-size: 1.1rem;
            font-weight: 600;
            color: #3498db;
            min-width: 50px;
            text-align: right;
        }
        
        .charts-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .chart-box {
            background: #fafbfc;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
        }
        
        .chart-title {
            font-size: 1rem;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 15px;
        }
        
        .tabs {
            display: flex;
            border-bottom: 1px solid #ecf0f1;
            margin-bottom: 20px;
        }
        
        .tab {
            padding: 12px 20px;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            font-weight: 500;
            color: #7f8c8d;
            transition: all 0.3s;
        }
        
        .tab.active {
            color: #3498db;
            border-bottom-color: #3498db;
        }
        
        .tab:hover {
            color: #3498db;
        }
        
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        .data-table th,
        .data-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #ecf0f1;
        }
        
        .data-table th {
            background: #fafbfc;
            font-weight: 600;
            color: #2c3e50;
            text-align: center;
        }
        
        .data-table td {
            text-align: center;
        }
        
        .data-table td:first-child {
            text-align: left;
            font-weight: 600;
        }
        
        .data-table tr:hover {
            background: #f8f9fa;
        }
        
        .progress-bar {
            width: 100%;
            height: 6px;
            background: #ecf0f1;
            border-radius: 3px;
            overflow: hidden;
            margin-top: 5px;
        }
        
        .progress-fill {
            height: 100%;
            background: #3498db;
            transition: width 0.3s ease;
        }
        
        .chatbot {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 350px;
            height: 500px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            display: none;
            flex-direction: column;
            z-index: 1000;
        }
        
        .chatbot.active {
            display: flex;
        }
        
        .chatbot-header {
            background: #3498db;
            color: white;
            padding: 15px 20px;
            border-radius: 12px 12px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .chatbot-close {
            background: none;
            border: none;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            padding: 5px;
            border-radius: 50%;
            width: 30px;
            height: 30px;
        }
        
        .chatbot-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }
        
        .message {
            margin-bottom: 15px;
            padding: 10px 15px;
            border-radius: 8px;
            max-width: 85%;
        }
        
        .message.bot {
            background: #f1f3f4;
            margin-right: auto;
        }
        
        .message.user {
            background: #3498db;
            color: white;
            margin-left: auto;
        }
        
        .chatbot-input {
            padding: 15px 20px;
            border-top: 1px solid #ecf0f1;
            display: flex;
            gap: 10px;
        }
        
        .chatbot-input input {
            flex: 1;
            border: 1px solid #ddd;
            border-radius: 20px;
            padding: 8px 15px;
            outline: none;
        }
        
        .chatbot-input button {
            background: #3498db;
            color: white;
            border: none;
            border-radius: 20px;
            padding: 8px 16px;
            cursor: pointer;
        }
        
        @media (max-width: 768px) {
            .charts-container {
                grid-template-columns: 1fr;
            }
            
            .kpi-section {
                grid-template-columns: 1fr;
            }
            
            .tabs {
                flex-wrap: wrap;
            }
            
            .chatbot {
                width: calc(100vw - 40px);
                height: calc(100vh - 100px);
            }
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="container">
        <!-- å¤´éƒ¨ -->
        <div class="header">
            <h1>ğŸ“Š å¿ƒåŠ¨ç½‘ç»œå‘˜å·¥æ•¬ä¸šåº¦è°ƒç ”</h1>
            <p class="subtitle">2024å¹´åº¦æ•°æ®åˆ†ææŠ¥å‘Š</p>
            <div class="actions">
                <button class="btn" onclick="exportReport()">ğŸ“¤ å¯¼å‡ºæŠ¥å‘Š</button>
                <button class="btn" onclick="toggleChatbot()">ğŸ’¬ æ™ºèƒ½é—®ç­”</button>
            </div>
        </div>

        <!-- KPI æŒ‡æ ‡ -->
        <div class="kpi-section">
            <div class="kpi-card">
                <div class="icon">ğŸ’¼</div>
                <div class="title">æ€»ä½“æ•¬ä¸šåº¦</div>
                <div class="value">68%</div>
                <div class="trend">â†— è¾ƒ2023å¹´ä¸Šå‡8%</div>
            </div>
            <div class="kpi-card">
                <div class="icon">ğŸ˜Š</div>
                <div class="title">æ€»ä½“æ»¡æ„åº¦</div>
                <div class="value">68%</div>
                <div class="trend">â†— è¾ƒ2023å¹´ä¸Šå‡8%</div>
            </div>
            <div class="kpi-card">
                <div class="icon">ğŸ“</div>
                <div class="title">å‚ä¸ç‡</div>
                <div class="value">64.5%</div>
                <div class="trend">â†— 828/1,284äººå‚ä¸</div>
            </div>
            <div class="kpi-card">
                <div class="icon">â­</div>
                <div class="title">é«˜æ•ˆå‘˜å·¥æ¯”ä¾‹</div>
                <div class="value">63%</div>
                <div class="trend">â†— æ•¬ä¸šä¸”æ»¡æ„å‘˜å·¥</div>
            </div>
        </div>

        <!-- æ»¡æ„åº¦å­é—®é¢˜åˆ†æ -->
        <div class="section">
            <div class="section-header">
                <h2 class="section-title">æ»¡æ„åº¦å­é—®é¢˜åˆ†æ</h2>
            </div>
            <div class="section-content">
                <div class="department-selector">
                    <select id="department-select" onchange="updateMetrics()">
                        <option value="overall">å…¨å…¬å¸æ€»ä½“</option>
                        <option value="è´¢åŠ¡éƒ¨">è´¢åŠ¡éƒ¨</option>
                        <option value="åŸåŒ—å¤§ç‹å¯¨å·¥ä½œå®¤">åŸåŒ—å¤§ç‹å¯¨å·¥ä½œå®¤</option>
                        <option value="æ³•åŠ¡éƒ¨">æ³•åŠ¡éƒ¨</option>
                        <option value="æµ·å¤–å‘è¡Œéƒ¨">æµ·å¤–å‘è¡Œéƒ¨</option>
                        <option value="æå¿ƒç¤¾å·¥ä½œå®¤">æå¿ƒç¤¾å·¥ä½œå®¤</option>
                        <option value="æŠ€æœ¯æ”¯æ’‘éƒ¨">æŠ€æœ¯æ”¯æ’‘éƒ¨</option>
                        <option value="ç¾æœ¯æ”¯æ’‘éƒ¨">ç¾æœ¯æ”¯æ’‘éƒ¨</option>
                        <option value="å¹³å°æ”¯æ’‘éƒ¨">å¹³å°æ”¯æ’‘éƒ¨</option>
                        <option value="æµ…æ°´å·¥ä½œå®¤">æµ…æ°´å·¥ä½œå®¤</option>
                        <option value="äººåŠ›èµ„æºéƒ¨">äººåŠ›èµ„æºéƒ¨</option>
                        <option value="å¸‚åœºéƒ¨">å¸‚åœºéƒ¨</option>
                        <option value="é¡¹ç›®ç®¡ç†éƒ¨">é¡¹ç›®ç®¡ç†éƒ¨</option>
                        <option value="éŸ³é¢‘æ”¯æ’‘éƒ¨">éŸ³é¢‘æ”¯æ’‘éƒ¨</option>
                        <option value="æ¸¸æˆèŒå·¥ä½œå®¤">æ¸¸æˆèŒå·¥ä½œå®¤</option>
                        <option value="å‘˜å·¥æœåŠ¡ä¸­å¿ƒ">å‘˜å·¥æœåŠ¡ä¸­å¿ƒ</option>
                        <option value="è¿ç»´æ”¯æ’‘éƒ¨">è¿ç»´æ”¯æ’‘éƒ¨</option>
                        <option value="è¿è¥éƒ¨">è¿è¥éƒ¨</option>
                        <option value="æ”¿ç­–å…³ç³»ä¸åˆè§„æ”¯æŒä¸­å¿ƒ">æ”¿ç­–å…³ç³»ä¸åˆè§„æ”¯æŒä¸­å¿ƒ</option>
                        <option value="æ‰§è¡ŒåŠå…¬å®¤">æ‰§è¡ŒåŠå…¬å®¤</option>
                        <option value="ADN">ADN</option>
                        <option value="Bæ ¼çŒ«å·¥ä½œå®¤">Bæ ¼çŒ«å·¥ä½œå®¤</option>
                        <option value="Digital & IT">Digital & IT</option>
                        <option value="Filo">Filo</option>
                        <option value="Flash Party">Flash Party</option>
                        <option value="PG å‘è¡Œ & å•†åŠ¡éƒ¨">PG å‘è¡Œ & å•†åŠ¡éƒ¨</option>
                        <option value="TapTap">TapTap</option>
                    </select>
                </div>
                
                <div class="metrics-grid" id="metrics-container">
                    <!-- æ»¡æ„åº¦æŒ‡æ ‡å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>
        </div>

        <!-- å›¾è¡¨åˆ†æ -->
        <div class="charts-container">
            <div class="chart-box">
                <div class="chart-title">å‘˜å·¥æ•¬ä¸š-æ»¡æ„åº¦äº¤å‰åˆ†æ</div>
                <p>åŸºäºæ•¬ä¸šåº¦å’Œæ»¡æ„åº¦çš„å‘˜å·¥åˆ†ç±»</p>
                <canvas id="quadrant-chart" width="400" height="300"></canvas>
            </div>
            <div class="chart-box">
                <div class="chart-title">å¹´åº¦è¶‹åŠ¿å¯¹æ¯”</div>
                <p>2023 vs 2024 æ•¬ä¸šåº¦å’Œæ»¡æ„åº¦å˜åŒ–</p>
                <canvas id="trend-chart" width="400" height="300"></canvas>
            </div>
        </div>

        <!-- éƒ¨é—¨æ•°æ®è¡¨æ ¼ -->
        <div class="section">
            <div class="section-content">
                <div class="tabs">
                    <div class="tab active" onclick="switchTab('all', this)">å…¨éƒ¨éƒ¨é—¨</div>
                    <div class="tab" onclick="switchTab('secondary', this)">äºŒçº§éƒ¨é—¨</div>
                    <div class="tab" onclick="switchTab('management', this)">ç®¡ç†å±‚å¯¹æ¯”</div>
                    <div class="tab" onclick="switchTab('position', this)">èŒçº§åˆ†æ</div>
                </div>
                
                <div id="table-container">
                    <!-- è¡¨æ ¼å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>
        </div>
    </div>

    <!-- èŠå¤©æœºå™¨äºº -->
    <div class="chatbot" id="chatbot">
        <div class="chatbot-header">
            <span>ğŸ¤– AI æ•°æ®åˆ†æåŠ©æ‰‹</span>
            <button class="chatbot-close" onclick="toggleChatbot()">Ã—</button>
        </div>
        <div class="chatbot-messages" id="chat-messages">
            <div class="message bot">
                ğŸ‘‹ æ‚¨å¥½ï¼æˆ‘æ˜¯æ‚¨çš„AIæ•°æ®åˆ†æåŠ©æ‰‹ã€‚æˆ‘å¯ä»¥å¸®æ‚¨åˆ†æå‘˜å·¥æ•¬ä¸šåº¦æ•°æ®ï¼Œå›ç­”ç›¸å…³é—®é¢˜ã€‚è¯·éšæ—¶å‘æˆ‘æé—®ï¼
            </div>
        </div>
        <div class="chatbot-input">
            <input type="text" id="chat-input" placeholder="è¯·è¾“å…¥æ‚¨çš„é—®é¢˜..." onkeypress="if(event.key==='Enter') sendMessage()">
            <button onclick="sendMessage()">å‘é€</button>
        </div>
    </div>

    <script>
        // æ»¡æ„åº¦å­é—®é¢˜æ•°æ®
        const satisfactionMetrics = {
            overall: {
                'å·¥ä½œ': { label: 'æˆ‘éå¸¸å–œæ¬¢è‡ªå·±çš„æ—¥å¸¸å·¥ä½œ', value: 73 },
                'æ–‡åŒ–': { label: 'æˆ‘è®¤åŒå…¬å¸å€¡å¯¼çš„æ–‡åŒ–æ°›å›´', value: 78 },
                'é«˜ç®¡': { label: 'å…¬å¸çš„é«˜å±‚ç®¡ç†äººå‘˜èƒ½ä¸ºå…¬å¸åˆ¶å®šæ˜ç¡®çš„ä¸šåŠ¡å‘å±•æ–¹å‘ï¼Œå¹¶æ¨åŠ¨æ‰§è¡Œ', value: 59 },
                'æˆé•¿': { label: 'åœ¨å…¬å¸ï¼Œæˆ‘çš„èŒä¸šå‘å±•å‰æ™¯ä¸é”™', value: 42 },
                'ä¸­å±‚': { label: 'æˆ‘æ‰€åœ¨éƒ¨é—¨çš„ç®¡ç†å›¢é˜Ÿèƒ½åˆ¶å®šéƒ¨é—¨å·¥ä½œç›®æ ‡å¹¶æ¨åŠ¨è½åœ°', value: 74 },
                'åé¦ˆ': { label: 'æˆ‘èƒ½é€šè¿‡æ¥æ”¶åé¦ˆäº†è§£è‡ªå·±çš„ä¼˜åŠ¿å’Œéœ€è¦æå‡çš„æ–¹å‘', value: 58 },
                'æ±°æ¢': { label: 'å…¬å¸èƒ½åŠæ—¶å’Œæœ‰æ•ˆåœ°å¤„ç†ç»©æ•ˆä¸ç†æƒ³çš„å‘˜å·¥', value: 49 },
                'åä½œ': { label: 'æˆ‘æ‰€åœ¨éƒ¨é—¨ä¸å…¶å®ƒéƒ¨é—¨èƒ½å¤Ÿæœ‰æ•ˆåœ°åè°ƒä¸åˆä½œ', value: 70 },
                'å­¦ä¹ ': { label: 'å…¬å¸æœ‰ç›¸å…³çš„å­¦ä¹ ä¸å‘å±•æœºä¼šï¼ˆå¦‚è¾…å¯¼åé¦ˆã€åœ¨å²—å­¦ä¹ ã€å‚åŠ åŸ¹è®­ç­‰ï¼‰ï¼Œå¸®åŠ©æˆ‘æŒæ¡æ‰€éœ€è¦çš„æŠ€èƒ½', value: 31 },
                'æˆå°±': { label: 'æˆ‘èƒ½ä»è‡ªå·±çš„å·¥ä½œä¸­è·å¾—æˆå°±æ„Ÿ', value: 65 },
                'å¹³è¡¡': { label: 'æˆ‘èƒ½åœ¨å·¥ä½œä¸ç”Ÿæ´»ä¹‹é—´ä¿æŒé€‚åº¦çš„å¹³è¡¡', value: 56 },
                'æ²Ÿé€š': { label: 'æˆ‘è®¤ä¸ºå…¬å¸å†…éƒ¨é¼“åŠ±å¦è¯šæ²Ÿé€š', value: 63 },
                'æµç¨‹': { label: 'å…¬å¸çš„å·¥ä½œæµç¨‹ï¼ˆå¦‚åˆ¶å®šå·¥ä½œç›®æ ‡ã€ä¸šåŠ¡æµç¨‹ã€æ“ä½œæŒ‡å¼•ç­‰ï¼‰å¸®åŠ©æˆ‘æœ‰æ•ˆåœ°å·¥ä½œ', value: 53 },
                'ç›®æ ‡': { label: 'æˆ‘çš„ç›´æ¥ä¸Šçº§ä¸æˆ‘è®¾å®šæ¸…æ™°çš„æœŸæœ›å’Œç›®æ ‡', value: 67 },
                'å£°èª‰': { label: 'æˆ‘å¾ˆè‡ªè±ªèƒ½æˆä¸ºå…¬å¸çš„ä¸€å‘˜', value: 62 },
                'è–ªé…¬': { label: 'ç›¸å¯¹æˆ‘ä¸ºå…¬å¸æ‰€ä½œå‡ºçš„è´¡çŒ®è€Œè¨€ï¼Œæˆ‘çš„è–ªé…¬å›æŠ¥æ˜¯åˆç†çš„', value: 44 },
                'è®¤å¯': { label: 'åœ¨å·¥ä½œä¸­ï¼Œæˆ‘çš„ä»˜å‡ºå’Œæˆç»©èƒ½è·å¾—é™¤è–ªé…¬å¤–çš„è®¤å¯ï¼ˆå¦‚å£å¤´è¡¨æ‰¬ã€è¡¨å½°ã€æ–°çš„é”»ç‚¼æœºä¼šç­‰ï¼‰', value: 52 },
                'èµ„æº': { label: 'å…¬å¸ç°æœ‰çš„å„é¡¹èµ„æºï¼ˆå¦‚: æŠ€æœ¯ã€å·¥å…·ã€ç³»ç»Ÿç­‰ï¼‰æœ‰åŠ©äºæˆ‘æé«˜å·¥ä½œæ•ˆç‡', value: 54 },
                'ç¦åˆ©': { label: 'æ€»ä½“æ¥è¯´ï¼Œå…¬å¸çš„ç¦åˆ©è®¡åˆ’èƒ½å¾ˆå¥½æ»¡è¶³æˆ‘çš„éœ€è¦', value: 78 },
                'ä¸Šçº§': { label: 'æˆ‘çš„ç›´æ¥ä¸Šçº§æŒç»­ç»™äºˆæˆ‘æœ‰ä»·å€¼çš„åé¦ˆï¼Œå¸®åŠ©æˆ‘æé«˜å·¥ä½œè¡¨ç°', value: 67 },
                'æ¶æ„': { label: 'æˆ‘æ‰€åœ¨çš„å›¢é˜Ÿï¼Œæ¶æ„æ¸…æ™°ã€æƒè´£æ˜ç¡®', value: 65 },
                'ç»©æ•ˆ': { label: 'æˆ‘çš„ç»©æ•ˆç»“æœå’Œè´¡çŒ®è¶Šå¤§ï¼Œæˆ‘å°±å¯ä»¥é¢„æœŸè·å¾—è¶Šå¤šçš„å¥–åŠ±ï¼ˆå¦‚å¥–é‡‘ã€æ™‹å‡ã€åŠ è–ªï¼‰', value: 52 }
            }
        };

        // éƒ¨é—¨æ•°æ®
        const departmentData = {
            all: [
                {name: 'è´¢åŠ¡éƒ¨', count: 10, engagement: 40, satisfaction: 40, efficiency: 0},
                {name: 'åŸåŒ—å¤§ç‹å¯¨å·¥ä½œå®¤', count: 172, engagement: 60, satisfaction: 61, efficiency: 55},
                {name: 'æ³•åŠ¡éƒ¨', count: 7, engagement: 71, satisfaction: 86, efficiency: 71},
                {name: 'æµ·å¤–å‘è¡Œéƒ¨', count: 3, engagement: 100, satisfaction: 100, efficiency: 100},
                {name: 'æå¿ƒç¤¾å·¥ä½œå®¤', count: 59, engagement: 68, satisfaction: 66, efficiency: 64},
                {name: 'æŠ€æœ¯æ”¯æ’‘éƒ¨', count: 62, engagement: 69, satisfaction: 66, efficiency: 61},
                {name: 'ç¾æœ¯æ”¯æ’‘éƒ¨', count: 46, engagement: 59, satisfaction: 59, efficiency: 52},
                {name: 'å¹³å°æ”¯æ’‘éƒ¨', count: 20, engagement: 60, satisfaction: 65, efficiency: 55},
                {name: 'æµ…æ°´å·¥ä½œå®¤', count: 12, engagement: 100, satisfaction: 100, efficiency: 100},
                {name: 'äººåŠ›èµ„æºéƒ¨', count: 18, engagement: 61, satisfaction: 78, efficiency: 56},
                {name: 'å¸‚åœºéƒ¨', count: 30, engagement: 63, satisfaction: 60, efficiency: 57},
                {name: 'é¡¹ç›®ç®¡ç†éƒ¨', count: 1, engagement: 100, satisfaction: 100, efficiency: 100},
                {name: 'éŸ³é¢‘æ”¯æ’‘éƒ¨', count: 11, engagement: 45, satisfaction: 64, efficiency: 45},
                {name: 'æ¸¸æˆèŒå·¥ä½œå®¤', count: 35, engagement: 66, satisfaction: 57, efficiency: 54},
                {name: 'å‘˜å·¥æœåŠ¡ä¸­å¿ƒ', count: 5, engagement: 100, satisfaction: 100, efficiency: 100},
                {name: 'è¿ç»´æ”¯æ’‘éƒ¨', count: 6, engagement: 100, satisfaction: 100, efficiency: 100},
                {name: 'è¿è¥éƒ¨', count: 47, engagement: 74, satisfaction: 72, efficiency: 68},
                {name: 'æ”¿ç­–å…³ç³»ä¸åˆè§„æ”¯æŒä¸­å¿ƒ', count: 19, engagement: 89, satisfaction: 89, efficiency: 89},
                {name: 'æ‰§è¡ŒåŠå…¬å®¤', count: 4, engagement: 75, satisfaction: 100, efficiency: 75},
                {name: 'ADN', count: 7, engagement: 71, satisfaction: 71, efficiency: 71},
                {name: 'Bæ ¼çŒ«å·¥ä½œå®¤', count: 60, engagement: 77, satisfaction: 72, efficiency: 68},
                {name: 'Digital & IT', count: 6, engagement: 67, satisfaction: 100, efficiency: 67},
                {name: 'Filo', count: 1, engagement: 100, satisfaction: 100, efficiency: 100},
                {name: 'Flash Party', count: 4, engagement: 75, satisfaction: 100, efficiency: 75},
                {name: 'PG å‘è¡Œ & å•†åŠ¡éƒ¨', count: 15, engagement: 73, satisfaction: 73, efficiency: 73},
                {name: 'TapTap', count: 168, engagement: 71, satisfaction: 69, efficiency: 66}
            ],
            secondary: [
                {name: 'TapTap', count: 245, engagement: 65, satisfaction: 67, efficiency: 58},
                {name: 'ç ”å‘ä¸­å¿ƒ', count: 189, engagement: 72, satisfaction: 69, efficiency: 62},
                {name: 'è¿è¥ä¸­å¿ƒ', count: 156, engagement: 63, satisfaction: 65, efficiency: 48},
                {name: 'æ”¯æ’‘éƒ¨é—¨', count: 238, engagement: 66, satisfaction: 68, efficiency: 54}
            ],
            management: [
                {name: 'ç®¡ç†å²—ä½', count: 157, engagement: 75, satisfaction: 75, efficiency: 69, frustrated: 6, satisfied: 6, inefficient: 19},
                {name: 'éç®¡ç†å²—ä½', count: 671, engagement: 66, satisfaction: 66, efficiency: 59, frustrated: 7, satisfied: 7, inefficient: 27}
            ],
            position: [
                {name: 'Level 3&4', count: 325, engagement: 72, satisfaction: 72, efficiency: 65, frustrated: 7, satisfied: 7, inefficient: 21},
                {name: 'Level 1&2', count: 503, engagement: 65, satisfaction: 65, efficiency: 59, frustrated: 6, satisfied: 6, inefficient: 29}
            ]
        };

        // åˆå§‹åŒ–é¡µé¢
        document.addEventListener('DOMContentLoaded', function() {
            updateMetrics();
            createCharts();
            switchTab('all', document.querySelector('.tab.active'));
        });

        // æ›´æ–°æ»¡æ„åº¦æŒ‡æ ‡
        function updateMetrics() {
            const container = document.getElementById('metrics-container');
            const selectedDept = document.getElementById('department-select').value;
            const metrics = satisfactionMetrics[selectedDept] || satisfactionMetrics.overall;
            
            container.innerHTML = '';
            
            Object.keys(metrics).forEach(key => {
                const metric = metrics[key];
                const item = document.createElement('div');
                item.className = 'metric-item';
                item.innerHTML = `
                    <div class="metric-label">${key} ${metric.label}</div>
                    <div class="metric-value">${metric.value}%</div>
                `;
                container.appendChild(item);
            });
        }

        // åˆ›å»ºå›¾è¡¨
        function createCharts() {
            // è±¡é™å›¾
            const quadrantCtx = document.getElementById('quadrant-chart').getContext('2d');
            new Chart(quadrantCtx, {
                type: 'bubble',
                data: {
                    datasets: [{
                        label: 'é«˜æ•ˆå‘˜å·¥',
                        data: [{x: 75, y: 75, r: 20}],
                        backgroundColor: 'rgba(52, 152, 219, 0.6)'
                    }, {
                        label: 'å—æŒ«å‘˜å·¥',
                        data: [{x: 25, y: 75, r: 15}],
                        backgroundColor: 'rgba(231, 76, 60, 0.6)'
                    }, {
                        label: 'æ»¡æ„å‘˜å·¥',
                        data: [{x: 75, y: 25, r: 15}],
                        backgroundColor: 'rgba(46, 204, 113, 0.6)'
                    }, {
                        label: 'ä½æ•ˆå‘˜å·¥',
                        data: [{x: 25, y: 25, r: 10}],
                        backgroundColor: 'rgba(155, 89, 182, 0.6)'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: { min: 0, max: 100, title: { display: true, text: 'æ»¡æ„åº¦ (%)' } },
                        y: { min: 0, max: 100, title: { display: true, text: 'æ•¬ä¸šåº¦ (%)' } }
                    }
                }
            });

            // è¶‹åŠ¿å›¾
            const trendCtx = document.getElementById('trend-chart').getContext('2d');
            new Chart(trendCtx, {
                type: 'line',
                data: {
                    labels: ['2023å¹´', '2024å¹´'],
                    datasets: [{
                        label: 'æ•¬ä¸šåº¦',
                        data: [60, 68],
                        borderColor: '#3498db',
                        backgroundColor: 'rgba(52, 152, 219, 0.1)',
                        fill: true
                    }, {
                        label: 'æ»¡æ„åº¦',
                        data: [60, 68],
                        borderColor: '#2ecc71',
                        backgroundColor: 'rgba(46, 204, 113, 0.1)',
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { min: 0, max: 100 }
                    }
                }
            });
        }

        // åˆ‡æ¢æ ‡ç­¾é¡µ
        function switchTab(type, element) {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            element.classList.add('active');
            
            const container = document.getElementById('table-container');
            const data = departmentData[type];
            
            if (type === 'management' || type === 'position') {
                // ç®¡ç†å±‚å¯¹æ¯”å’ŒèŒçº§åˆ†æè¡¨æ ¼
                container.innerHTML = `
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>${type === 'management' ? 'ç±»åˆ«' : 'èŒçº§'}</th>
                                <th>äººæ•°</th>
                                <th>æ•¬ä¸šåº¦</th>
                                <th>æ»¡æ„åº¦</th>
                                <th>é«˜æ•ˆæ¯”ä¾‹</th>
                                <th>å—æŒ«æ¯”ä¾‹</th>
                                <th>æ»¡æ„æ¯”ä¾‹</th>
                                <th>ä½æ•ˆæ¯”ä¾‹</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${data.map(item => `
                                <tr>
                                    <td><strong>${item.name}</strong></td>
                                    <td>${item.count}</td>
                                    <td>${item.engagement}%</td>
                                    <td>${item.satisfaction}%</td>
                                    <td>${item.efficiency}%</td>
                                    <td>${item.frustrated}%</td>
                                    <td>${item.satisfied}%</td>
                                    <td>${item.inefficient}%</td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                `;
            } else {
                // éƒ¨é—¨è¡¨æ ¼
                container.innerHTML = `
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>éƒ¨é—¨</th>
                                <th>å‚ä¸äººæ•°</th>
                                <th>æ•¬ä¸šåº¦</th>
                                <th>æ»¡æ„åº¦</th>
                                <th>é«˜æ•ˆå‘˜å·¥æ¯”ä¾‹</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${data.map(item => `
                                <tr>
                                    <td><strong>${item.name}</strong></td>
                                    <td>${item.count}</td>
                                    <td>${item.engagement}%</td>
                                    <td>${item.satisfaction}%</td>
                                    <td>${item.efficiency}%</td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                `;
            }
        }

        // å¯¼å‡ºæŠ¥å‘Š
        function exportReport() {
            alert('å¯¼å‡ºåŠŸèƒ½å¼€å‘ä¸­ï¼Œæ•¬è¯·æœŸå¾…ï¼');
        }

        // åˆ‡æ¢èŠå¤©æœºå™¨äºº
        function toggleChatbot() {
            const chatbot = document.getElementById('chatbot');
            chatbot.classList.toggle('active');
        }

        // é€šä¹‰åƒé—®APIé…ç½®
        const QWEN_CONFIG = {
            apiKey: 'sk-6a459681b8884c87a6631555cd68c314', // è¯·æ›¿æ¢ä¸ºæ‚¨çš„APIå¯†é’¥
            baseUrl: 'https://dashscope.aliyuncs.com/api/v1/services/aigc/text-generation/generation',
            model: 'qwen-turbo' // å¯é€‰æ‹© qwen-turbo, qwen-plus, qwen-max
        };

        // å‘é€æ¶ˆæ¯åˆ°é€šä¹‰åƒé—®
        async function sendMessage() {
            const input = document.getElementById('chat-input');
            const messages = document.getElementById('chat-messages');
            const message = input.value.trim();
            
            if (!message) return;
            
            // æ·»åŠ ç”¨æˆ·æ¶ˆæ¯
            const userMsg = document.createElement('div');
            userMsg.className = 'message user';
            userMsg.textContent = message;
            messages.appendChild(userMsg);
            
            // æ¸…ç©ºè¾“å…¥æ¡†å¹¶ç¦ç”¨
            input.value = '';
            input.disabled = true;
            
            // æ·»åŠ åŠ è½½æç¤º
            const loadingMsg = document.createElement('div');
            loadingMsg.className = 'message bot';
            loadingMsg.innerHTML = 'ğŸ¤” æ­£åœ¨æ€è€ƒä¸­...';
            messages.appendChild(loadingMsg);
            messages.scrollTop = messages.scrollHeight;
            
            try {
                // è°ƒç”¨é€šä¹‰åƒé—®API
                const response = await callQwenAPI(message);
                
                // ç§»é™¤åŠ è½½æç¤º
                messages.removeChild(loadingMsg);
                
                // æ·»åŠ AIå›å¤
                const botMsg = document.createElement('div');
                botMsg.className = 'message bot';
                botMsg.innerHTML = response;
                messages.appendChild(botMsg);
                
            } catch (error) {
                console.error('APIè°ƒç”¨å¤±è´¥:', error);
                
                // ç§»é™¤åŠ è½½æç¤º
                messages.removeChild(loadingMsg);
                
                // æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯æˆ–é™çº§åˆ°æœ¬åœ°å›å¤
                const botMsg = document.createElement('div');
                botMsg.className = 'message bot';
                botMsg.innerHTML = generateLocalResponse(message);
                messages.appendChild(botMsg);
            } finally {
                // é‡æ–°å¯ç”¨è¾“å…¥æ¡†
                input.disabled = false;
                input.focus();
                messages.scrollTop = messages.scrollHeight;
            }
        }

        // è°ƒç”¨é€šä¹‰åƒé—®API
        async function callQwenAPI(userMessage) {
            // æ„å»ºç³»ç»Ÿæç¤ºè¯ï¼ŒåŒ…å«å‘˜å·¥æ•¬ä¸šåº¦æ•°æ®ä¸Šä¸‹æ–‡
            const systemPrompt = `ä½ æ˜¯å¿ƒåŠ¨ç½‘ç»œçš„å‘˜å·¥æ•¬ä¸šåº¦æ•°æ®åˆ†æåŠ©æ‰‹ã€‚è¯·åŸºäºä»¥ä¸‹æ•°æ®å›ç­”ç”¨æˆ·é—®é¢˜ï¼š

2024å¹´å‘˜å·¥æ•¬ä¸šåº¦è°ƒç ”æ•°æ®ï¼š
- æ€»ä½“æ•¬ä¸šåº¦ï¼š68%ï¼ˆè¾ƒ2023å¹´ä¸Šå‡8%ï¼‰
- æ€»ä½“æ»¡æ„åº¦ï¼š68%ï¼ˆè¾ƒ2023å¹´ä¸Šå‡8%ï¼‰
- å‚ä¸ç‡ï¼š64.5%ï¼ˆ828/1,284äººå‚ä¸ï¼‰
- é«˜æ•ˆå‘˜å·¥æ¯”ä¾‹ï¼š63%

æ»¡æ„åº¦å­é—®é¢˜åˆ†æï¼ˆå…¨å…¬å¸æ€»ä½“ï¼‰ï¼š
- å·¥ä½œï¼šæˆ‘éå¸¸å–œæ¬¢è‡ªå·±çš„æ—¥å¸¸å·¥ä½œ 73%
- æ–‡åŒ–ï¼šæˆ‘è®¤åŒå…¬å¸å€¡å¯¼çš„æ–‡åŒ–æ°›å›´ 78%
- é«˜ç®¡ï¼šå…¬å¸çš„é«˜å±‚ç®¡ç†äººå‘˜èƒ½ä¸ºå…¬å¸åˆ¶å®šæ˜ç¡®çš„ä¸šåŠ¡å‘å±•æ–¹å‘ï¼Œå¹¶æ¨åŠ¨æ‰§è¡Œ 59%
- æˆé•¿ï¼šåœ¨å…¬å¸ï¼Œæˆ‘çš„èŒä¸šå‘å±•å‰æ™¯ä¸é”™ 42%
- ä¸­å±‚ï¼šæˆ‘æ‰€åœ¨éƒ¨é—¨çš„ç®¡ç†å›¢é˜Ÿèƒ½åˆ¶å®šéƒ¨é—¨å·¥ä½œç›®æ ‡å¹¶æ¨åŠ¨è½åœ° 74%
- å­¦ä¹ ï¼šå…¬å¸æœ‰ç›¸å…³çš„å­¦ä¹ ä¸å‘å±•æœºä¼š 31%
- è–ªé…¬ï¼šç›¸å¯¹æˆ‘ä¸ºå…¬å¸æ‰€ä½œå‡ºçš„è´¡çŒ®è€Œè¨€ï¼Œæˆ‘çš„è–ªé…¬å›æŠ¥æ˜¯åˆç†çš„ 44%
- ç¦åˆ©ï¼šæ€»ä½“æ¥è¯´ï¼Œå…¬å¸çš„ç¦åˆ©è®¡åˆ’èƒ½å¾ˆå¥½æ»¡è¶³æˆ‘çš„éœ€è¦ 78%

éƒ¨é—¨è¡¨ç°ï¼ˆæ•¬ä¸šåº¦/æ»¡æ„åº¦/é«˜æ•ˆæ¯”ä¾‹ï¼‰ï¼š
- æµ·å¤–å‘è¡Œéƒ¨ï¼š100%/100%/100%
- æµ…æ°´å·¥ä½œå®¤ï¼š100%/100%/100%
- é¡¹ç›®ç®¡ç†éƒ¨ï¼š100%/100%/100%
- å‘˜å·¥æœåŠ¡ä¸­å¿ƒï¼š100%/100%/100%
- è¿ç»´æ”¯æ’‘éƒ¨ï¼š100%/100%/100%
- Filoï¼š100%/100%/100%
- æ”¿ç­–å…³ç³»ä¸åˆè§„æ”¯æŒä¸­å¿ƒï¼š89%/89%/89%
- Bæ ¼çŒ«å·¥ä½œå®¤ï¼š77%/72%/68%
- è¿è¥éƒ¨ï¼š74%/72%/68%
- TapTapï¼š71%/69%/66%
- è´¢åŠ¡éƒ¨ï¼š40%/40%/0%ï¼ˆè¡¨ç°æœ€å·®ï¼‰

ç®¡ç†å±‚å¯¹æ¯”ï¼š
- ç®¡ç†å²—ä½ï¼š157äººï¼Œ75%æ•¬ä¸šåº¦ï¼Œ75%æ»¡æ„åº¦ï¼Œ69%é«˜æ•ˆæ¯”ä¾‹
- éç®¡ç†å²—ä½ï¼š671äººï¼Œ66%æ•¬ä¸šåº¦ï¼Œ66%æ»¡æ„åº¦ï¼Œ59%é«˜æ•ˆæ¯”ä¾‹

è¯·ç”¨ä¸“ä¸šã€å‹å¥½çš„è¯­æ°”å›ç­”é—®é¢˜ï¼Œæä¾›å…·ä½“çš„æ•°æ®æ”¯æŒå’Œæ”¹è¿›å»ºè®®ã€‚`;

            const requestBody = {
                model: QWEN_CONFIG.model,
                input: {
                    messages: [
                        {
                            role: "system",
                            content: systemPrompt
                        },
                        {
                            role: "user",
                            content: userMessage
                        }
                    ]
                },
                parameters: {
                    temperature: 0.7,
                    top_p: 0.8,
                    max_tokens: 1000
                }
            };

            const response = await fetch(QWEN_CONFIG.baseUrl, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${QWEN_CONFIG.apiKey}`,
                    'X-DashScope-SSE': 'disable'
                },
                body: JSON.stringify(requestBody)
            });

            if (!response.ok) {
                throw new Error(`APIè¯·æ±‚å¤±è´¥: ${response.status}`);
            }

            const data = await response.json();
            
            if (data.output && data.output.text) {
                return data.output.text;
            } else {
                throw new Error('APIè¿”å›æ ¼å¼å¼‚å¸¸');
            }
        }

        // æœ¬åœ°é™çº§å›å¤ï¼ˆå½“APIä¸å¯ç”¨æ—¶ä½¿ç”¨ï¼‰
        function generateLocalResponse(message) {
            const msg = message.toLowerCase();
            
            if (msg.includes('æœ€å¥½') || msg.includes('è¡¨ç°')) {
                return 'æ ¹æ®æ•°æ®åˆ†æï¼Œæµ·å¤–å‘è¡Œéƒ¨ã€æµ…æ°´å·¥ä½œå®¤ã€é¡¹ç›®ç®¡ç†éƒ¨ã€å‘˜å·¥æœåŠ¡ä¸­å¿ƒã€è¿ç»´æ”¯æ’‘éƒ¨ã€Filoè¡¨ç°æœ€ä½³ï¼Œæ•¬ä¸šåº¦å’Œæ»¡æ„åº¦å‡è¾¾åˆ°100%ã€‚æ”¿ç­–å…³ç³»ä¸åˆè§„æ”¯æŒä¸­å¿ƒä¹Ÿè¡¨ç°ä¼˜ç§€ï¼Œæ•¬ä¸šåº¦å’Œæ»¡æ„åº¦å‡ä¸º89%ã€‚';
            } else if (msg.includes('è¶‹åŠ¿') || msg.includes('å˜åŒ–')) {
                return '2024å¹´ç›¸æ¯”2023å¹´ï¼Œæ•¬ä¸šåº¦å’Œæ»¡æ„åº¦å‡æå‡äº†8ä¸ªç™¾åˆ†ç‚¹ï¼Œä»60%æå‡åˆ°68%ï¼Œæ˜¾ç¤ºå‡ºç§¯æçš„å‘å±•è¶‹åŠ¿ã€‚é«˜æ•ˆå‘˜å·¥æ¯”ä¾‹è¾¾åˆ°63%ã€‚';
            } else if (msg.includes('é—®é¢˜') || msg.includes('æ”¹è¿›')) {
                return 'ä¸»è¦é—®é¢˜é›†ä¸­åœ¨ï¼š1ï¼‰è´¢åŠ¡éƒ¨æ•¬ä¸šåº¦å’Œæ»¡æ„åº¦å‡åªæœ‰40%ï¼›2ï¼‰å­¦ä¹ å‘å±•æœºä¼šæ»¡æ„åº¦ä»…31%ï¼›3ï¼‰è–ªé…¬æ»¡æ„åº¦44%ï¼›4ï¼‰èŒä¸šæˆé•¿æ»¡æ„åº¦42%ã€‚å»ºè®®é‡ç‚¹å…³æ³¨è¿™äº›é¢†åŸŸçš„æ”¹è¿›ã€‚';
            } else if (msg.includes('æ»¡æ„åº¦') || msg.includes('å­é—®é¢˜')) {
                return 'æ»¡æ„åº¦å­é—®é¢˜åˆ†ææ˜¾ç¤ºï¼šæ–‡åŒ–è®¤åŒåº¦æœ€é«˜(78%)ï¼Œç¦åˆ©æ»¡æ„åº¦ä¹Ÿè¾ƒé«˜(78%)ï¼Œä½†å­¦ä¹ å‘å±•æœºä¼š(31%)ã€èŒä¸šæˆé•¿(42%)ã€è–ªé…¬æ»¡æ„åº¦(44%)è¾ƒä½ï¼Œéœ€è¦é‡ç‚¹æ”¹å–„ã€‚';
            } else {
                return 'æ„Ÿè°¢æ‚¨çš„æé—®ï¼æˆ‘å¯ä»¥å¸®æ‚¨åˆ†æéƒ¨é—¨è¡¨ç°ã€è¶‹åŠ¿å˜åŒ–ã€æ»¡æ„åº¦å­é—®é¢˜å’Œæ”¹è¿›å»ºè®®ã€‚è¯·å‘Šè¯‰æˆ‘æ‚¨æƒ³äº†è§£å“ªä¸ªæ–¹é¢çš„å…·ä½“ä¿¡æ¯ã€‚';
            }
        }
    </script>
</body>
</html> 