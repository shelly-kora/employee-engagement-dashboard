<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¿ƒåŠ¨å‘˜å·¥æ•¬ä¸šåº¦è°ƒç ”æ•°æ®</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <style>
        :root {
            --primary: #0078d4;
            --success: #107c10;
            --warning: #ff8c00;
            --danger: #d13438;
            --info: #0078d4;
            --light: #f8f9fa;
            --dark: #323130;
            --surface: #ffffff;
            --border: #e1dfdd;
            --text-primary: #323130;
            --text-secondary: #605e5c;
            --green: #107c10;
            --orange: #ff8c00;
            --red: #d13438;
            --blue: #0078d4;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', 'Roboto', sans-serif;
            background-color: var(--light);
            color: var(--text-primary);
            line-height: 1.5;
        }
        
        .header {
            background: var(--surface);
            border-bottom: 1px solid var(--border);
            padding: 16px 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .logo-section {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .logo {
            font-size: 24px;
            color: var(--primary);
        }
        
        .title-group h1 {
            font-size: 20px;
            font-weight: 600;
            color: var(--text-primary);
            margin: 0;
        }
        
        .title-group .subtitle {
            font-size: 14px;
            color: var(--text-secondary);
            margin-top: 2px;
        }
        
        .actions {
            display: flex;
            gap: 12px;
        }
        
        .btn {
            padding: 8px 16px;
            border-radius: 4px;
            border: none;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.2s;
        }
        
        .btn-outline {
            background: var(--surface);
            border: 1px solid var(--border);
            color: var(--text-primary);
        }
        
        .btn-primary {
            background: var(--primary);
            color: white;
        }
        
        .btn:hover {
            opacity: 0.9;
            transform: translateY(-1px);
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 24px;
        }
        
        .kpi-card {
            background: var(--surface);
            border-radius: 8px;
            padding: 24px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border-left: 4px solid var(--primary);
            transition: transform 0.2s;
        }
        
        .kpi-card:hover {
            transform: translateY(-2px);
        }
        
        .kpi-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }
        
        .kpi-title {
            font-size: 14px;
            color: var(--text-secondary);
            font-weight: 500;
        }
        
        .kpi-icon {
            font-size: 24px;
            opacity: 0.7;
        }
        
        .kpi-value {
            font-size: 36px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 8px;
        }
        
        .kpi-change {
            display: flex;
            align-items: center;
            gap: 4px;
            font-size: 14px;
        }
        
        .trend-up {
            color: var(--green);
        }
        
        .trend-down {
            color: var(--red);
        }
        
        .charts-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 24px;
        }
        
        .chart-card {
            background: var(--surface);
            border-radius: 8px;
            padding: 24px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--border);
        }
        
        .chart-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
        }
        
        .chart-container {
            height: 320px;
            position: relative;
        }
        
        .full-width {
            grid-column: 1 / -1;
        }
        
        .tabs {
            display: flex;
            border-bottom: 2px solid var(--border);
            margin-bottom: 20px;
        }
        
        .tab {
            padding: 12px 20px;
            font-size: 14px;
            font-weight: 500;
            color: var(--text-secondary);
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: all 0.2s;
        }
        
        .tab.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }
        
        .tab:hover:not(.active) {
            color: var(--text-primary);
        }
        
        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
        }
        
        .data-table th {
            background: var(--light);
            padding: 12px 16px;
            text-align: left;
            font-weight: 600;
            color: var(--text-primary);
            border-bottom: 2px solid var(--border);
        }
        
        .data-table td {
            padding: 12px 16px;
            border-bottom: 1px solid var(--border);
        }
        
        .data-table tr:hover {
            background: var(--light);
        }
        
        .department-table tr.expandable {
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        .department-table tr.expandable:hover {
            background: rgba(0, 120, 212, 0.05);
        }
        
        .department-table tr.expandable td:first-child::before {
            content: 'â–¶';
            margin-right: 8px;
            transition: transform 0.2s;
            display: inline-block;
        }
        
        .department-table tr.expandable.expanded td:first-child::before {
            transform: rotate(90deg);
        }
        
        .department-table tr.sub-department {
            background: rgba(0, 120, 212, 0.02);
            display: none;
        }
        
        .department-table tr.sub-department.show {
            display: table-row;
        }
        
        .department-table tr.sub-department td:first-child {
            padding-left: 40px;
            border-left: 3px solid var(--primary);
            position: relative;
        }
        
        .department-table tr.sub-department td:first-child::before {
            content: 'â””';
            position: absolute;
            left: 20px;
            color: var(--text-secondary);
        }
        
        .metric-badge {
            display: inline-flex;
            align-items: center;
            padding: 4px 12px;
            border-radius: 16px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .badge-excellent {
            background: rgba(16, 124, 16, 0.1);
            color: var(--green);
        }
        
        .badge-good {
            background: rgba(0, 120, 212, 0.1);
            color: var(--blue);
        }
        
        .badge-average {
            background: rgba(255, 140, 0, 0.1);
            color: var(--orange);
        }
        
        .badge-poor {
            background: rgba(209, 52, 56, 0.1);
            color: var(--red);
        }
        
        .department-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 16px;
            margin-top: 20px;
        }
        
        .department-card {
            background: var(--surface);
            border-radius: 8px;
            padding: 20px;
            border: 1px solid var(--border);
        }
        
        .department-name {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 12px;
        }
        
        .department-metrics {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
        }
        
        .metric {
            text-align: center;
        }
        
        .metric-value {
            font-size: 20px;
            font-weight: 700;
            color: var(--primary);
        }
        
        .metric-label {
            font-size: 12px;
            color: var(--text-secondary);
            margin-top: 4px;
        }
        
        .hidden {
            display: none;
        }
        
        .chatbot {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 350px;
            height: 500px;
            background: var(--surface);
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.2);
            display: flex;
            flex-direction: column;
            z-index: 1000;
        }
        
        .chatbot-header {
            padding: 16px;
            background: var(--primary);
            color: white;
            border-radius: 12px 12px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .chatbot-close {
            background: none;
            border: none;
            color: white;
            font-size: 18px;
            cursor: pointer;
        }
        
        .chatbot-messages {
            flex: 1;
            padding: 16px;
            overflow-y: auto;
        }
        
        .message {
            margin-bottom: 12px;
            padding: 12px;
            border-radius: 12px;
            max-width: 80%;
        }
        
        .message.user {
            background: var(--primary);
            color: white;
            margin-left: auto;
        }
        
        .message.bot {
            background: var(--light);
            color: var(--text-primary);
        }
        
        .chatbot-input {
            padding: 16px;
            border-top: 1px solid var(--border);
            display: flex;
            gap: 8px;
        }
        
        .chatbot-input input {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid var(--border);
            border-radius: 20px;
            outline: none;
        }
        
        .chatbot-input button {
            padding: 8px 16px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 20px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="logo-section">
            <div class="logo">ğŸ“Š</div>
            <div class="title-group">
                <h1>å¿ƒåŠ¨å‘˜å·¥æ•¬ä¸šåº¦è°ƒç ”æ•°æ®</h1>
                <div class="subtitle">2024å¹´åº¦åˆ†ææŠ¥å‘Š</div>
            </div>
        </div>
        <div class="actions">
            <input type="file" id="excel-file" style="display: none;" accept=".xlsx,.xls" />
            <button class="btn btn-outline" onclick="document.getElementById('excel-file').click()">
                <span>ğŸ“¤</span> ä¸Šä¼ æ•°æ®
            </button>
            <button class="btn btn-primary" onclick="toggleChatbot()">
                <span>ğŸ’¬</span> æ™ºèƒ½é—®ç­”
            </button>
        </div>
    </div>

    <div class="container">
        <!-- KPI ä»ªè¡¨æ¿ -->
        <div class="kpi-grid">
            <div class="kpi-card">
                <div class="kpi-header">
                    <div class="kpi-title">æ€»ä½“äººæ•°</div>
                    <div class="kpi-icon">ğŸ‘¥</div>
                </div>
                <div class="kpi-value">1,284</div>
                <div class="kpi-change">
                    <span>å‘˜å·¥æ€»æ•°</span>
                </div>
            </div>
            <div class="kpi-card">
                <div class="kpi-header">
                    <div class="kpi-title">å¡«å†™äººæ•°</div>
                    <div class="kpi-icon">âœ…</div>
                </div>
                <div class="kpi-value">828</div>
                <div class="kpi-change">
                    <span class="trend-up">â–² 64.5%</span> å¡«å†™ç‡
                </div>
            </div>
            <div class="kpi-card">
                <div class="kpi-header">
                    <div class="kpi-title">2024å¹´æ•¬ä¸šåº¦</div>
                    <div class="kpi-icon">ğŸ”¥</div>
                </div>
                <div class="kpi-value">68%</div>
                <div class="kpi-change">
                    <span class="trend-up">â–² +8%</span> vs 2023å¹´
                </div>
            </div>
            <div class="kpi-card">
                <div class="kpi-header">
                    <div class="kpi-title">2024å¹´æ»¡æ„åº¦</div>
                    <div class="kpi-icon">ğŸ˜Š</div>
                </div>
                <div class="kpi-value">68%</div>
                <div class="kpi-change">
                    <span class="trend-up">â–² +8%</span> vs 2023å¹´
                </div>
            </div>
        </div>

        <!-- å›¾è¡¨ç½‘æ ¼ -->
        <div class="charts-grid">
            <!-- æ•¬ä¸šåº¦-æ»¡æ„åº¦å››è±¡é™å›¾ -->
            <div class="chart-card">
                <div class="chart-header">
                    <div class="chart-title">å‘˜å·¥æ•¬ä¸š-æ»¡æ„åº¦äº¤å‰åˆ†æ</div>
                </div>
                <div class="chart-container">
                    <canvas id="quadrantChart"></canvas>
                </div>
            </div>

            <!-- å¹´åº¦å¯¹æ¯”å›¾ -->
            <div class="chart-card">
                <div class="chart-header">
                    <div class="chart-title">å¹´åº¦å¯¹æ¯”è¶‹åŠ¿</div>
                </div>
                <div class="chart-container">
                    <canvas id="yearly-trend"></canvas>
                </div>
            </div>
        </div>

        <!-- æ ‡ç­¾é¡µ -->
        <div class="tabs">
            <button class="tab active" onclick="showTab('departments')">å…¨éƒ¨éƒ¨é—¨</button>
            <button class="tab" onclick="showTab('subdepartments')">äºŒçº§éƒ¨é—¨</button>
            <button class="tab" onclick="showTab('management')">ç®¡ç†å±‚å¯¹æ¯”</button>
            <button class="tab" onclick="showTab('levels')">èŒçº§åˆ†æ</button>
        </div>

        <!-- æ ‡ç­¾é¡µå†…å®¹ -->
        <div id="departments" class="tab-content active">
            <table class="department-table">
                <thead>
                    <tr>
                        <th style="width: 40%;">éƒ¨é—¨</th>
                        <th style="width: 12%;">å‚ä¸äººæ•°</th>
                        <th style="width: 16%;">æ•¬ä¸šåº¦</th>
                        <th style="width: 16%;">æ»¡æ„åº¦</th>
                        <th style="width: 16%;">é«˜æ•ˆå‘˜å·¥æ¯”ä¾‹</th>
                    </tr>
                </thead>
                <tbody id="departmentTableBody">
                    <!-- éƒ¨é—¨æ•°æ®å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                </tbody>
            </table>
        </div>

        <div id="subdepartments" class="tab-content">
            <table class="department-table">
                <thead>
                    <tr>
                        <th style="width: 30%;">äºŒçº§éƒ¨é—¨</th>
                        <th style="width: 20%;">æ‰€å±ä¸€çº§éƒ¨é—¨</th>
                        <th style="width: 12%;">å‚ä¸äººæ•°</th>
                        <th style="width: 13%;">æ•¬ä¸šåº¦</th>
                        <th style="width: 13%;">æ»¡æ„åº¦</th>
                        <th style="width: 12%;">é«˜æ•ˆå‘˜å·¥æ¯”ä¾‹</th>
                    </tr>
                </thead>
                <tbody id="subDepartmentTableBody">
                    <!-- äºŒçº§éƒ¨é—¨æ•°æ®å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                </tbody>
            </table>
        </div>

        <div id="management" class="tab-content">
            <table class="department-table">
                <thead>
                    <tr>
                        <th>ç®¡ç†å²—ä½</th>
                        <th>å¡«å†™äººæ•°</th>
                        <th>æ•¬ä¸šåº¦</th>
                        <th>æ»¡æ„åº¦</th>
                        <th>æ•¬ä¸šä¸”æ»¡æ„æ¯”ä¾‹</th>
                    </tr>
                </thead>
                <tbody id="managementTableBody">
                    <!-- ç®¡ç†å²—ä½æ•°æ®å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                </tbody>
            </table>
        </div>

        <div id="levels" class="tab-content">
            <table class="department-table">
                <thead>
                    <tr>
                        <th>èŒçº§</th>
                        <th>å¡«å†™äººæ•°</th>
                        <th>æ•¬ä¸šåº¦</th>
                        <th>æ»¡æ„åº¦</th>
                        <th>æ•¬ä¸šä¸”æ»¡æ„æ¯”ä¾‹</th>
                    </tr>
                </thead>
                <tbody id="levelsTableBody">
                    <!-- èŒçº§æ•°æ®å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                </tbody>
            </table>
        </div>
    </div>

    <!-- èŠå¤©æœºå™¨äºº -->
    <div class="chatbot hidden" id="chatbot">
        <div class="chatbot-header">
            <span>ğŸ’¬ æ•°æ®åŠ©æ‰‹</span>
            <button class="chatbot-close" onclick="toggleChatbot()">âœ•</button>
        </div>
        <div class="chatbot-messages" id="chat-messages">
            <div class="message bot">
                æ‚¨å¥½ï¼æˆ‘æ˜¯å‘˜å·¥æ•¬ä¸šåº¦è°ƒç ”æ•°æ®åŠ©æ‰‹ã€‚æ‚¨å¯ä»¥è¯¢é—®ï¼š<br>
                â€¢ å“ªä¸ªéƒ¨é—¨è¡¨ç°æœ€å¥½ï¼Ÿ<br>
                â€¢ æ•¬ä¸šåº¦å˜åŒ–è¶‹åŠ¿å¦‚ä½•ï¼Ÿ<br>
                â€¢ æ»¡æ„åº¦ä¸»è¦é—®é¢˜åœ¨å“ªé‡Œï¼Ÿ
            </div>
        </div>
        <div class="chatbot-input">
            <input type="text" id="chat-input" placeholder="è¾“å…¥æ‚¨çš„é—®é¢˜..." onkeypress="if(event.key==='Enter') sendMessage()">
            <button onclick="sendMessage()">å‘é€</button>
        </div>
    </div>

    <script>
        // å…¨å±€æ•°æ®å­˜å‚¨
        let surveyData = {
            "å¡«å†™ç‡": [{"æ€»ä½“äººæ•°": 1284, "å¡«å†™äººæ•°": 828, "å¡«å†™ç‡": 0.645, "å¯¹æ¯”å»å¹´": 0.145}],
            "ç»“è®ºæ¦‚è§ˆ": [{"24å¹´æ•¬ä¸šåº¦": 0.68, "23å¹´æ•¬ä¸šåº¦": 0.6, "24å¹´æ»¡æ„åº¦": 0.68, "23å¹´æ»¡æ„åº¦": 0.6}],
            "æŒ‰ç®¡ç†å²—ä½": [
                {"å²—ä½ç±»å‹": "ç®¡ç†å²—ä½", "å¡«å†™äººæ•°": 157, "æ•¬ä¸šåº¦": 0.764, "æ»¡æ„åº¦": 0.783, "æ•¬ä¸šä¸”æ»¡æ„": 0.694},
                {"å²—ä½ç±»å‹": "éç®¡ç†å²—ä½", "å¡«å†™äººæ•°": 671, "æ•¬ä¸šåº¦": 0.662, "æ»¡æ„åº¦": 0.654, "æ•¬ä¸šä¸”æ»¡æ„": 0.613}
            ],
            "æŒ‰èŒçº§": [
                {"èŒçº§ç±»å‹": "3å’Œ4èŒçº§", "å¡«å†™äººæ•°": 325, "æ•¬ä¸šåº¦": 0.708, "æ»¡æ„åº¦": 0.705, "æ•¬ä¸šä¸”æ»¡æ„": 0.652},
                {"èŒçº§ç±»å‹": "1å’Œ2èŒçº§", "å¡«å†™äººæ•°": 503, "æ•¬ä¸šåº¦": 0.664, "æ»¡æ„åº¦": 0.662, "æ•¬ä¸šä¸”æ»¡æ„": 0.612}
            ]
        };
        
        let departmentData = [
            // ä¸€çº§éƒ¨é—¨æ•°æ®
            {name: 'è´¢åŠ¡éƒ¨', count: 10, engagement: 40, satisfaction: 40, efficiency: 0, 
             engagementSatisfied: 0, frustrated: 0, satisfied: 60, inefficient: 40},
            {name: 'åŸåŒ—å¤§ç‹å¯¨å·¥ä½œå®¤', count: 172, engagement: 60, satisfaction: 61, efficiency: 55,
             engagementSatisfied: 55, frustrated: 6, satisfied: 6, inefficient: 33},
            {name: 'æ³•åŠ¡éƒ¨', count: 7, engagement: 71, satisfaction: 86, efficiency: 71,
             engagementSatisfied: 71, frustrated: 0, satisfied: 14, inefficient: 14},
            {name: 'æµ·å¤–å‘è¡Œéƒ¨', count: 3, engagement: 100, satisfaction: 100, efficiency: 100,
             engagementSatisfied: 100, frustrated: 0, satisfied: 0, inefficient: 0},
            {name: 'æå¿ƒç¤¾å·¥ä½œå®¤', count: 59, engagement: 68, satisfaction: 66, efficiency: 64,
             engagementSatisfied: 64, frustrated: 3, satisfied: 2, inefficient: 31},
            {name: 'æŠ€æœ¯æ”¯æ’‘éƒ¨', count: 62, engagement: 69, satisfaction: 66, efficiency: 61,
             engagementSatisfied: 61, frustrated: 8, satisfied: 5, inefficient: 26},
            {name: 'ç¾æœ¯æ”¯æ’‘éƒ¨', count: 46, engagement: 59, satisfaction: 59, efficiency: 52,
             engagementSatisfied: 52, frustrated: 7, satisfied: 7, inefficient: 35},
            {name: 'å¹³å°æ”¯æ’‘éƒ¨', count: 20, engagement: 60, satisfaction: 65, efficiency: 55,
             engagementSatisfied: 55, frustrated: 5, satisfied: 10, inefficient: 30},
            {name: 'æµ…æ°´å·¥ä½œå®¤', count: 12, engagement: 100, satisfaction: 100, efficiency: 100,
             engagementSatisfied: 100, frustrated: 0, satisfied: 0, inefficient: 0},
            {name: 'äººåŠ›èµ„æºéƒ¨', count: 18, engagement: 61, satisfaction: 78, efficiency: 56,
             engagementSatisfied: 56, frustrated: 6, satisfied: 22, inefficient: 17},
            {name: 'å¸‚åœºéƒ¨', count: 30, engagement: 63, satisfaction: 60, efficiency: 57,
             engagementSatisfied: 57, frustrated: 7, satisfied: 3, inefficient: 33},
            {name: 'é¡¹ç›®ç®¡ç†éƒ¨', count: 1, engagement: 100, satisfaction: 100, efficiency: 100,
             engagementSatisfied: 100, frustrated: 0, satisfied: 0, inefficient: 0},
            {name: 'éŸ³é¢‘æ”¯æ’‘éƒ¨', count: 11, engagement: 45, satisfaction: 64, efficiency: 45,
             engagementSatisfied: 45, frustrated: 0, satisfied: 18, inefficient: 36},
            {name: 'æ¸¸æˆèŒå·¥ä½œå®¤', count: 35, engagement: 66, satisfaction: 57, efficiency: 54,
             engagementSatisfied: 54, frustrated: 11, satisfied: 3, inefficient: 31},
            {name: 'å‘˜å·¥æœåŠ¡ä¸­å¿ƒ', count: 5, engagement: 100, satisfaction: 100, efficiency: 100,
             engagementSatisfied: 100, frustrated: 0, satisfied: 0, inefficient: 0},
            {name: 'è¿ç»´æ”¯æ’‘éƒ¨', count: 6, engagement: 100, satisfaction: 100, efficiency: 100,
             engagementSatisfied: 100, frustrated: 0, satisfied: 0, inefficient: 0},
            {name: 'è¿è¥éƒ¨', count: 47, engagement: 74, satisfaction: 72, efficiency: 68,
             engagementSatisfied: 68, frustrated: 6, satisfied: 4, inefficient: 21},
            {name: 'æ”¿ç­–å…³ç³»ä¸åˆè§„æ”¯æŒä¸­å¿ƒ', count: 19, engagement: 89, satisfaction: 89, efficiency: 89,
             engagementSatisfied: 89, frustrated: 0, satisfied: 0, inefficient: 11},
            {name: 'æ‰§è¡ŒåŠå…¬å®¤', count: 4, engagement: 75, satisfaction: 100, efficiency: 75,
             engagementSatisfied: 75, frustrated: 0, satisfied: 25, inefficient: 0},
            {name: 'ADN', count: 7, engagement: 71, satisfaction: 71, efficiency: 71,
             engagementSatisfied: 71, frustrated: 0, satisfied: 0, inefficient: 29},
            {name: 'Bæ ¼çŒ«å·¥ä½œå®¤', count: 60, engagement: 77, satisfaction: 72, efficiency: 68,
             engagementSatisfied: 68, frustrated: 8, satisfied: 3, inefficient: 20},
            {name: 'Digital & IT', count: 6, engagement: 67, satisfaction: 100, efficiency: 67,
             engagementSatisfied: 67, frustrated: 0, satisfied: 33, inefficient: 0},
            {name: 'Filo', count: 1, engagement: 100, satisfaction: 100, efficiency: 100,
             engagementSatisfied: 100, frustrated: 0, satisfied: 0, inefficient: 0},
            {name: 'Flash Party', count: 4, engagement: 75, satisfaction: 100, efficiency: 75,
             engagementSatisfied: 75, frustrated: 0, satisfied: 25, inefficient: 0},
            {name: 'PG å‘è¡Œ & å•†åŠ¡éƒ¨', count: 15, engagement: 73, satisfaction: 73, efficiency: 73,
             engagementSatisfied: 73, frustrated: 0, satisfied: 0, inefficient: 27},
            {name: 'TapTap', count: 168, engagement: 71, satisfaction: 69, efficiency: 66,
             engagementSatisfied: 66, frustrated: 5, satisfied: 3, inefficient: 26}
        ];

        // åŸºäºCSVæ•°æ®çš„äºŒçº§éƒ¨é—¨æ•°æ®
        const subDepartmentData = {
            'åŸåŒ—å¤§ç‹å¯¨å·¥ä½œå®¤': [
                {name: 'æµ·ç›—é¡¹ç›®ç»„', count: 60, engagement: Math.round(0.55*100), satisfaction: Math.round(0.6*100), efficiency: Math.round(0.5*100)},
                {name: 'æ¨ªæ‰«åƒå†›é¡¹ç›®ç»„', count: 2, engagement: Math.round(0.5*100), satisfaction: Math.round(0.5*100), efficiency: Math.round(0.5*100)},
                {name: 'å…¶ä»–', count: 2, engagement: Math.round(0.5*100), satisfaction: Math.round(0.5*100), efficiency: Math.round(0.5*100)},
                {name: 'ä¼Šç‘Ÿé¡¹ç›®ç»„ï¼ˆEtheriaï¼‰', count: 53, engagement: Math.round(0.716981132075472*100), satisfaction: Math.round(0.660377358490566*100), efficiency: Math.round(0.622641509433962*100)},
                {name: 'Mekaé¡¹ç›®ç»„', count: 55, engagement: Math.round(0.563636363636364*100), satisfaction: Math.round(0.581818181818182*100), efficiency: Math.round(0.527272727272727*100)}
            ],
            'æå¿ƒç¤¾å·¥ä½œå®¤': [
                {name: 'ç­–åˆ’', count: 21, engagement: Math.round(0.857142857142857*100), satisfaction: Math.round(0.80952380952381*100), efficiency: Math.round(0.80952380952381*100)},
                {name: 'æŠ€æœ¯', count: 9, engagement: Math.round(0.555555555555556*100), satisfaction: Math.round(0.555555555555556*100), efficiency: Math.round(0.555555555555556*100)},
                {name: 'ç¾æœ¯', count: 24, engagement: Math.round(0.583333333333333*100), satisfaction: Math.round(0.583333333333333*100), efficiency: Math.round(0.541666666666667*100)},
                {name: 'å…¶ä»–', count: 5, engagement: Math.round(0.6*100), satisfaction: Math.round(0.6*100), efficiency: Math.round(0.6*100)}
            ],
            'æŠ€æœ¯æ”¯æ’‘éƒ¨': [
                {name: 'å“æ§æ”¯æ’‘', count: 31, engagement: Math.round(0.71*100), satisfaction: Math.round(0.68*100), efficiency: Math.round(0.61*100)},
                {name: 'å…¶ä»–', count: 2, engagement: Math.round(0.5*100), satisfaction: Math.round(0.5*100), efficiency: Math.round(0.5*100)},
                {name: 'ç ”å‘æ”¯æ’‘', count: 29, engagement: Math.round(0.69*100), satisfaction: Math.round(0.66*100), efficiency: Math.round(0.62*100)}
            ],
            'ç¾æœ¯æ”¯æ’‘éƒ¨': [
                {name: '2Dç»„', count: 5, engagement: Math.round(0.8*100), satisfaction: Math.round(0.6*100), efficiency: Math.round(0.6*100)},
                {name: '3Dç»„', count: 9, engagement: Math.round(0.777777777777778*100), satisfaction: Math.round(0.888888888888889*100), efficiency: Math.round(0.777777777777778*100)},
                {name: 'ç¾å®£ç»„', count: 3, engagement: Math.round(1.0*100), satisfaction: Math.round(1.0*100), efficiency: Math.round(1.0*100)},
                {name: 'å…¶ä»–', count: 6, engagement: Math.round(0.833333333333333*100), satisfaction: Math.round(0.833333333333333*100), efficiency: Math.round(0.833333333333333*100)},
                {name: 'å½±è§†åˆ›æ„ç»„', count: 7, engagement: Math.round(0.714285714285714*100), satisfaction: Math.round(0.571428571428571*100), efficiency: Math.round(0.571428571428571*100)},
                {name: 'UIç»„', count: 16, engagement: Math.round(0.1875*100), satisfaction: Math.round(0.25*100), efficiency: Math.round(0.125*100)}
            ],
            'å¹³å°æ”¯æ’‘éƒ¨': [
                {name: 'æŠ€æœ¯', count: 8, engagement: Math.round(0.5*100), satisfaction: Math.round(0.625*100), efficiency: Math.round(0.5*100)},
                {name: 'å…¶ä»–', count: 3, engagement: Math.round(0.666666666666667*100), satisfaction: Math.round(0.666666666666667*100), efficiency: Math.round(0.666666666666667*100)},
                {name: 'TapDB', count: 7, engagement: Math.round(0.571428571428571*100), satisfaction: Math.round(0.571428571428571*100), efficiency: Math.round(0.428571428571429*100)},
                {name: 'XDWeb', count: 2, engagement: Math.round(1.0*100), satisfaction: Math.round(1.0*100), efficiency: Math.round(1.0*100)}
            ],
            'æµ…æ°´å·¥ä½œå®¤': [
                {name: 'å…¶ä»–', count: 6, engagement: Math.round(1.0*100), satisfaction: Math.round(1.0*100), efficiency: Math.round(1.0*100)},
                {name: 'ç¥ä»™é“', count: 6, engagement: Math.round(1.0*100), satisfaction: Math.round(1.0*100), efficiency: Math.round(1.0*100)}
            ],
            'äººåŠ›èµ„æºéƒ¨': [
                {name: 'å…¶ä»–', count: 8, engagement: Math.round(0.375*100), satisfaction: Math.round(0.625*100), efficiency: Math.round(0.25*100)},
                {name: 'äººæ‰å¼•è¿›', count: 5, engagement: Math.round(0.8*100), satisfaction: Math.round(0.8*100), efficiency: Math.round(0.8*100)},
                {name: 'HRBP', count: 5, engagement: Math.round(0.8*100), satisfaction: Math.round(1.0*100), efficiency: Math.round(0.8*100)}
            ],
            'å¸‚åœºéƒ¨': [
                {name: 'å›½å†…æŠ•æ”¾', count: 6, engagement: Math.round(0.833333333333333*100), satisfaction: Math.round(0.833333333333333*100), efficiency: Math.round(0.833333333333333*100)},
                {name: 'åª’ä»‹å…¬å…³', count: 4, engagement: Math.round(0.5*100), satisfaction: Math.round(0.25*100), efficiency: Math.round(0.25*100)},
                {name: 'å…¶ä»–', count: 1, engagement: Math.round(1.0*100), satisfaction: Math.round(1.0*100), efficiency: Math.round(1.0*100)},
                {name: 'å¸‚åœºè¥é”€', count: 6, engagement: Math.round(0.833333333333333*100), satisfaction: Math.round(1.0*100), efficiency: Math.round(0.833333333333333*100)},
                {name: 'è§†è§‰åˆ›æ„', count: 13, engagement: Math.round(0.461538461538462*100), satisfaction: Math.round(0.384615384615385*100), efficiency: Math.round(0.384615384615385*100)}
            ],
            'éŸ³é¢‘æ”¯æ’‘éƒ¨': [
                {name: 'å…¶ä»–', count: 3, engagement: Math.round(0.333333333333333*100), satisfaction: Math.round(0.666666666666667*100), efficiency: Math.round(0.333333333333333*100)},
                {name: 'éŸ³é¢‘è®¾è®¡ç»„', count: 8, engagement: Math.round(0.5*100), satisfaction: Math.round(0.625*100), efficiency: Math.round(0.5*100)}
            ],
            'æ¸¸æˆèŒå·¥ä½œå®¤': [
                {name: 'ç­–åˆ’', count: 7, engagement: Math.round(0.714285714285714*100), satisfaction: Math.round(0.428571428571429*100), efficiency: Math.round(0.428571428571429*100)},
                {name: 'ç¨‹åº', count: 16, engagement: Math.round(0.625*100), satisfaction: Math.round(0.5625*100), efficiency: Math.round(0.5*100)},
                {name: 'ç¾æœ¯', count: 9, engagement: Math.round(0.666666666666667*100), satisfaction: Math.round(0.666666666666667*100), efficiency: Math.round(0.555555555555556*100)},
                {name: 'å…¶ä»–', count: 3, engagement: Math.round(1.0*100), satisfaction: Math.round(0.666666666666667*100), efficiency: Math.round(0.666666666666667*100)}
            ],
            'å‘˜å·¥æœåŠ¡ä¸­å¿ƒ': [
                {name: 'åå‹¤ä¿éšœä¸­å¿ƒ', count: 2, engagement: Math.round(1.0*100), satisfaction: Math.round(1.0*100), efficiency: Math.round(1.0*100)},
                {name: 'å…¶ä»–', count: 3, engagement: Math.round(1.0*100), satisfaction: Math.round(1.0*100), efficiency: Math.round(1.0*100)}
            ],
            'è¿è¥éƒ¨': [
                {name: 'æµ·å¤–å‘è¡Œæ”¯æŒ', count: 6, engagement: Math.round(0.666666666666667*100), satisfaction: Math.round(0.5*100), efficiency: Math.round(0.5*100)},
                {name: 'ç«ç‚¬ä¹‹å…‰', count: 4, engagement: Math.round(0.75*100), satisfaction: Math.round(0.75*100), efficiency: Math.round(0.75*100)},
                {name: 'é“ƒå…°ä¹‹å‰‘', count: 3, engagement: Math.round(1.0*100), satisfaction: Math.round(1.0*100), efficiency: Math.round(1.0*100)},
                {name: 'éº¦èŠ¬', count: 3, engagement: Math.round(0.666666666666667*100), satisfaction: Math.round(0.666666666666667*100), efficiency: Math.round(0.666666666666667*100)},
                {name: 'å…¶ä»–', count: 1, engagement: Math.round(0.0*100), satisfaction: Math.round(0.0*100), efficiency: Math.round(0.0*100)},
                {name: 'é¦™è‚ æ´¾å¯¹', count: 6, engagement: Math.round(1.0*100), satisfaction: Math.round(0.833333333333333*100), efficiency: Math.round(0.833333333333333*100)},
                {name: 'å¿ƒåŠ¨å°é•‡', count: 4, engagement: Math.round(1.0*100), satisfaction: Math.round(1.0*100), efficiency: Math.round(1.0*100)},
                {name: 'ä¼Šç‘Ÿ', count: 3, engagement: Math.round(0.333333333333333*100), satisfaction: Math.round(0.333333333333333*100), efficiency: Math.round(0.333333333333333*100)},
                {name: 'è¿è¥åŸºå»ºæ”¯æŒ', count: 2, engagement: Math.round(1.0*100), satisfaction: Math.round(1.0*100), efficiency: Math.round(1.0*100)},
                {name: 'é•¿å°¾é¡¹ç›®', count: 7, engagement: Math.round(1.0*100), satisfaction: Math.round(0.857142857142857*100), efficiency: Math.round(0.857142857142857*100)},
                {name: 'RO', count: 8, engagement: Math.round(0.375*100), satisfaction: Math.round(0.625*100), efficiency: Math.round(0.375*100)}
            ],
            'æ”¿ç­–å…³ç³»ä¸åˆè§„æ”¯æŒä¸­å¿ƒ': [
                {name: 'å…¬å…±å…³ç³»', count: 6, engagement: Math.round(0.833333333333333*100), satisfaction: Math.round(0.833333333333333*100), efficiency: Math.round(0.833333333333333*100)},
                {name: 'å†…å®¹é£æ§', count: 13, engagement: Math.round(0.923076923076923*100), satisfaction: Math.round(0.923076923076923*100), efficiency: Math.round(0.923076923076923*100)}
            ],
            'æ‰§è¡ŒåŠå…¬å®¤': [
                {name: 'è´¢åŠ¡å®¡è®¡ç»„', count: 3, engagement: Math.round(1.0*100), satisfaction: Math.round(1.0*100), efficiency: Math.round(1.0*100)},
                {name: 'å…¶ä»–', count: 1, engagement: Math.round(0.0*100), satisfaction: Math.round(1.0*100), efficiency: Math.round(0.0*100)}
            ],
            'Bæ ¼çŒ«å·¥ä½œå®¤': [
                {name: 'ROé¡¹ç›®ç»„', count: 58, engagement: Math.round(0.775862068965517*100), satisfaction: Math.round(0.724137931034483*100), efficiency: Math.round(0.672413793103448*100)}
            ],
            'Digital & IT': [
                {name: 'å…¶ä»–', count: 1, engagement: Math.round(1.0*100), satisfaction: Math.round(1.0*100), efficiency: Math.round(1.0*100)},
                {name: 'Infrastructure', count: 2, engagement: Math.round(1.0*100), satisfaction: Math.round(1.0*100), efficiency: Math.round(1.0*100)},
                {name: 'OA Dev', count: 1, engagement: Math.round(0.0*100), satisfaction: Math.round(1.0*100), efficiency: Math.round(0.0*100)},
                {name: 'Operation', count: 2, engagement: Math.round(0.5*100), satisfaction: Math.round(1.0*100), efficiency: Math.round(0.5*100)}
            ],
            'Flash Party': [
                {name: 'æŠ€æœ¯', count: 2, engagement: Math.round(0.5*100), satisfaction: Math.round(1.0*100), efficiency: Math.round(0.5*100)},
                {name: 'å…¶ä»–', count: 2, engagement: Math.round(1.0*100), satisfaction: Math.round(1.0*100), efficiency: Math.round(1.0*100)}
            ],
            'PG å‘è¡Œ & å•†åŠ¡éƒ¨': [
                {name: 'æµ·å¤–å‘è¡Œ', count: 3, engagement: Math.round(1.0*100), satisfaction: Math.round(1.0*100), efficiency: Math.round(1.0*100)},
                {name: 'å…¶ä»–', count: 6, engagement: Math.round(0.5*100), satisfaction: Math.round(0.5*100), efficiency: Math.round(0.5*100)},
                {name: 'å¸‚åœºæ¨å¹¿', count: 2, engagement: Math.round(1.0*100), satisfaction: Math.round(1.0*100), efficiency: Math.round(1.0*100)},
                {name: 'æ¸¸æˆå‘è¡Œä¸šåŠ¡', count: 4, engagement: Math.round(0.75*100), satisfaction: Math.round(0.75*100), efficiency: Math.round(0.75*100)}
            ],
            'TapTap': [
                {name: 'Contents', count: 1, engagement: Math.round(1.0*100), satisfaction: Math.round(1.0*100), efficiency: Math.round(1.0*100)},
                {name: 'Core Product & Services', count: 46, engagement: Math.round(0.652173913043478*100), satisfaction: Math.round(0.608695652173913*100), efficiency: Math.round(0.58695652173913*100)},
                {name: 'Design Team', count: 10, engagement: Math.round(0.7*100), satisfaction: Math.round(0.6*100), efficiency: Math.round(0.6*100)},
                {name: 'Developer Ops', count: 9, engagement: Math.round(0.888888888888889*100), satisfaction: Math.round(0.777777777777778*100), efficiency: Math.round(0.777777777777778*100)},
                {name: 'Editors', count: 11, engagement: Math.round(0.909090909090909*100), satisfaction: Math.round(0.909090909090909*100), efficiency: Math.round(0.909090909090909*100)},
                {name: 'IEM', count: 31, engagement: Math.round(0.741935483870968*100), satisfaction: Math.round(0.741935483870968*100), efficiency: Math.round(0.709677419354839*100)},
                {name: 'International', count: 3, engagement: Math.round(0.0*100), satisfaction: Math.round(0.0*100), efficiency: Math.round(0.0*100)},
                {name: 'Ops', count: 19, engagement: Math.round(0.842105263157895*100), satisfaction: Math.round(0.842105263157895*100), efficiency: Math.round(0.842105263157895*100)},
                {name: 'Project SCE', count: 8, engagement: Math.round(0.625*100), satisfaction: Math.round(0.625*100), efficiency: Math.round(0.625*100)},
                {name: 'Store', count: 11, engagement: Math.round(0.363636363636364*100), satisfaction: Math.round(0.545454545454545*100), efficiency: Math.round(0.363636363636364*100)},
                {name: 'UG', count: 18, engagement: Math.round(0.833333333333333*100), satisfaction: Math.round(0.777777777777778*100), efficiency: Math.round(0.722222222222222*100)}
            ]
        };

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            loadDashboard();
            createCharts();
        });
        
        function loadDashboard() {
            // KPIæ•°æ®å·²åœ¨HTMLä¸­ç¡¬ç¼–ç ï¼Œè¿™é‡Œå¯ä»¥æ·»åŠ åŠ¨æ€æ›´æ–°é€»è¾‘
        }
        
        function createCharts() {
            createQuadrantChart();
            createYearlyTrendChart();
        }
        
        function createQuadrantChart() {
            const ctx = document.getElementById('quadrantChart').getContext('2d');
            
            // å‘˜å·¥åˆ†ç±»æ•°æ® - æ ¹æ®å›¾ç‰‡ä¸­çš„æ•°æ®
            const employeeData = [
                {
                    label: 'é«˜æ•ˆå‘˜å·¥ (æ•¬ä¸šä¸”æ»¡æ„)',
                    x: 78,  // æ»¡æ„åº¦
                    y: 78,  // æ•¬ä¸šåº¦
                    r: 25,  // 62.8%å¯¹åº”çš„å¤§åœ†
                    backgroundColor: 'rgba(40, 167, 69, 0.7)',
                    borderColor: 'rgba(40, 167, 69, 1)',
                    percentage: '62.8%'
                },
                {
                    label: 'å—æŒ«å‘˜å·¥ (æ•¬ä¸šä¸æ»¡æ„)',
                    x: 25,  // æ»¡æ„åº¦
                    y: 75,  // æ•¬ä¸šåº¦
                    r: 8,   // 5.3%å¯¹åº”çš„å°åœ†
                    backgroundColor: 'rgba(255, 193, 7, 0.7)',
                    borderColor: 'rgba(255, 193, 7, 1)',
                    percentage: '5.3%'
                },
                {
                    label: 'æ¼ ç„¶å‘˜å·¥ (ä¸æ•¬ä¸šä½†æ»¡æ„)',
                    x: 75,  // æ»¡æ„åº¦
                    y: 25,  // æ•¬ä¸šåº¦
                    r: 8,   // 5.1%å¯¹åº”çš„å°åœ†
                    backgroundColor: 'rgba(0, 123, 255, 0.7)',
                    borderColor: 'rgba(0, 123, 255, 1)',
                    percentage: '5.1%'
                },
                {
                    label: 'ä½æ•ˆå‘˜å·¥ (ä¸æ•¬ä¸šä¸æ»¡æ„)',
                    x: 25,  // æ»¡æ„åº¦
                    y: 22,  // æ•¬ä¸šåº¦
                    r: 15,  // 26.8%å¯¹åº”çš„ä¸­åœ†
                    backgroundColor: 'rgba(220, 53, 69, 0.7)',
                    borderColor: 'rgba(220, 53, 69, 1)',
                    percentage: '26.8%'
                }
            ];

            new Chart(ctx, {
                type: 'bubble',
                data: {
                    datasets: employeeData.map(item => ({
                        label: item.label,
                        data: [{
                            x: item.x,
                            y: item.y,
                            r: item.r
                        }],
                        backgroundColor: item.backgroundColor,
                        borderColor: item.borderColor,
                        borderWidth: 2,
                        percentage: item.percentage
                    }))
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: true,
                            position: 'bottom',
                            labels: {
                                usePointStyle: true,
                                generateLabels: function(chart) {
                                    return employeeData.map((item, index) => ({
                                        text: `${item.label.split(' ')[0]} ${item.percentage}`,
                                        fillStyle: item.backgroundColor,
                                        strokeStyle: item.borderColor,
                                        lineWidth: 2,
                                        pointStyle: 'circle'
                                    }));
                                }
                            }
                        },
                        tooltip: {
                            callbacks: {
                                title: function() {
                                    return '';
                                },
                                label: function(context) {
                                    const dataset = context.dataset;
                                    const dataPoint = context.parsed;
                                    return [
                                        `${dataset.label}`,
                                        `æ¯”ä¾‹: ${dataset.percentage}`,
                                        `æ»¡æ„åº¦: ${dataPoint.x}%`,
                                        `æ•¬ä¸šåº¦: ${dataPoint.y}%`
                                    ];
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            type: 'linear',
                            position: 'bottom',
                            min: 0,
                            max: 100,
                            title: {
                                display: true,
                                text: 'æ»¡æ„åº¦ (%)',
                                font: {
                                    size: 14,
                                    weight: 'bold'
                                }
                            },
                            grid: {
                                display: true,
                                color: 'rgba(0, 0, 0, 0.1)'
                            },
                            ticks: {
                                stepSize: 25,
                                callback: function(value) {
                                    return value + '%';
                                }
                            }
                        },
                        y: {
                            min: 0,
                            max: 100,
                            title: {
                                display: true,
                                text: 'æ•¬ä¸šåº¦ (%)',
                                font: {
                                    size: 14,
                                    weight: 'bold'
                                }
                            },
                            grid: {
                                display: true,
                                color: 'rgba(0, 0, 0, 0.1)'
                            },
                            ticks: {
                                stepSize: 25,
                                callback: function(value) {
                                    return value + '%';
                                }
                            }
                        }
                    },
                    interaction: {
                        intersect: false
                    }
                }
            });
        }
        
        function createYearlyTrendChart() {
            const ctx = document.getElementById('yearly-trend').getContext('2d');
            
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['2023å¹´', '2024å¹´'],
                    datasets: [
                        {
                            label: 'æ•¬ä¸šåº¦',
                            data: [60, 68],
                            borderColor: '#0078d4',
                            backgroundColor: 'rgba(0, 120, 212, 0.1)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4
                        },
                        {
                            label: 'æ»¡æ„åº¦',
                            data: [60, 68],
                            borderColor: '#107c10',
                            backgroundColor: 'rgba(16, 124, 16, 0.1)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: { callback: value => value + '%' }
                        }
                    },
                    plugins: {
                        legend: { position: 'top' }
                    }
                }
            });
        }
        
        function getScoreColor(score) {
            if (score >= 80) return '#107c10';
            if (score >= 60) return '#0078d4';
            if (score >= 40) return '#ff8c00';
            return '#d13438';
        }
        
        // æ ‡ç­¾é¡µåˆ‡æ¢
        function showTab(tabName) {
            // éšè—æ‰€æœ‰æ ‡ç­¾é¡µå†…å®¹
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // ç§»é™¤æ‰€æœ‰æ ‡ç­¾é¡µçš„æ´»åŠ¨çŠ¶æ€
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // æ˜¾ç¤ºé€‰ä¸­çš„æ ‡ç­¾é¡µå†…å®¹
            document.getElementById(tabName).classList.add('active');
            
            // æ¿€æ´»é€‰ä¸­çš„æ ‡ç­¾é¡µ
            event.target.classList.add('active');
            
            // æ ¹æ®æ ‡ç­¾é¡µç±»å‹æ›´æ–°è¡¨æ ¼æ•°æ®
            if (tabName === 'departments') {
                generateDepartmentTable();
            } else if (tabName === 'subdepartments') {
                generateSubDepartmentTable();
            } else if (tabName === 'management') {
                generateManagementTable();
            } else if (tabName === 'levels') {
                generateLevelsTable();
            }
        }

        function generateDepartmentTable() {
            const tbody = document.getElementById('departmentTableBody');
            tbody.innerHTML = '';
            
            departmentData.forEach((dept, index) => {
                // ä¸€çº§éƒ¨é—¨è¡Œ
                const row = document.createElement('tr');
                const hasSubDepts = subDepartmentData[dept.name] && subDepartmentData[dept.name].length > 0;
                
                if (hasSubDepts) {
                    row.className = 'expandable';
                    row.onclick = () => toggleSubDepartments(index);
                }
                
                row.innerHTML = `
                    <td><strong>${dept.name}</strong></td>
                    <td>${dept.count}</td>
                    <td>${getBadge(dept.engagement)}</td>
                    <td>${getBadge(dept.satisfaction)}</td>
                    <td>${getBadge(dept.efficiency)}</td>
                `;
                tbody.appendChild(row);
                
                // äºŒçº§éƒ¨é—¨è¡Œ
                if (hasSubDepts) {
                    subDepartmentData[dept.name].forEach(subDept => {
                        const subRow = document.createElement('tr');
                        subRow.className = `sub-department sub-${index}`;
                        subRow.innerHTML = `
                            <td>${subDept.name}</td>
                            <td>${dept.name}</td>
                            <td>${subDept.count}</td>
                            <td>${getBadge(subDept.engagement)}</td>
                            <td>${getBadge(subDept.satisfaction)}</td>
                            <td>${getBadge(subDept.efficiency)}</td>
                        `;
                        tbody.appendChild(subRow);
                    });
                }
            });
        }

        function toggleSubDepartments(index) {
            const parentRow = document.querySelector(`tr.expandable:nth-of-type(${index + 1})`);
            const subRows = document.querySelectorAll(`.sub-${index}`);
            
            if (parentRow.classList.contains('expanded')) {
                parentRow.classList.remove('expanded');
                subRows.forEach(row => row.classList.remove('show'));
            } else {
                parentRow.classList.add('expanded');
                subRows.forEach(row => row.classList.add('show'));
            }
        }

        function getBadge(value) {
            const percentage = Math.round(typeof value === 'number' ? value : value * 100);
            let badgeClass = 'badge-poor';
            
            if (percentage >= 80) badgeClass = 'badge-excellent';
            else if (percentage >= 60) badgeClass = 'badge-good';
            else if (percentage >= 40) badgeClass = 'badge-average';
            
            return `<span class="metric-badge ${badgeClass}">${percentage}%</span>`;
        }

        function generateSubDepartmentTable() {
            const tbody = document.getElementById('subDepartmentTableBody');
            tbody.innerHTML = '';
            
            departmentData.forEach((dept, index) => {
                if (subDepartmentData[dept.name]) {
                    subDepartmentData[dept.name].forEach((subDept, subIndex) => {
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td>${subDept.name}</td>
                            <td>${dept.name}</td>
                            <td>${subDept.count}</td>
                            <td>${getBadge(subDept.engagement)}</td>
                            <td>${getBadge(subDept.satisfaction)}</td>
                            <td>${getBadge(subDept.efficiency)}</td>
                        `;
                        tbody.appendChild(row);
                    });
                }
            });
        }

        function generateManagementTable() {
            const tbody = document.getElementById('managementTableBody');
            tbody.innerHTML = '';
            
            const managementData = surveyData['æŒ‰ç®¡ç†å²—ä½'];
            managementData.forEach(dept => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${dept.å²—ä½ç±»å‹}</td>
                    <td>${dept.å¡«å†™äººæ•°}</td>
                    <td>${getBadge(dept.æ•¬ä¸šåº¦)}</td>
                    <td>${getBadge(dept.æ»¡æ„åº¦)}</td>
                    <td>${getBadge(Math.round(dept.æ•¬ä¸šä¸”æ»¡æ„))}</td>
                `;
                tbody.appendChild(row);
            });
        }

        function generateLevelsTable() {
            const tbody = document.getElementById('levelsTableBody');
            tbody.innerHTML = '';
            
            const levelsData = surveyData['æŒ‰èŒçº§'];
            levelsData.forEach(dept => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${dept.èŒçº§ç±»å‹}</td>
                    <td>${dept.å¡«å†™äººæ•°}</td>
                    <td>${getBadge(dept.æ•¬ä¸šåº¦)}</td>
                    <td>${getBadge(dept.æ»¡æ„åº¦)}</td>
                    <td>${getBadge(Math.round(dept.æ•¬ä¸šä¸”æ»¡æ„))}</td>
                `;
                tbody.appendChild(row);
            });
        }
        
        function toggleChatbot() {
            const chatbot = document.getElementById('chatbot');
            chatbot.classList.toggle('hidden');
        }
        
        function sendMessage() {
            const input = document.getElementById('chat-input');
            const message = input.value.trim();
            if (!message) return;
            
            const messages = document.getElementById('chat-messages');
            
            // æ·»åŠ ç”¨æˆ·æ¶ˆæ¯
            const userMsg = document.createElement('div');
            userMsg.className = 'message user';
            userMsg.textContent = message;
            messages.appendChild(userMsg);
            
            // ç”Ÿæˆæœºå™¨äººå›å¤
            setTimeout(() => {
                const botMsg = document.createElement('div');
                botMsg.className = 'message bot';
                botMsg.textContent = generateResponse(message);
                messages.appendChild(botMsg);
                messages.scrollTop = messages.scrollHeight;
            }, 500);
            
            input.value = '';
            messages.scrollTop = messages.scrollHeight;
        }
        
        function generateResponse(message) {
            const responses = {
                'æ•¬ä¸šåº¦': '2024å¹´æ•´ä½“æ•¬ä¸šåº¦ä¸º68%ï¼Œç›¸æ¯”2023å¹´çš„60%æœ‰æ˜¾è‘—æå‡ã€‚ç®¡ç†å²—ä½æ•¬ä¸šåº¦(76.4%)æ˜æ˜¾é«˜äºéç®¡ç†å²—ä½(66.2%)ã€‚',
                'æ»¡æ„åº¦': '2024å¹´æ•´ä½“æ»¡æ„åº¦ä¸º68%ï¼ŒåŒæ¯”æå‡8ä¸ªç™¾åˆ†ç‚¹ã€‚TapTapéƒ¨é—¨è¡¨ç°çªå‡ºï¼Œæ»¡æ„åº¦è¾¾åˆ°70%ä»¥ä¸Šã€‚',
                'éƒ¨é—¨': 'TapTapéƒ¨é—¨è¡¨ç°æœ€ä½³ï¼Œæ•¬ä¸šåº¦å’Œæ»¡æ„åº¦å‡åœ¨70%ä»¥ä¸Šã€‚è´¢åŠ¡éƒ¨éœ€è¦é‡ç‚¹å…³æ³¨ï¼Œå„é¡¹æŒ‡æ ‡åä½ã€‚',
                'å»ºè®®': 'å»ºè®®é‡ç‚¹å…³æ³¨ï¼š1.åŠ å¼ºéç®¡ç†å²—ä½çš„èŒä¸šå‘å±•è§„åˆ’ 2.æå‡è´¢åŠ¡éƒ¨é—¨çš„å·¥ä½œç¯å¢ƒ 3.æ¨å¹¿TapTapçš„ä¼˜ç§€ç®¡ç†ç»éªŒ',
                'é»˜è®¤': 'æ„Ÿè°¢æ‚¨çš„æé—®ï¼æ‚¨å¯ä»¥è¯¢é—®å…³äºæ•¬ä¸šåº¦ã€æ»¡æ„åº¦ã€éƒ¨é—¨è¡¨ç°æˆ–æ”¹è¿›å»ºè®®ç­‰æ–¹é¢çš„é—®é¢˜ã€‚'
            };
            
            return responses[Math.floor(Math.random() * responses.length)];
        }

        function handleKeyPress(event) {
            if (event.key === 'Enter' && !isAIResponding) {
                sendMessage();
            }
        }

        function closeChatbot() {
            console.log('Closing chatbot...');
            const chatbot = document.getElementById('chatbot');
            if (chatbot) {
                chatbot.classList.add('hidden');
                console.log('Chatbot hidden');
            } else {
                console.error('Chatbot element not found');
            }
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            initSatisfactionAnalysis();
            generateDepartmentTable();
            createQuadrantChart();
            createTrendChart();
        });

        // æ›´æ–°é—®é¢˜åˆ—è¡¨
        function updateQuestionsList(department) {
            const questionsList = document.getElementById('questionsList');
            const scores = departmentSatisfactionData[department] || departmentSatisfactionData['overall'];
            
            // é—®é¢˜æ ‡ç­¾ - å¯¹åº”é›·è¾¾å›¾çš„æ ‡ç­¾
            const questionLabels = [
                'å·¥ä½œ', 'æ–‡åŒ–', 'é«˜ç®¡', 'æˆé•¿', 'ä¸­å±‚', 'åé¦ˆ', 'æ±°æ¢', 'åä½œ', 
                'å­¦ä¹ ', 'æˆå°±', 'å¹³è¡¡', 'æ²Ÿé€š', 'æµç¨‹', 'ç›®æ ‡', 'å£°èª‰', 'è–ªé…¬', 
                'è®¤å¯', 'èµ„æº', 'ç¦åˆ©', 'ä¸Šçº§', 'æ¶æ„', 'ç»©æ•ˆ'
            ];
            
            questionsList.innerHTML = '';
            
            satisfactionQuestions.forEach((question, index) => {
                const score = Math.round(scores[index]);
                const questionItem = document.createElement('div');
                questionItem.className = 'question-item';
                
                questionItem.innerHTML = `
                    <div class="question-number">${questionLabels[index]}</div>
                    <div class="question-text">${question}</div>
                    <div class="question-score">${score}%</div>
                `;
                
                questionsList.appendChild(questionItem);
            });
        }
    </script>
</body>
</html> 